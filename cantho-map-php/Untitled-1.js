(
 function(aj,an){
	 function bc(){
		 if(!ap.isReady){
			 try{
				 am.documentElement.doScroll("left")
				 }
			 catch(c){
				 setTimeout(bc,1);
				 return
				 }
			ap.ready()
		}
	}
function aw(s,c){
	c.src?ap.ajax({url:c.src,async:false,dataType:"script"}):ap.globalEval(c.text||c.textContent||c.innerHTML||"");
	c.parentNode&&c.parentNode.removeChild(c)
}
function B(G,F,K,J,c,s){
	var w=G.length;
	if(typeof F==="object"){
		for(var A in F){
			B(G,A,F[A],J,c,K)
		}
	return G
	}
	if(K!==an){
		J=!s&&J&&ap.isFunction(K);
		for(A=0;A<w;A++){
			c(G[A],F,J?K.call(G[A],A,c(G[A],F)):K,s)
		}
		return G
	}
	return w?c(G[0],F):an
}
function ac(){return(new Date).getTime()}
function C(){return false}
function y(){return true}
function a8(w,s,c){c[0].type=w;return ap.event.handle.apply(s,c)}
function a9(N){var L,P=[],O=[],c=arguments,A,G,K,F,J,s;G=ap.data(this,"events");if(!(N.liveFired===this||!G||!G.live||N.button&&N.type==="click")){N.liveFired=this;var w=G.live.slice(0);for(F=0;F<w.length;F++){G=w[F];G.origType.replace(ag,"")===N.type?O.push(G.selector):w.splice(F--,1)}A=ap(N.target).closest(O,N.currentTarget);J=0;for(s=A.length;J<s;J++){for(F=0;F<w.length;F++){G=w[F];if(A[J].selector===G.selector){K=A[J].elem;O=null;if(G.preType==="mouseenter"||G.preType==="mouseleave"){O=ap(N.relatedTarget).closest(G.selector)[0]}if(!O||O!==K){P.push({elem:K,handleObj:G})}}}}J=0;for(s=P.length;J<s;J++){A=P[J];N.currentTarget=A.elem;N.data=A.handleObj.data;N.handleObj=A.handleObj;if(A.handleObj.origHandler.apply(A.elem,c)===false){L=false;break}}return L}}

function aW(s,c){return"live."+(s&&s!=="*"?s+".":"")+c.replace(/\./g,"`").replace(/ /g,"&")}
function aX(c){return !c||!c.parentNode||c.parentNode.nodeType===11}
function aU(w,s){var c=0;s.each(function(){if(this.nodeName===(w[c]&&w[c].nodeName)){var J=ap.data(w[c++]),F=ap.data(this,J);if(J=J&&J.events){delete F.handle;F.events={};for(var G in J){for(var A in J[G]){ap.event.add(this,G,J[G][A],J[G][A].data)}}}}})}

function aV(F,A,s){var G,w,c;A=A&&A[0]?A[0].ownerDocument||A[0]:am;if(F.length===1&&typeof F[0]==="string"&&F[0].length<512&&A===am&&!a0.test(F[0])&&(ap.support.checkClone||!a3.test(F[0]))){w=true;if(c=ap.fragments[F[0]]){if(c!==1){G=c}}}if(!G){G=A.createDocumentFragment();ap.clean(F,A,G,s)}if(w){ap.fragments[F[0]]=c?G:1}return{fragment:G,cacheable:w}}
function ad(w,s){var c={};ap.each(p.concat.apply([],p.slice(0,s)),function(){c[this]=w});return c}

function aZ(c){return"scrollTo" in c&&c.document?c:c.nodeType===9?c.defaultView||c.parentWindow:false}var ap=function(s,c){return new ap.fn.init(s,c)},at=aj.jQuery,au=aj.$,am=aj.document,ab,az=/^[^<]*(<[\w\W]+>)[^>]*$|^#([\w-]+)$/,aA=/^.[^:#\[\.,]*$/,ax=/\S/,ay=/^(\s|\u00A0)+|(\s|\u00A0)+$/g,aq=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,I=navigator.userAgent,aR=false,M=[],ah,f=Object.prototype.toString,aC=Object.prototype.hasOwnProperty,bd=Array.prototype.push,H=Array.prototype.slice,aS=Array.prototype.indexOf;ap.fn=ap.prototype={init:function(w,s){var c,A;if(!w){return this}if(w.nodeType){this.context=this[0]=w;this.length=1;return this}if(w==="body"&&!s){this.context=am;this[0]=am.body;this.selector="body";this.length=1;return this}if(typeof w==="string"){if((c=az.exec(w))&&(c[1]||!s)){if(c[1]){A=s?s.ownerDocument||s:am;if(w=aq.exec(w)){if(ap.isPlainObject(s)){w=[am.createElement(w[1])];ap.fn.attr.call(w,s,true)}else{w=[A.createElement(w[1])]}}else{w=aV([c[1]],[A]);w=(w.cacheable?w.fragment.cloneNode(true):w.fragment).childNodes}return ap.merge(this,w)}else{if(s=am.getElementById(c[2])){if(s.id!==c[2]){return ab.find(w)}this.length=1;this[0]=s}this.context=am;this.selector=w;return this}}else{if(!s&&/^\w+$/.test(w)){this.selector=w;this.context=am;w=am.getElementsByTagName(w);return ap.merge(this,w)}else{return !s||s.jquery?(s||ab).find(w):ap(s).find(w)}}}else{if(ap.isFunction(w)){return ab.ready(w)}}if(w.selector!==an){this.selector=w.selector;this.context=w.context}return ap.makeArray(w,this)},selector:"",jquery:"1.4.2",length:0,size:function(){return this.length},toArray:function(){return H.call(this,0)},get:function(c){return c==null?this.toArray():c<0?this.slice(c)[0]:this[c]},pushStack:function(w,s,c){var A=ap();ap.isArray(w)?bd.apply(A,w):ap.merge(A,w);A.prevObject=this;A.context=this.context;if(s==="find"){A.selector=this.selector+(this.selector?" ":"")+c}else{if(s){A.selector=this.selector+"."+s+"("+c+")"}}return A},each:function(s,c){return ap.each(this,s,c)},ready:function(c){ap.bindReady();if(ap.isReady){c.call(am,ap)}else{M&&M.push(c)}return this},eq:function(c){return c===-1?this.slice(c):this.slice(c,+c+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(H.apply(this,arguments),"slice",H.call(arguments).join(","))},map:function(c){return this.pushStack(ap.map(this,function(w,s){return c.call(w,s,w)}))},end:function(){return this.prevObject||ap(null)},push:bd,sort:[].sort,splice:[].splice};ap.fn.init.prototype=ap.fn;ap.extend=ap.fn.extend=function(){var G=arguments[0]||{},F=1,K=arguments.length,J=false,c,s,w,A;if(typeof G==="boolean"){J=G;G=arguments[1]||{};F=2}if(typeof G!=="object"&&!ap.isFunction(G)){G={}}if(K===F){G=this;--F}for(;F<K;F++){if((c=arguments[F])!=null){for(s in c){w=G[s];A=c[s];if(G!==A){if(J&&A&&(ap.isPlainObject(A)||ap.isArray(A))){w=w&&(ap.isPlainObject(w)||ap.isArray(w))?w:ap.isArray(A)?[]:{};G[s]=ap.extend(J,w,A)}else{if(A!==an){G[s]=A}}}}}}return G};ap.extend({noConflict:function(c){aj.$=au;if(c){aj.jQuery=at}return ap},isReady:false,ready:function(){if(!ap.isReady){if(!am.body){return setTimeout(ap.ready,13)}ap.isReady=true;if(M){for(var s,c=0;s=M[c++];){s.call(am,ap)}M=null}ap.fn.triggerHandler&&ap(am).triggerHandler("ready")}},bindReady:function(){if(!aR){aR=true;if(am.readyState==="complete"){return ap.ready()}if(am.addEventListener){am.addEventListener("DOMContentLoaded",ah,false);aj.addEventListener("load",ap.ready,false)}else{if(am.attachEvent){am.attachEvent("onreadystatechange",ah);aj.attachEvent("onload",ap.ready);var s=false;try{s=aj.frameElement==null}catch(c){}am.documentElement.doScroll&&s&&bc()}}}},isFunction:function(c){return f.call(c)==="[object Function]"},isArray:function(c){return f.call(c)==="[object Array]"},isPlainObject:function(s){if(!s||f.call(s)!=="[object Object]"||s.nodeType||s.setInterval){return false}if(s.constructor&&!aC.call(s,"constructor")&&!aC.call(s.constructor.prototype,"isPrototypeOf")){return false}var c;for(c in s){}return c===an||aC.call(s,c)},isEmptyObject:function(s){for(var c in s){return false}return true},error:function(c){throw c},parseJSON:function(c){if(typeof c!=="string"||!c){return null}c=ap.trim(c);if(/^[\],:{}\s]*$/.test(c.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){return aj.JSON&&aj.JSON.parse?aj.JSON.parse(c):(new Function("return "+c))()}else{ap.error("Invalid JSON: "+c)}},noop:function(){},globalEval:function(w){if(w&&ax.test(w)){var s=am.getElementsByTagName("head")[0]||am.documentElement,c=am.createElement("script");c.type="text/javascript";if(ap.support.scriptEval){c.appendChild(am.createTextNode(w))}else{c.text=w}s.insertBefore(c,s.firstChild);s.removeChild(c)}},nodeName:function(s,c){return s.nodeName&&s.nodeName.toUpperCase()===c.toUpperCase()},each:function(G,F,s){var J,w=0,c=G.length,A=c===an||ap.isFunction(G);if(s){if(A){for(J in G){if(F.apply(G[J],s)===false){break}}}else{for(;w<c;){if(F.apply(G[w++],s)===false){break}}}}else{if(A){for(J in G){if(F.call(G[J],J,G[J])===false){break}}}else{for(s=G[0];w<c&&F.call(s,w,s)!==false;s=G[++w]){}}}return G},trim:function(c){return(c||"").replace(ay,"")},makeArray:function(s,c){c=c||[];if(s!=null){s.length==null||typeof s==="string"||ap.isFunction(s)||typeof s!=="function"&&s.setInterval?bd.call(c,s):ap.merge(c,s)}return c},inArray:function(w,s){if(s.indexOf){return s.indexOf(w)}for(var c=0,A=s.length;c<A;c++){if(s[c]===w){return c}}return -1},merge:function(A,w){var c=A.length,F=0;if(typeof w.length==="number"){for(var s=w.length;F<s;F++){A[c++]=w[F]}}else{for(;w[F]!==an;){A[c++]=w[F++]}}A.length=c;return A},grep:function(F,A,s){for(var G=[],w=0,c=F.length;w<c;w++){!s!==!A(F[w],w)&&G.push(F[w])}return G},map:function(G,F,s){for(var J=[],w,c=0,A=G.length;c<A;c++){w=F(G[c],c,s);if(w!=null){J[J.length]=w}}return J.concat.apply([],J)},guid:1,proxy:function(w,s,c){if(arguments.length===2){if(typeof s==="string"){c=w;w=c[s];s=an}else{if(s&&!ap.isFunction(s)){c=s;s=an}}}if(!s&&w){s=function(){return w.apply(c||this,arguments)}}if(w){s.guid=w.guid=w.guid||s.guid||ap.guid++}return s},uaMatch:function(c){c=c.toLowerCase();c=/(webkit)[ \/]([\w.]+)/.exec(c)||/(opera)(?:.*version)?[ \/]([\w.]+)/.exec(c)||/(msie) ([\w.]+)/.exec(c)||!/compatible/.test(c)&&/(mozilla)(?:.*? rv:([\w.]+))?/.exec(c)||[];return{browser:c[1]||"",version:c[2]||"0"}},browser:{}});I=ap.uaMatch(I);if(I.browser){ap.browser[I.browser]=true;ap.browser.version=I.version}if(ap.browser.webkit){ap.browser.safari=true}if(aS){ap.inArray=function(s,c){return aS.call(c,s)}}ab=ap(am);if(am.addEventListener){ah=function(){am.removeEventListener("DOMContentLoaded",ah,false);ap.ready()}}else{if(am.attachEvent){ah=function(){if(am.readyState==="complete"){am.detachEvent("onreadystatechange",ah);ap.ready()}}}}(function(){ap.support={};var J=am.documentElement,G=am.createElement("script"),L=am.createElement("div"),K="script"+ac();L.style.display="none";L.innerHTML=" <link/><table></table><a href='/a' style='color:red;float:left;opacity:.55;'>a</a><input type='checkbox'/>";var c=L.getElementsByTagName("*"),s=L.getElementsByTagName("a")[0];if(!(!c||!c.length||!s)){ap.support={leadingWhitespace:L.firstChild.nodeType===3,tbody:!L.getElementsByTagName("tbody").length,htmlSerialize:!!L.getElementsByTagName("link").length,style:/red/.test(s.getAttribute("style")),hrefNormalized:s.getAttribute("href")==="/a",opacity:/^0.55$/.test(s.style.opacity),cssFloat:!!s.style.cssFloat,checkOn:L.getElementsByTagName("input")[0].value==="on",optSelected:am.createElement("select").appendChild(am.createElement("option")).selected,parentNode:L.removeChild(L.appendChild(am.createElement("div"))).parentNode===null,deleteExpando:true,checkClone:false,scriptEval:false,noCloneEvent:true,boxModel:null};G.type="text/javascript";try{G.appendChild(am.createTextNode("window."+K+"=1;"))}catch(A){}J.insertBefore(G,J.firstChild);if(aj[K]){ap.support.scriptEval=true;delete aj[K]}try{delete G.test}catch(F){ap.support.deleteExpando=false}J.removeChild(G);if(L.attachEvent&&L.fireEvent){L.attachEvent("onclick",function w(){ap.support.noCloneEvent=false;L.detachEvent("onclick",w)});L.cloneNode(true).fireEvent("onclick")}L=am.createElement("div");L.innerHTML="<input type='radio' name='radiotest' checked='checked'/>";J=am.createDocumentFragment();J.appendChild(L.firstChild);ap.support.checkClone=J.cloneNode(true).cloneNode(true).lastChild.checked;ap(function(){var N=am.createElement("div");N.style.width=N.style.paddingLeft="1px";am.body.appendChild(N);ap.boxModel=ap.support.boxModel=N.offsetWidth===2;am.body.removeChild(N).style.display="none"});J=function(P){var O=am.createElement("div");P="on"+P;var N=P in O;if(!N){O.setAttribute(P,"return;");N=typeof O[P]==="function"}return N};ap.support.submitBubbles=J("submit");ap.support.changeBubbles=J("change");J=G=L=c=s=null}})();ap.props={"for":"htmlFor","class":"className",readonly:"readOnly",maxlength:"maxLength",cellspacing:"cellSpacing",rowspan:"rowSpan",colspan:"colSpan",tabindex:"tabIndex",usemap:"useMap",frameborder:"frameBorder"};var al="jQuery"+ac(),ar=0,aQ={};ap.extend({cache:{},expando:al,noData:{embed:true,object:true,applet:true},data:function(A,w,c){if(!(A.nodeName&&ap.noData[A.nodeName.toLowerCase()])){A=A==aj?aQ:A;var F=A[al],s=ap.cache;if(!F&&typeof w==="string"&&c===an){return null}F||(F=++ar);if(typeof w==="object"){A[al]=F;s[F]=ap.extend(true,{},w)}else{if(!s[F]){A[al]=F;s[F]={}}}A=s[F];if(c!==an){A[w]=c}return typeof w==="string"?A[w]:A}},removeData:function(A,w){if(!(A.nodeName&&ap.noData[A.nodeName.toLowerCase()])){A=A==aj?aQ:A;var c=A[al],F=ap.cache,s=F[c];if(w){if(s){delete s[w];ap.isEmptyObject(s)&&ap.removeData(A)}}else{if(ap.support.deleteExpando){delete A[ap.expando]}else{A.removeAttribute&&A.removeAttribute(ap.expando)}delete F[c]}}}});ap.fn.extend({data:function(w,s){if(typeof w==="undefined"&&this.length){return ap.data(this[0])}else{if(typeof w==="object"){return this.each(function(){ap.data(this,w)})}}var c=w.split(".");c[1]=c[1]?"."+c[1]:"";if(s===an){var A=this.triggerHandler("getData"+c[1]+"!",[c[0]]);if(A===an&&this.length){A=ap.data(this[0],w)}return A===an&&c[1]?this.data(c[0]):A}else{return this.trigger("setData"+c[1]+"!",[c[0],s]).each(function(){ap.data(this,w,s)})}},removeData:function(c){return this.each(function(){ap.removeData(this,c)})}});ap.extend({queue:function(w,s,c){if(w){s=(s||"fx")+"queue";var A=ap.data(w,s);if(!c){return A||[]}if(!A||ap.isArray(c)){A=ap.data(w,s,ap.makeArray(c))}else{A.push(c)}return A}},dequeue:function(w,s){s=s||"fx";var c=ap.queue(w,s),A=c.shift();if(A==="inprogress"){A=c.shift()}if(A){s==="fx"&&c.unshift("inprogress");A.call(w,function(){ap.dequeue(w,s)})}}});ap.fn.extend({queue:function(s,c){if(typeof s!=="string"){c=s;s="fx"}if(c===an){return ap.queue(this[0],s)}return this.each(function(){var w=ap.queue(this,s,c);s==="fx"&&w[0]!=="inprogress"&&ap.dequeue(this,s)})},dequeue:function(c){return this.each(function(){ap.dequeue(this,c)})},delay:function(s,c){s=ap.fx?ap.fx.speeds[s]||s:s;c=c||"fx";return this.queue(c,function(){var w=this;setTimeout(function(){ap.dequeue(w,c)},s)})},clearQueue:function(c){return this.queue(c||"fx",[])}});var aL=/[\n\t]/g,be=/\s+/,ao=/\r/g,o=/href|src|style/,e=/(button|input)/i,b=/(button|input|object|select|textarea)/i,d=/^(a|area)$/i,aJ=/radio|checkbox/;ap.fn.extend({attr:function(s,c){return B(this,s,c,true,ap.attr)},removeAttr:function(c){return this.each(function(){ap.attr(this,c,"");this.nodeType===1&&this.removeAttribute(c)})},addClass:function(J){if(ap.isFunction(J)){return this.each(function(O){var N=ap(this);N.addClass(J.call(this,O,N.attr("class")))})}if(J&&typeof J==="string"){for(var G=(J||"").split(be),L=0,K=this.length;L<K;L++){var c=this[L];if(c.nodeType===1){if(c.className){for(var s=" "+c.className+" ",A=c.className,F=0,w=G.length;F<w;F++){if(s.indexOf(" "+G[F]+" ")<0){A+=" "+G[F]}}c.className=ap.trim(A)}else{c.className=J}}}}return this},removeClass:function(G){if(ap.isFunction(G)){return this.each(function(N){var L=ap(this);L.removeClass(G.call(this,N,L.attr("class")))})}if(G&&typeof G==="string"||G===an){for(var F=(G||"").split(be),K=0,J=this.length;K<J;K++){var c=this[K];if(c.nodeType===1&&c.className){if(G){for(var s=(" "+c.className+" ").replace(aL," "),w=0,A=F.length;w<A;w++){s=s.replace(" "+F[w]+" "," ")}c.className=ap.trim(s)}else{c.className=""}}}}return this},toggleClass:function(w,s){var c=typeof w,A=typeof s==="boolean";if(ap.isFunction(w)){return this.each(function(F){var G=ap(this);G.toggleClass(w.call(this,F,G.attr("class"),s),s)})}return this.each(function(){if(c==="string"){for(var G,K=0,F=ap(this),J=s,L=w.split(be);G=L[K++];){J=A?J:!F.hasClass(G);F[J?"addClass":"removeClass"](G)}}else{if(c==="undefined"||c==="boolean"){this.className&&ap.data(this,"__className__",this.className);this.className=this.className||w===false?"":ap.data(this,"__className__")||""}}})},hasClass:function(w){w=" "+w+" ";for(var s=0,c=this.length;s<c;s++){if((" "+this[s].className+" ").replace(aL," ").indexOf(w)>-1){return true}}return false},val:function(G){if(G===an){var F=this[0];if(F){if(ap.nodeName(F,"option")){return(F.attributes.value||{}).specified?F.value:F.text}if(ap.nodeName(F,"select")){var K=F.selectedIndex,J=[],c=F.options;F=F.type==="select-one";if(K<0){return null}var s=F?K:0;for(K=F?K+1:c.length;s<K;s++){var w=c[s];if(w.selected){G=ap(w).val();if(F){return G}J.push(G)}}return J}if(aJ.test(F.type)&&!ap.support.checkOn){return F.getAttribute("value")===null?"on":F.value}return(F.value||"").replace(ao,"")}return an}var A=ap.isFunction(G);return this.each(function(P){var N=ap(this),L=G;if(this.nodeType===1){if(A){L=G.call(this,P,N.val())}if(typeof L==="number"){L+=""}if(ap.isArray(L)&&aJ.test(this.type)){this.checked=ap.inArray(N.val(),L)>=0}else{if(ap.nodeName(this,"select")){var O=ap.makeArray(L);ap("option",this).each(function(){this.selected=ap.inArray(ap(this).val(),O)>=0});if(!O.length){this.selectedIndex=-1}}else{this.value=L}}}})}});ap.extend({attrFn:{val:true,css:true,html:true,text:true,data:true,width:true,height:true,offset:true},attr:function(F,A,s,G){if(!F||F.nodeType===3||F.nodeType===8){return an}if(G&&A in ap.attrFn){return ap(F)[A](s)}G=F.nodeType!==1||!ap.isXMLDoc(F);var w=s!==an;A=G&&ap.props[A]||A;if(F.nodeType===1){var c=o.test(A);if(A in F&&G&&!c){if(w){A==="type"&&e.test(F.nodeName)&&F.parentNode&&ap.error("type property can't be changed");F[A]=s}if(ap.nodeName(F,"form")&&F.getAttributeNode(A)){return F.getAttributeNode(A).nodeValue}if(A==="tabIndex"){return(A=F.getAttributeNode("tabIndex"))&&A.specified?A.value:b.test(F.nodeName)||d.test(F.nodeName)&&F.href?0:an}return F[A]}if(!ap.support.style&&G&&A==="style"){if(w){F.style.cssText=""+s}return F.style.cssText}w&&F.setAttribute(A,""+s);F=!ap.support.hrefNormalized&&G&&c?F.getAttribute(A,2):F.getAttribute(A);return F===null?an:F}return ap.style(F,A,s)}});var ag=/\.(.*)$/,h=function(c){return c.replace(/[^\w\s\.\|`]/g,function(s){return"\\"+s})};ap.event={add:function(O,N,Q,P){if(!(O.nodeType===3||O.nodeType===8)){if(O.setInterval&&O!==aj&&!O.frameElement){O=aj}var c,A;if(Q.handler){c=Q;Q=c.handler}if(!Q.guid){Q.guid=ap.guid++}if(A=ap.data(O)){var G=A.events=A.events||{},K=A.handle;if(!K){A.handle=K=function(){return typeof ap!=="undefined"&&!ap.event.triggered?ap.event.handle.apply(K.elem,arguments):an}}K.elem=O;N=N.split(" ");for(var F,J=0,s;F=N[J++];){A=c?ap.extend({},c):{handler:Q,data:P};if(F.indexOf(".")>-1){s=F.split(".");F=s.shift();A.namespace=s.slice(0).sort().join(".")}else{s=[];A.namespace=""}A.type=F;A.guid=Q.guid;var w=G[F],L=ap.event.special[F]||{};if(!w){w=G[F]=[];if(!L.setup||L.setup.call(O,P,s,K)===false){if(O.addEventListener){O.addEventListener(F,K,false)}else{O.attachEvent&&O.attachEvent("on"+F,K)}}}if(L.add){L.add.call(O,A);if(!A.handler.guid){A.handler.guid=Q.guid}}w.push(A);ap.event.global[F]=true}O=null}}},global:{},remove:function(Q,O,T,R){if(!(Q.nodeType===3||Q.nodeType===8)){var c,A=0,G,K,F,J,s,w,N=ap.data(Q),L=N&&N.events;if(N&&L){if(O&&O.type){T=O.handler;O=O.type}if(!O||typeof O==="string"&&O.charAt(0)==="."){O=O||"";for(c in L){ap.event.remove(Q,c+O)}}else{for(O=O.split(" ");c=O[A++];){J=c;G=c.indexOf(".")<0;K=[];if(!G){K=c.split(".");c=K.shift();F=new RegExp("(^|\\.)"+ap.map(K.slice(0).sort(),h).join("\\.(?:.*\\.)?")+"(\\.|$)")}if(s=L[c]){if(T){J=ap.event.special[c]||{};for(P=R||0;P<s.length;P++){w=s[P];if(T.guid===w.guid){if(G||F.test(w.namespace)){R==null&&s.splice(P--,1);J.remove&&J.remove.call(Q,w)}if(R!=null){break}}}if(s.length===0||R!=null&&s.length===1){if(!J.teardown||J.teardown.call(Q,K)===false){aK(Q,c,N.handle)}delete L[c]}}else{for(var P=0;P<s.length;P++){w=s[P];if(G||F.test(w.namespace)){ap.event.remove(Q,J,w.handler,P);s.splice(P--,1)}}}}}if(ap.isEmptyObject(L)){if(O=N.handle){O.elem=null}delete N.events;delete N.handle;ap.isEmptyObject(N)&&ap.removeData(Q)}}}}},trigger:function(K,J,N,L){var c=K.type||K;if(!L){K=typeof K==="object"?K[al]?K:ap.extend(ap.Event(c),K):ap.Event(c);if(c.indexOf("!")>=0){K.type=c=c.slice(0,-1);K.exclusive=true}if(!N){K.stopPropagation();ap.event.global[c]&&ap.each(ap.cache,function(){this.events&&this.events[c]&&ap.event.trigger(K,J,this.handle.elem)})}if(!N||N.nodeType===3||N.nodeType===8){return an}K.result=an;K.target=N;J=ap.makeArray(J);J.unshift(K)}K.currentTarget=N;(L=ap.data(N,"handle"))&&L.apply(N,J);L=N.parentNode||N.ownerDocument;try{if(!(N&&N.nodeName&&ap.noData[N.nodeName.toLowerCase()])){if(N["on"+c]&&N["on"+c].apply(N,J)===false){K.result=false}}}catch(s){}if(!K.isPropagationStopped()&&L){ap.event.trigger(K,J,L,true)}else{if(!K.isDefaultPrevented()){L=K.target;var A,G=ap.nodeName(L,"a")&&c==="click",w=ap.event.special[c]||{};if((!w._default||w._default.call(N,K)===false)&&!G&&!(L&&L.nodeName&&ap.noData[L.nodeName.toLowerCase()])){try{if(L[c]){if(A=L["on"+c]){L["on"+c]=null}ap.event.triggered=true;L[c]()}}catch(F){}if(A){L["on"+c]=A}ap.event.triggered=false}}}},handle:function(G){var F,s,J,w;G=arguments[0]=ap.event.fix(G||aj.event);G.currentTarget=this;F=G.type.indexOf(".")<0&&!G.exclusive;if(!F){s=G.type.split(".");G.type=s.shift();J=new RegExp("(^|\\.)"+s.slice(0).sort().join("\\.(?:.*\\.)?")+"(\\.|$)")}w=ap.data(this,"events");s=w[G.type];if(w&&s){s=s.slice(0);w=0;for(var c=s.length;w<c;w++){var A=s[w];if(F||J.test(A.namespace)){G.handler=A.handler;G.data=A.data;G.handleObj=A;A=A.handler.apply(this,arguments);if(A!==an){G.result=A;if(A===false){G.preventDefault();G.stopPropagation()}}if(G.isImmediatePropagationStopped()){break}}}}return G.result},props:"altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY originalTarget pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" "),fix:function(w){if(w[al]){return w}var s=w;w=ap.Event(s);for(var c=this.props.length,A;c;){A=this.props[--c];w[A]=s[A]}if(!w.target){w.target=w.srcElement||am}if(w.target.nodeType===3){w.target=w.target.parentNode}if(!w.relatedTarget&&w.fromElement){w.relatedTarget=w.fromElement===w.target?w.toElement:w.fromElement}if(w.pageX==null&&w.clientX!=null){s=am.documentElement;c=am.body;w.pageX=w.clientX+(s&&s.scrollLeft||c&&c.scrollLeft||0)-(s&&s.clientLeft||c&&c.clientLeft||0);w.pageY=w.clientY+(s&&s.scrollTop||c&&c.scrollTop||0)-(s&&s.clientTop||c&&c.clientTop||0)}if(!w.which&&(w.charCode||w.charCode===0?w.charCode:w.keyCode)){w.which=w.charCode||w.keyCode}if(!w.metaKey&&w.ctrlKey){w.metaKey=w.ctrlKey}if(!w.which&&w.button!==an){w.which=w.button&1?1:w.button&2?3:w.button&4?2:0}return w},guid:100000000,proxy:ap.proxy,special:{ready:{setup:ap.bindReady,teardown:ap.noop},live:{add:function(c){ap.event.add(this,c.origType,ap.extend({},c,{handler:a9}))},remove:function(w){var s=true,c=w.origType.replace(ag,"");ap.each(ap.data(this,"events").live||[],function(){if(c===this.origType.replace(ag,"")){return s=false}});s&&ap.event.remove(this,w.origType,a9)}},beforeunload:{setup:function(w,s,c){if(this.setInterval){this.onbeforeunload=c}return false},teardown:function(s,c){if(this.onbeforeunload===c){this.onbeforeunload=null}}}}};var aK=am.removeEventListener?function(w,s,c){w.removeEventListener(s,c,false)}:function(w,s,c){w.detachEvent("on"+s,c)};ap.Event=function(c){if(!this.preventDefault){return new ap.Event(c)}if(c&&c.type){this.originalEvent=c;this.type=c.type}else{this.type=c}this.timeStamp=ac();this[al]=true};ap.Event.prototype={preventDefault:function(){this.isDefaultPrevented=y;var c=this.originalEvent;if(c){c.preventDefault&&c.preventDefault();c.returnValue=false}},stopPropagation:function(){this.isPropagationStopped=y;var c=this.originalEvent;if(c){c.stopPropagation&&c.stopPropagation();c.cancelBubble=true}},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=y;this.stopPropagation()},isDefaultPrevented:C,isPropagationStopped:C,isImmediatePropagationStopped:C};var aO=function(w){var s=w.relatedTarget;try{for(;s&&s!==this;){s=s.parentNode}if(s!==this){w.type=w.data;ap.event.handle.apply(this,arguments)}}catch(c){}},aP=function(c){c.type=c.data;ap.event.handle.apply(this,arguments)};ap.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(s,c){ap.event.special[s]={setup:function(w){ap.event.add(this,c,w&&w.selector?aP:aO,s)},teardown:function(w){ap.event.remove(this,c,w&&w.selector?aP:aO)}}});if(!ap.support.submitBubbles){ap.event.special.submit={setup:function(){if(this.nodeName.toLowerCase()!=="form"){ap.event.add(this,"click.specialSubmit",function(w){var s=w.target,c=s.type;if((c==="submit"||c==="image")&&ap(s).closest("form").length){return a8("submit",this,arguments)}});ap.event.add(this,"keypress.specialSubmit",function(w){var s=w.target,c=s.type;if((c==="text"||c==="password")&&ap(s).closest("form").length&&w.keyCode===13){return a8("submit",this,arguments)}})}else{return false}},teardown:function(){ap.event.remove(this,".specialSubmit")}}}if(!ap.support.changeBubbles){var bj=/textarea|input|select/i,bk,aM=function(w){var s=w.type,c=w.value;if(s==="radio"||s==="checkbox"){c=w.checked}else{if(s==="select-multiple"){c=w.selectedIndex>-1?ap.map(w.options,function(A){return A.selected}).join("-"):""}else{if(w.nodeName.toLowerCase()==="select"){c=w.selectedIndex}}}return c},aD=function(A,w){var c=A.target,F,s;if(!(!bj.test(c.nodeName)||c.readOnly)){F=ap.data(c,"_change_data");s=aM(c);if(A.type!=="focusout"||c.type!=="radio"){ap.data(c,"_change_data",s)}if(!(F===an||s===F)){if(F!=null||s){A.type="change";return ap.event.trigger(A,w,c)}}}};ap.event.special.change={filters:{focusout:aD,click:function(w){var s=w.target,c=s.type;if(c==="radio"||c==="checkbox"||s.nodeName.toLowerCase()==="select"){return aD.call(this,w)}},keydown:function(w){var s=w.target,c=s.type;if(w.keyCode===13&&s.nodeName.toLowerCase()!=="textarea"||w.keyCode===32&&(c==="checkbox"||c==="radio")||c==="select-multiple"){return aD.call(this,w)}},beforeactivate:function(c){c=c.target;ap.data(c,"_change_data",aM(c))}},setup:function(){if(this.type==="file"){return false}for(var c in bk){ap.event.add(this,c+".specialChange",bk[c])}return bj.test(this.nodeName)},teardown:function(){ap.event.remove(this,".specialChange");return bj.test(this.nodeName)}};bk=ap.event.special.change.filters}am.addEventListener&&ap.each({focus:"focusin",blur:"focusout"},function(w,s){function c(A){A=ap.event.fix(A);A.type=s;return ap.event.handle.call(this,A)}ap.event.special[s]={setup:function(){this.addEventListener(w,c,true)},teardown:function(){this.removeEventListener(w,c,true)}}});ap.each(["bind","one"],function(s,c){ap.fn[c]=function(w,K,A){if(typeof w==="object"){for(var J in w){this[c](J,K,w[J],A)}return this}if(ap.isFunction(K)){A=K;K=an}var F=c==="one"?ap.proxy(A,function(L){ap(this).unbind(L,F);return A.apply(this,arguments)}):A;if(w==="unload"&&c!=="one"){this.one(w,K,A)}else{J=0;for(var G=this.length;J<G;J++){ap.event.add(this[J],w,F,K)}}return this}});ap.fn.extend({unbind:function(w,s){if(typeof w==="object"&&!w.preventDefault){for(var c in w){this.unbind(c,w[c])}}else{c=0;for(var A=this.length;c<A;c++){ap.event.remove(this[c],w,s)}}return this},delegate:function(w,s,c,A){return this.live(s,c,A,w)},undelegate:function(w,s,c){return arguments.length===0?this.unbind("live"):this.die(s,null,c,w)},trigger:function(s,c){return this.each(function(){ap.event.trigger(s,c,this)})},triggerHandler:function(s,c){if(this[0]){s=ap.Event(s);s.preventDefault();s.stopPropagation();ap.event.trigger(s,c,this[0]);return s.result}},toggle:function(w){for(var s=arguments,c=1;c<s.length;){ap.proxy(w,s[c++])}return this.click(ap.proxy(w,function(F){var A=(ap.data(this,"lastToggle"+w.guid)||0)%c;ap.data(this,"lastToggle"+w.guid,A+1);F.preventDefault();return s[A].apply(this,arguments)||false}))},hover:function(s,c){return this.mouseenter(s).mouseleave(c||s)}});var aN={focus:"focusin",blur:"focusout",mouseenter:"mouseover",mouseleave:"mouseout"};ap.each(["live","die"],function(s,c){ap.fn[c]=function(P,O,w,G){var K,N=0,J,L,A=G||this.selector,F=G?this:ap(this.context);if(ap.isFunction(O)){w=O;O=an}for(P=(P||"").split(" ");(K=P[N++])!=null;){G=ag.exec(K);J="";if(G){J=G[0];K=K.replace(ag,"")}if(K==="hover"){P.push("mouseenter"+J,"mouseleave"+J)}else{L=K;if(K==="focus"||K==="blur"){P.push(aN[K]+J);K+=J}else{K=(aN[K]||K)+J}c==="live"?F.each(function(){ap.event.add(this,aW(K,A),{data:O,selector:A,handler:w,origType:K,origHandler:w,preType:L})}):F.unbind(aW(K,A),w)}}return this}});ap.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error".split(" "),function(s,c){ap.fn[c]=function(w){return w?this.bind(c,w):this.trigger(c)};if(ap.attrFn){ap.attrFn[c]=true}});aj.attachEvent&&!aj.addEventListener&&aj.attachEvent("onunload",function(){for(var s in ap.cache){if(ap.cache[s].handle){try{ap.event.remove(ap.cache[s].handle.elem)}catch(c){}}}});(function(){function N(Y){for(var Z="",aa,ba=0;Y[ba];ba++){aa=Y[ba];if(aa.nodeType===3||aa.nodeType===4){Z+=aa.nodeValue}else{if(aa.nodeType!==8){Z+=N(aa.childNodes)}}}return Z}function L(bq,bm,bn,bo,Z,Y){Z=0;for(var aa=bo.length;Z<aa;Z++){var ba=bo[Z];if(ba){ba=ba[bq];for(var bp=false;ba;){if(ba.sizcache===bn){bp=bo[ba.sizset];break}if(ba.nodeType===1&&!Y){ba.sizcache=bn;ba.sizset=Z}if(ba.nodeName.toLowerCase()===bm){bp=ba;break}ba=ba[bq]}bo[Z]=bp}}}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												function P(bq,bm,bn,bo,Z,Y){Z=0;for(var aa=bo.length;Z<aa;Z++){var ba=bo[Z];if(ba){ba=ba[bq];for(var bp=false;ba;){if(ba.sizcache===bn){bp=bo[ba.sizset];break}if(ba.nodeType===1){if(!Y){ba.sizcache=bn;ba.sizset=Z}if(typeof bm!=="string"){if(ba===bm){bp=true;break}}else{if(F.filter(bm,[ba]).length>0){bp=ba;break}}}ba=ba[bq]}bo[Z]=bp}}}var O=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^[\]]*\]|['"][^'"]*['"]|[^[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,Q=0,A=Object.prototype.toString,G=false,K=true;[0,0].sort(function(){K=false;return 0});var F=function(bv,bo,br,bs){br=br||[];var aa=bo=bo||am;if(bo.nodeType!==1&&bo.nodeType!==9){return[]}if(!bv||typeof bv!=="string"){return br}for(var Z=[],ba,bm,bu,bt,Y=true,bn=X(bo),bp=bv;(O.exec(""),ba=O.exec(bp))!==null;){bp=ba[3];Z.push(ba[1]);if(ba[2]){bt=ba[3];break}}if(Z.length>1&&c.exec(bv)){if(Z.length===2&&J.relative[Z[0]]){bm=s(Z[0]+Z[1],bo)}else{for(bm=J.relative[Z[0]]?[bo]:F(Z.shift(),bo);Z.length;){bv=Z.shift();if(J.relative[bv]){bv+=Z.shift()}bm=s(bv,bm)}}}else{if(!bs&&Z.length>1&&bo.nodeType===9&&!bn&&J.match.ID.test(Z[0])&&!J.match.ID.test(Z[Z.length-1])){ba=F.find(Z.shift(),bo,bn);bo=ba.expr?F.filter(ba.expr,ba.set)[0]:ba.set[0]}if(bo){ba=bs?{expr:Z.pop(),set:W(bs)}:F.find(Z.pop(),Z.length===1&&(Z[0]==="~"||Z[0]==="+")&&bo.parentNode?bo.parentNode:bo,bn);bm=ba.expr?F.filter(ba.expr,ba.set):ba.set;if(Z.length>0){bu=W(bm)}else{Y=false}for(;Z.length;){var bq=Z.pop();ba=bq;if(J.relative[bq]){ba=Z.pop()}else{bq=""}if(ba==null){ba=bo}J.relative[bq](bu,ba,bn)}}else{bu=[]}}bu||(bu=bm);bu||F.error(bq||bv);if(A.call(bu)==="[object Array]"){if(Y){if(bo&&bo.nodeType===1){for(bv=0;bu[bv]!=null;bv++){if(bu[bv]&&(bu[bv]===true||bu[bv].nodeType===1&&V(bo,bu[bv]))){br.push(bm[bv])}}}else{for(bv=0;bu[bv]!=null;bv++){bu[bv]&&bu[bv].nodeType===1&&br.push(bm[bv])}}}else{br.push.apply(br,bu)}}else{W(bu,br)}if(bt){F(bt,aa,br,bs);F.uniqueSort(br)}return br};F.uniqueSort=function(Y){if(R){G=K;Y.sort(R);if(G){for(var Z=1;Z<Y.length;Z++){Y[Z]===Y[Z-1]&&Y.splice(Z--,1)}}}return Y};F.matches=function(Y,Z){return F(Y,null,null,Z)};F.find=function(bq,bm,bn){var bo,Z;if(!bq){return[]}for(var Y=0,aa=J.order.length;Y<aa;Y++){var ba=J.order[Y];if(Z=J.leftMatch[ba].exec(bq)){var bp=Z[1];Z.splice(1,1);if(bp.substr(bp.length-1)!=="\\"){Z[1]=(Z[1]||"").replace(/\\/g,"");bo=J.find[ba](Z,bm,bn);if(bo!=null){bq=bq.replace(J.match[ba],"");break}}}}bo||(bo=bm.getElementsByTagName("*"));return{set:bo,expr:bq}};F.filter=function(bx,bp,bs,bt){for(var ba=bx,aa=[],bm=bp,bn,bv,bu=bp&&bp[0]&&X(bp[0]);bx&&bp.length;){for(var Z in J.filter){if((bn=J.leftMatch[Z].exec(bx))!=null&&bn[2]){var bo=J.filter[Z],bq,br;br=bn[1];bv=false;bn.splice(1,1);if(br.substr(br.length-1)!=="\\"){if(bm===aa){aa=[]}if(J.preFilter[Z]){if(bn=J.preFilter[Z](bn,bm,bs,aa,bt,bu)){if(bn===true){continue}}else{bv=bq=true}}if(bn){for(var Y=0;(br=bm[Y])!=null;Y++){if(br){bq=bo(br,bn,Y,bm);var bw=bt^!!bq;if(bs&&bq!=null){if(bw){bv=true}else{bm[Y]=false}}else{if(bw){aa.push(br);bv=true}}}}}if(bq!==an){bs||(bm=aa);bx=bx.replace(J.match[Z],"");if(!bv){return[]}break}}}}if(bx===ba){if(bv==null){F.error(bx)}else{break}}ba=bx}return bm};F.error=function(Y){throw"Syntax error, unrecognized expression: "+Y};var J=F.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\((even|odd|[\dn+-]*)\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(Y){return Y.getAttribute("href")}},relative:{"+":function(Y,Z){var ba=typeof Z==="string",bm=ba&&!/\W/.test(Z);ba=ba&&!bm;if(bm){Z=Z.toLowerCase()}bm=0;for(var bn=Y.length,aa;bm<bn;bm++){if(aa=Y[bm]){for(;(aa=aa.previousSibling)&&aa.nodeType!==1;){}Y[bm]=ba||aa&&aa.nodeName.toLowerCase()===Z?aa||false:aa===Z}}ba&&F.filter(Z,Y,true)},">":function(Y,Z){var ba=typeof Z==="string";if(ba&&!/\W/.test(Z)){Z=Z.toLowerCase();for(var bm=0,bn=Y.length;bm<bn;bm++){var aa=Y[bm];if(aa){ba=aa.parentNode;Y[bm]=ba.nodeName.toLowerCase()===Z?ba:false}}}else{bm=0;for(bn=Y.length;bm<bn;bm++){if(aa=Y[bm]){Y[bm]=ba?aa.parentNode:aa.parentNode===Z}}ba&&F.filter(Z,Y,true)}},"":function(Y,Z,ba){var bm=Q++,bn=P;if(typeof Z==="string"&&!/\W/.test(Z)){var aa=Z=Z.toLowerCase();bn=L}bn("parentNode",Z,bm,Y,aa,ba)},"~":function(Y,Z,ba){var bm=Q++,bn=P;if(typeof Z==="string"&&!/\W/.test(Z)){var aa=Z=Z.toLowerCase();bn=L}bn("previousSibling",Z,bm,Y,aa,ba)}},find:{ID:function(Y,Z,aa){if(typeof Z.getElementById!=="undefined"&&!aa){return(Y=Z.getElementById(Y[1]))?[Y]:[]}},NAME:function(Y,Z){if(typeof Z.getElementsByName!=="undefined"){var aa=[];Z=Z.getElementsByName(Y[1]);for(var ba=0,bm=Z.length;ba<bm;ba++){Z[ba].getAttribute("name")===Y[1]&&aa.push(Z[ba])}return aa.length===0?null:aa}},TAG:function(Y,Z){return Z.getElementsByTagName(Y[1])}},preFilter:{CLASS:function(Y,Z,ba,bm,bn,aa){Y=" "+Y[1].replace(/\\/g,"")+" ";if(aa){return Y}aa=0;for(var bo;(bo=Z[aa])!=null;aa++){if(bo){if(bn^(bo.className&&(" "+bo.className+" ").replace(/[\t\n]/g," ").indexOf(Y)>=0)){ba||bm.push(bo)}else{if(ba){Z[aa]=false}}}}return false},ID:function(Y){return Y[1].replace(/\\/g,"")},TAG:function(Y){return Y[1].toLowerCase()},CHILD:function(Y){if(Y[1]==="nth"){var Z=/(-?)(\d*)n((?:\+|-)?\d*)/.exec(Y[2]==="even"&&"2n"||Y[2]==="odd"&&"2n+1"||!/\D/.test(Y[2])&&"0n+"+Y[2]||Y[2]);Y[2]=Z[1]+(Z[2]||1)-0;Y[3]=Z[3]-0}Y[0]=Q++;return Y},ATTR:function(Y,Z,ba,bm,bn,aa){Z=Y[1].replace(/\\/g,"");if(!aa&&J.attrMap[Z]){Y[1]=J.attrMap[Z]}if(Y[2]==="~="){Y[4]=" "+Y[4]+" "}return Y},PSEUDO:function(Y,Z,aa,ba,bm){if(Y[1]==="not"){if((O.exec(Y[3])||"").length>1||/^\w/.test(Y[3])){Y[3]=F(Y[3],null,null,Z)}else{Y=F.filter(Y[3],Z,aa,true^bm);aa||ba.push.apply(ba,Y);return false}}else{if(J.match.POS.test(Y[0])||J.match.CHILD.test(Y[0])){return true}}return Y},POS:function(Y){Y.unshift(true);return Y}},filters:{enabled:function(Y){return Y.disabled===false&&Y.type!=="hidden"},disabled:function(Y){return Y.disabled===true},checked:function(Y){return Y.checked===true},selected:function(Y){return Y.selected===true},parent:function(Y){return !!Y.firstChild},empty:function(Y){return !Y.firstChild},has:function(Y,Z,aa){return !!F(aa[3],Y).length},header:function(Y){return/h\d/i.test(Y.nodeName)},text:function(Y){return"text"===Y.type},radio:function(Y){return"radio"===Y.type},checkbox:function(Y){return"checkbox"===Y.type},file:function(Y){return"file"===Y.type},password:function(Y){return"password"===Y.type},submit:function(Y){return"submit"===Y.type},image:function(Y){return"image"===Y.type},reset:function(Y){return"reset"===Y.type},button:function(Y){return"button"===Y.type||Y.nodeName.toLowerCase()==="button"},input:function(Y){return/input|select|textarea|button/i.test(Y.nodeName)}},setFilters:{first:function(Y,Z){return Z===0},last:function(Y,Z,aa,ba){return Z===ba.length-1},even:function(Y,Z){return Z%2===0},odd:function(Y,Z){return Z%2===1},lt:function(Y,Z,aa){return Z<aa[3]-0},gt:function(Y,Z,aa){return Z>aa[3]-0},nth:function(Y,Z,aa){return aa[3]-0===Z},eq:function(Y,Z,aa){return aa[3]-0===Z}},filter:{PSEUDO:function(Y,Z,ba,bm){var bn=Z[1],aa=J.filters[bn];if(aa){return aa(Y,ba,Z,bm)}else{if(bn==="contains"){return(Y.textContent||Y.innerText||N([Y])||"").indexOf(Z[3])>=0}else{if(bn==="not"){Z=Z[3];ba=0;for(bm=Z.length;ba<bm;ba++){if(Z[ba]===Y){return false}}return true}else{F.error("Syntax error, unrecognized expression: "+bn)}}}},CHILD:function(Y,Z){var ba=Z[1],bm=Y;switch(ba){case"only":case"first":for(;bm=bm.previousSibling;){if(bm.nodeType===1){return false}}if(ba==="first"){return true}bm=Y;case"last":for(;bm=bm.nextSibling;){if(bm.nodeType===1){return false}}return true;case"nth":ba=Z[2];var bn=Z[3];if(ba===1&&bn===0){return true}Z=Z[0];var aa=Y.parentNode;if(aa&&(aa.sizcache!==Z||!Y.nodeIndex)){var bo=0;for(bm=aa.firstChild;bm;bm=bm.nextSibling){if(bm.nodeType===1){bm.nodeIndex=++bo}}aa.sizcache=Z}Y=Y.nodeIndex-bn;return ba===0?Y===0:Y%ba===0&&Y/ba>=0}},ID:function(Y,Z){return Y.nodeType===1&&Y.getAttribute("id")===Z},TAG:function(Y,Z){return Z==="*"&&Y.nodeType===1||Y.nodeName.toLowerCase()===Z},CLASS:function(Y,Z){return(" "+(Y.className||Y.getAttribute("class"))+" ").indexOf(Z)>-1},ATTR:function(Y,Z){var aa=Z[1];Y=J.attrHandle[aa]?J.attrHandle[aa](Y):Y[aa]!=null?Y[aa]:Y.getAttribute(aa);aa=Y+"";var ba=Z[2];Z=Z[4];return Y==null?ba==="!=":ba==="="?aa===Z:ba==="*="?aa.indexOf(Z)>=0:ba==="~="?(" "+aa+" ").indexOf(Z)>=0:!Z?aa&&Y!==false:ba==="!="?aa!==Z:ba==="^="?aa.indexOf(Z)===0:ba==="$="?aa.substr(aa.length-Z.length)===Z:ba==="|="?aa===Z||aa.substr(0,Z.length+1)===Z+"-":false},POS:function(Y,Z,aa,ba){var bm=J.setFilters[Z[2]];if(bm){return bm(Y,aa,Z,ba)}}}},c=J.match.POS;for(var w in J.match){J.match[w]=new RegExp(J.match[w].source+/(?![^\[]*\])(?![^\(]*\))/.source);J.leftMatch[w]=new RegExp(/(^(?:.|\r|\n)*?)/.source+J.match[w].source.replace(/\\(\d+)/g,function(Y,Z){return"\\"+(Z-0+1)}))}var W=function(Y,Z){Y=Array.prototype.slice.call(Y,0);if(Z){Z.push.apply(Z,Y);return Z}return Y};try{Array.prototype.slice.call(am.documentElement.childNodes,0)}catch(T){W=function(Y,Z){Z=Z||[];if(A.call(Y)==="[object Array]"){Array.prototype.push.apply(Z,Y)}else{if(typeof Y.length==="number"){for(var aa=0,ba=Y.length;aa<ba;aa++){Z.push(Y[aa])}}else{for(aa=0;Y[aa];aa++){Z.push(Y[aa])}}}return Z}}var R;if(am.documentElement.compareDocumentPosition){R=function(Y,Z){if(!Y.compareDocumentPosition||!Z.compareDocumentPosition){if(Y==Z){G=true}return Y.compareDocumentPosition?-1:1}Y=Y.compareDocumentPosition(Z)&4?-1:Y===Z?0:1;if(Y===0){G=true}return Y}}else{if("sourceIndex" in am.documentElement){R=function(Y,Z){if(!Y.sourceIndex||!Z.sourceIndex){if(Y==Z){G=true}return Y.sourceIndex?-1:1}Y=Y.sourceIndex-Z.sourceIndex;if(Y===0){G=true}return Y}}else{if(am.createRange){R=function(Y,Z){if(!Y.ownerDocument||!Z.ownerDocument){if(Y==Z){G=true}return Y.ownerDocument?-1:1}var aa=Y.ownerDocument.createRange(),ba=Z.ownerDocument.createRange();aa.setStart(Y,0);aa.setEnd(Y,0);ba.setStart(Z,0);ba.setEnd(Z,0);Y=aa.compareBoundaryPoints(Range.START_TO_END,ba);if(Y===0){G=true}return Y}}}}(function(){var Y=am.createElement("div"),Z="script"+(new Date).getTime();Y.innerHTML="<a name='"+Z+"'/>";var aa=am.documentElement;aa.insertBefore(Y,aa.firstChild);if(am.getElementById(Z)){J.find.ID=function(bn,bm,ba){if(typeof bm.getElementById!=="undefined"&&!ba){return(bm=bm.getElementById(bn[1]))?bm.id===bn[1]||typeof bm.getAttributeNode!=="undefined"&&bm.getAttributeNode("id").nodeValue===bn[1]?[bm]:an:[]}};J.filter.ID=function(bn,bm){var ba=typeof bn.getAttributeNode!=="undefined"&&bn.getAttributeNode("id");return bn.nodeType===1&&ba&&ba.nodeValue===bm}}aa.removeChild(Y);aa=Y=null})();(function(){var Y=am.createElement("div");Y.appendChild(am.createComment(""));if(Y.getElementsByTagName("*").length>0){J.find.TAG=function(Z,aa){aa=aa.getElementsByTagName(Z[1]);if(Z[1]==="*"){Z=[];for(var ba=0;aa[ba];ba++){aa[ba].nodeType===1&&Z.push(aa[ba])}aa=Z}return aa}}Y.innerHTML="<a href='#'></a>";if(Y.firstChild&&typeof Y.firstChild.getAttribute!=="undefined"&&Y.firstChild.getAttribute("href")!=="#"){J.attrHandle.href=function(Z){return Z.getAttribute("href",2)}}Y=null})();am.querySelectorAll&&function(){var Y=F,Z=am.createElement("div");Z.innerHTML="<p class='TEST'></p>";if(!(Z.querySelectorAll&&Z.querySelectorAll(".TEST").length===0)){F=function(bn,bm,ba,bo){bm=bm||am;if(!bo&&bm.nodeType===9&&!X(bm)){try{return W(bm.querySelectorAll(bn),ba)}catch(bp){}}return Y(bn,bm,ba,bo)};for(var aa in Y){F[aa]=Y[aa]}Z=null}}();(function(){var Y=am.createElement("div");Y.innerHTML="<div class='test e'></div><div class='test'></div>";if(!(!Y.getElementsByClassName||Y.getElementsByClassName("e").length===0)){Y.lastChild.className="e";if(Y.getElementsByClassName("e").length!==1){J.order.splice(1,0,"CLASS");J.find.CLASS=function(Z,aa,ba){if(typeof aa.getElementsByClassName!=="undefined"&&!ba){return aa.getElementsByClassName(Z[1])}};Y=null}}})();var V=am.compareDocumentPosition?function(Y,Z){return !!(Y.compareDocumentPosition(Z)&16)}:function(Y,Z){return Y!==Z&&(Y.contains?Y.contains(Z):true)},X=function(Y){return(Y=(Y?Y.ownerDocument||Y:0).documentElement)?Y.nodeName!=="HTML":false},s=function(Y,Z){var ba=[],bm="",bn;for(Z=Z.nodeType?[Z]:Z;bn=J.match.PSEUDO.exec(Y);){bm+=bn[0];Y=Y.replace(J.match.PSEUDO,"")}Y=J.relative[Y]?Y+"*":Y;bn=0;for(var aa=Z.length;bn<aa;bn++){F(Y,Z[bn],ba)}return F.filter(bm,ba)};ap.find=F;ap.expr=F.selectors;ap.expr[":"]=ap.expr.filters;ap.unique=F.uniqueSort;ap.text=N;ap.isXMLDoc=X;ap.contains=V})();var j=/Until$/,ae=/^(?:parents|prevUntil|prevAll)/,g=/,/;H=Array.prototype.slice;var aE=function(w,s,c){if(ap.isFunction(s)){return ap.grep(w,function(F,G){return !!s.call(F,G,F)===c})}else{if(s.nodeType){return ap.grep(w,function(F){return F===s===c})}else{if(typeof s==="string"){var A=ap.grep(w,function(F){return F.nodeType===1});if(aA.test(s)){return ap.filter(s,A,!c)}else{s=ap.filter(s,A)}}}}return ap.grep(w,function(F){return ap.inArray(F,s)>=0===c})};ap.fn.extend({find:function(G){for(var F=this.pushStack("","find",G),s=0,J=0,w=this.length;J<w;J++){s=F.length;ap.find(G,this[J],F);if(J>0){for(var c=s;c<F.length;c++){for(var A=0;A<s;A++){if(F[A]===F[c]){F.splice(c--,1);break}}}}}return F},has:function(s){var c=ap(s);return this.filter(function(){for(var w=0,A=c.length;w<A;w++){if(ap.contains(this,c[w])){return true}}})},not:function(c){return this.pushStack(aE(this,c,false),"not",c)},filter:function(c){return this.pushStack(aE(this,c,true),"filter",c)},is:function(c){return !!c&&ap.filter(c,this).length>0},closest:function(J,G){if(ap.isArray(J)){var L=[],K=this[0],c,s={},A;if(K&&J.length){c=0;for(var F=J.length;c<F;c++){A=J[c];s[A]||(s[A]=ap.expr.match.POS.test(A)?ap(A,G||this.context):A)}for(;K&&K.ownerDocument&&K!==G;){for(A in s){c=s[A];if(c.jquery?c.index(K)>-1:ap(K).is(c)){L.push({selector:A,elem:K});delete s[A]}}K=K.parentNode}}return L}var w=ap.expr.match.POS.test(J)?ap(J,G||this.context):null;return this.map(function(O,N){for(;N&&N.ownerDocument&&N!==G;){if(w?w.index(N)>-1:ap(N).is(J)){return N}N=N.parentNode}return null})},index:function(c){if(!c||typeof c==="string"){return ap.inArray(this[0],c?ap(c):this.parent().children())}return ap.inArray(c.jquery?c[0]:c,this)},add:function(s,c){s=typeof s==="string"?ap(s,c||this.context):ap.makeArray(s);c=ap.merge(this.get(),s);return this.pushStack(aX(s[0])||aX(c[0])?c:ap.unique(c))},andSelf:function(){return this.add(this.prevObject)}});ap.each({parent:function(c){return(c=c.parentNode)&&c.nodeType!==11?c:null},parents:function(c){return ap.dir(c,"parentNode")},parentsUntil:function(w,s,c){return ap.dir(w,"parentNode",c)},next:function(c){return ap.nth(c,2,"nextSibling")},prev:function(c){return ap.nth(c,2,"previousSibling")},nextAll:function(c){return ap.dir(c,"nextSibling")},prevAll:function(c){return ap.dir(c,"previousSibling")},nextUntil:function(w,s,c){return ap.dir(w,"nextSibling",c)},prevUntil:function(w,s,c){return ap.dir(w,"previousSibling",c)},siblings:function(c){return ap.sibling(c.parentNode.firstChild,c)},children:function(c){return ap.sibling(c.firstChild)},contents:function(c){return ap.nodeName(c,"iframe")?c.contentDocument||c.contentWindow.document:ap.makeArray(c.childNodes)}},function(s,c){ap.fn[s]=function(w,F){var A=ap.map(this,c,w);j.test(s)||(F=w);if(F&&typeof F==="string"){A=ap.filter(F,A)}A=this.length>1?ap.unique(A):A;if((this.length>1||g.test(F))&&ae.test(s)){A=A.reverse()}return this.pushStack(A,s,H.call(arguments).join(","))}});ap.extend({filter:function(w,s,c){if(c){w=":not("+w+")"}return ap.find.matches(w,s)},dir:function(w,s,c){var A=[];for(w=w[s];w&&w.nodeType!==9&&(c===an||w.nodeType!==1||!ap(w).is(c));){w.nodeType===1&&A.push(w);w=w[s]}return A},nth:function(w,s,c){s=s||1;for(var A=0;w;w=w[c]){if(w.nodeType===1&&++A===s){break}}return w},sibling:function(w,s){for(var c=[];w;w=w.nextSibling){w.nodeType===1&&w!==s&&c.push(w)}return c}});var aB=/ jQuery\d+="(?:\d+|null)"/g,S=/^\s+/,r=/(<([\w:]+)[^>]*?)\/>/g,bh=/^(?:area|br|col|embed|hr|img|input|link|meta|param)$/i,aH=/<([\w:]+)/,bi=/<tbody/i,bf=/<|&#?\w+;/,a0=/<script|<object|<embed|<option|<style/i,a3=/checked\s*(?:[^=]|=\s*.checked.)/i,aI=function(w,s,c){return bh.test(c)?w:s+"></"+c+">"},ak={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]};ak.optgroup=ak.option;ak.tbody=ak.tfoot=ak.colgroup=ak.caption=ak.thead;ak.th=ak.td;if(!ap.support.htmlSerialize){ak._default=[1,"div<div>","</div>"]}ap.fn.extend({text:function(c){if(ap.isFunction(c)){return this.each(function(w){var s=ap(this);s.text(c.call(this,w,s.text()))})}if(typeof c!=="object"&&c!==an){return this.empty().append((this[0]&&this[0].ownerDocument||am).createTextNode(c))}return ap.text(this)},wrapAll:function(s){if(ap.isFunction(s)){return this.each(function(w){ap(this).wrapAll(s.call(this,w))})}if(this[0]){var c=ap(s,this[0].ownerDocument).eq(0).clone(true);this[0].parentNode&&c.insertBefore(this[0]);c.map(function(){for(var w=this;w.firstChild&&w.firstChild.nodeType===1;){w=w.firstChild}return w}).append(this)}return this},wrapInner:function(c){if(ap.isFunction(c)){return this.each(function(s){ap(this).wrapInner(c.call(this,s))})}return this.each(function(){var w=ap(this),s=w.contents();s.length?s.wrapAll(c):w.append(c)})},wrap:function(c){return this.each(function(){ap(this).wrapAll(c)})},unwrap:function(){return this.parent().each(function(){ap.nodeName(this,"body")||ap(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,true,function(c){this.nodeType===1&&this.appendChild(c)})},prepend:function(){return this.domManip(arguments,true,function(c){this.nodeType===1&&this.insertBefore(c,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode){return this.domManip(arguments,false,function(s){this.parentNode.insertBefore(s,this)})}else{if(arguments.length){var c=ap(arguments[0]);c.push.apply(c,this.toArray());return this.pushStack(c,"before",arguments)}}},after:function(){if(this[0]&&this[0].parentNode){return this.domManip(arguments,false,function(s){this.parentNode.insertBefore(s,this.nextSibling)})}else{if(arguments.length){var c=this.pushStack(this,"after",arguments);c.push.apply(c,ap(arguments[0]).toArray());return c}}},remove:function(w,s){for(var c=0,A;(A=this[c])!=null;c++){if(!w||ap.filter(w,[A]).length){if(!s&&A.nodeType===1){ap.cleanData(A.getElementsByTagName("*"));ap.cleanData([A])}A.parentNode&&A.parentNode.removeChild(A)}}return this},empty:function(){for(var s=0,c;(c=this[s])!=null;s++){for(c.nodeType===1&&ap.cleanData(c.getElementsByTagName("*"));c.firstChild;){c.removeChild(c.firstChild)}}return this},clone:function(s){var c=this.map(function(){if(!ap.support.noCloneEvent&&!ap.isXMLDoc(this)){var w=this.outerHTML,A=this.ownerDocument;if(!w){w=A.createElement("div");w.appendChild(this.cloneNode(true));w=w.innerHTML}return ap.clean([w.replace(aB,"").replace(/=([^="'>\s]+\/)>/g,'="$1">').replace(S,"")],A)[0]}else{return this.cloneNode(true)}});if(s===true){aU(this,c);aU(this.find("*"),c.find("*"))}return c},html:function(w){if(w===an){return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(aB,""):null}else{if(typeof w==="string"&&!a0.test(w)&&(ap.support.leadingWhitespace||!S.test(w))&&!ak[(aH.exec(w)||["",""])[1].toLowerCase()]){w=w.replace(r,aI);try{for(var s=0,c=this.length;s<c;s++){if(this[s].nodeType===1){ap.cleanData(this[s].getElementsByTagName("*"));this[s].innerHTML=w}}}catch(A){this.empty().append(w)}}else{ap.isFunction(w)?this.each(function(G){var J=ap(this),F=J.html();J.empty().append(function(){return w.call(this,G,F)})}):this.empty().append(w)}}return this},replaceWith:function(c){if(this[0]&&this[0].parentNode){if(ap.isFunction(c)){return this.each(function(w){var s=ap(this),A=s.html();s.replaceWith(c.call(this,w,A))})}if(typeof c!=="string"){c=ap(c).detach()}return this.each(function(){var w=this.nextSibling,s=this.parentNode;ap(this).remove();w?ap(w).before(c):ap(s).append(c)})}else{return this.pushStack(ap(ap.isFunction(c)?c():c),"replaceWith",c)}},detach:function(c){return this.remove(c,true)},domManip:function(L,K,O){function N(P){return ap.nodeName(P,"table")?P.getElementsByTagName("tbody")[0]||P.appendChild(P.ownerDocument.createElement("tbody")):P}var c,w,F=L[0],J=[],A;if(!ap.support.checkClone&&arguments.length===3&&typeof F==="string"&&a3.test(F)){return this.each(function(){ap(this).domManip(L,K,O,true)})}if(ap.isFunction(F)){return this.each(function(Q){var P=ap(this);L[0]=F.call(this,Q,K?P.html():an);P.domManip(L,K,O)})}if(this[0]){c=F&&F.parentNode;c=ap.support.parentNode&&c&&c.nodeType===11&&c.childNodes.length===this.length?{fragment:c}:aV(L,this,J);A=c.fragment;if(w=A.childNodes.length===1?(A=A.firstChild):A.firstChild){K=K&&ap.nodeName(w,"tr");for(var G=0,s=this.length;G<s;G++){O.call(K?N(this[G],w):this[G],G>0||c.cacheable||this.length>1?A.cloneNode(true):A)}}J.length&&ap.each(J,aw)}return this}});ap.fragments={};ap.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(s,c){ap.fn[s]=function(w){var J=[];w=ap(w);var A=this.length===1&&this[0].parentNode;if(A&&A.nodeType===11&&A.childNodes.length===1&&w.length===1){w[c](this[0]);return this}else{A=0;for(var G=w.length;A<G;A++){var F=(A>0?this.clone(true):this).get();ap.fn[c].apply(ap(w[A]),F);J=J.concat(F)}return this.pushStack(J,s,w.selector)}}});ap.extend({clean:function(L,K,O,N){K=K||am;if(typeof K.createElement==="undefined"){K=K.ownerDocument||K[0]&&K[0].ownerDocument||am}for(var c=[],w=0,F;(F=L[w])!=null;w++){if(typeof F==="number"){F+=""}if(F){if(typeof F==="string"&&!bf.test(F)){F=K.createTextNode(F)}else{if(typeof F==="string"){F=F.replace(r,aI);var J=(aH.exec(F)||["",""])[1].toLowerCase(),A=ak[J]||ak._default,G=A[0],s=K.createElement("div");for(s.innerHTML=A[1]+F+A[2];G--;){s=s.lastChild}if(!ap.support.tbody){G=bi.test(F);J=J==="table"&&!G?s.firstChild&&s.firstChild.childNodes:A[1]==="<table>"&&!G?s.childNodes:[];for(A=J.length-1;A>=0;--A){ap.nodeName(J[A],"tbody")&&!J[A].childNodes.length&&J[A].parentNode.removeChild(J[A])}}!ap.support.leadingWhitespace&&S.test(F)&&s.insertBefore(K.createTextNode(S.exec(F)[0]),s.firstChild);F=s.childNodes}}if(F.nodeType){c.push(F)}else{c=ap.merge(c,F)}}}if(O){for(w=0;c[w];w++){if(N&&ap.nodeName(c[w],"script")&&(!c[w].type||c[w].type.toLowerCase()==="text/javascript")){N.push(c[w].parentNode?c[w].parentNode.removeChild(c[w]):c[w])}else{c[w].nodeType===1&&c.splice.apply(c,[w+1,0].concat(ap.makeArray(c[w].getElementsByTagName("script"))));O.appendChild(c[w])}}}return c},cleanData:function(J){for(var G,L,K=ap.cache,c=ap.event.special,s=ap.support.deleteExpando,A=0,F;(F=J[A])!=null;A++){if(L=F[ap.expando]){G=K[L];if(G.events){for(var w in G.events){c[w]?ap.event.remove(F,w):aK(F,w,G.handle)}}if(s){delete F[ap.expando]}else{F.removeAttribute&&F.removeAttribute(ap.expando)}delete K[L]}}}});var bg=/z-?index|font-?weight|opacity|zoom|line-?height/i,aF=/alpha\([^)]*\)/,aG=/opacity=([^)]*)/,a6=/float/i,a7=/-([a-z])/ig,bl=/([A-Z])/g,a=/^-?\d+(?:px)?$/i,m=/^-?\d/,n={position:"absolute",visibility:"hidden",display:"block"},k=["Left","Right"],z=["Top","Bottom"],v=am.defaultView&&am.defaultView.getComputedStyle,av=ap.support.cssFloat?"cssFloat":"styleFloat",a4=function(s,c){return c.toUpperCase()};ap.fn.css=function(s,c){return B(this,s,c,true,function(w,F,A){if(A===an){return ap.curCSS(w,F)}if(typeof A==="number"&&!bg.test(F)){A+="px"}ap.style(w,F,A)})};ap.extend({style:function(A,w,c){if(!A||A.nodeType===3||A.nodeType===8){return an}if((w==="width"||w==="height")&&parseFloat(c)<0){c=an}var F=A.style||A,s=c!==an;if(!ap.support.opacity&&w==="opacity"){if(s){F.zoom=1;w=parseInt(c,10)+""==="NaN"?"":"alpha(opacity="+c*100+")";A=F.filter||ap.curCSS(A,"filter")||"";F.filter=aF.test(A)?A.replace(aF,w):w}return F.filter&&F.filter.indexOf("opacity=")>=0?parseFloat(aG.exec(F.filter)[1])/100+"":""}if(a6.test(w)){w=av}w=w.replace(a7,a4);if(s){F[w]=c}return F[w]},css:function(G,F,s,J){if(F==="width"||F==="height"){var w,c=F==="width"?k:z;function A(){w=F==="width"?G.offsetWidth:G.offsetHeight;J!=="border"&&ap.each(c,function(){J||(w-=parseFloat(ap.curCSS(G,"padding"+this,true))||0);if(J==="margin"){w+=parseFloat(ap.curCSS(G,"margin"+this,true))||0}else{w-=parseFloat(ap.curCSS(G,"border"+this+"Width",true))||0}})}G.offsetWidth!==0?A():ap.swap(G,n,A);return Math.max(0,Math.round(w))}return ap.curCSS(G,F,s)},curCSS:function(F,A,s){var G,w=F.style;if(!ap.support.opacity&&A==="opacity"&&F.currentStyle){G=aG.test(F.currentStyle.filter||"")?parseFloat(RegExp.$1)/100+"":"";return G===""?"1":G}if(a6.test(A)){A=av}if(!s&&w&&w[A]){G=w[A]}else{if(v){if(a6.test(A)){A="float"}A=A.replace(bl,"-$1").toLowerCase();w=F.ownerDocument.defaultView;if(!w){return null}if(F=w.getComputedStyle(F,null)){G=F.getPropertyValue(A)}if(A==="opacity"&&G===""){G="1"}}else{if(F.currentStyle){s=A.replace(a7,a4);G=F.currentStyle[A]||F.currentStyle[s];if(!a.test(G)&&m.test(G)){A=w.left;var c=F.runtimeStyle.left;F.runtimeStyle.left=F.currentStyle.left;w.left=s==="fontSize"?"1em":G||0;G=w.pixelLeft+"px";w.left=A;F.runtimeStyle.left=c}}}}return G},swap:function(A,w,c){var F={};for(var s in w){F[s]=A.style[s];A.style[s]=w[s]}c.call(A);for(s in w){A.style[s]=F[s]}}});if(ap.expr&&ap.expr.filters){ap.expr.filters.hidden=function(w){var s=w.offsetWidth,c=w.offsetHeight,A=w.nodeName.toLowerCase()==="tr";return s===0&&c===0&&!A?true:s>0&&c>0&&!A?false:ap.curCSS(w,"display")==="none"};ap.expr.filters.visible=function(c){return !ap.expr.filters.hidden(c)}}var x=ac(),D=/<script(.|\s)*?\/script>/gi,E=/select|textarea/i,bb=/color|date|datetime|email|hidden|month|number|password|range|search|tel|text|time|url|week/i,af=/=\?(&|$)/,a5=/\?/,l=/(\?|&)_=.*?(&|$)/,aY=/^(\w+:)?\/\/([^\/?#]+)/,u=/%20/g,t=ap.fn.load;ap.fn.extend({load:function(F,A,s){if(typeof F!=="string"){return t.call(this,F)}else{if(!this.length){return this}}var G=F.indexOf(" ");if(G>=0){var w=F.slice(G,F.length);F=F.slice(0,G)}G="GET";if(A){if(ap.isFunction(A)){s=A;A=null}else{if(typeof A==="object"){A=ap.param(A,ap.ajaxSettings.traditional);G="POST"}}}var c=this;ap.ajax({url:F,type:G,dataType:"html",data:A,complete:function(J,K){if(K==="success"||K==="notmodified"){c.html(w?ap("<div />").append(J.responseText.replace(D,"")).find(w):J.responseText)}s&&c.each(s,[J.responseText,K,J])}});return this},serialize:function(){return ap.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?ap.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||E.test(this.nodeName)||bb.test(this.type))}).map(function(s,c){s=ap(this).val();return s==null?null:ap.isArray(s)?ap.map(s,function(w){return{name:c.name,value:w}}):{name:c.name,value:s}}).get()}});ap.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(s,c){ap.fn[c]=function(w){return this.bind(c,w)}});ap.extend({get:function(w,s,c,A){if(ap.isFunction(s)){A=A||c;c=s;s=null}return ap.ajax({type:"GET",url:w,data:s,success:c,dataType:A})},getScript:function(s,c){return ap.get(s,null,c,"script")},getJSON:function(w,s,c){return ap.get(w,s,c,"json")},post:function(w,s,c,A){if(ap.isFunction(s)){A=A||c;c=s;s={}}return ap.ajax({type:"POST",url:w,data:s,success:c,dataType:A})},ajaxSetup:function(c){ap.extend(ap.ajaxSettings,c)},ajaxSettings:{url:location.href,global:true,type:"GET",contentType:"application/x-www-form-urlencoded",processData:true,async:true,xhr:aj.XMLHttpRequest&&(aj.location.protocol!=="file:"||!aj.ActiveXObject)?function(){return new aj.XMLHttpRequest}:function(){try{return new aj.ActiveXObject("Microsoft.XMLHTTP")}catch(c){}},accepts:{xml:"application/xml, text/xml",html:"text/html",script:"text/javascript, application/javascript",json:"application/json, text/javascript",text:"text/plain",_default:"*/*"}},lastModified:{},etag:{},ajax:function(Q){function P(){W.success&&W.success.call(F,L,J,ba);W.global&&R("ajaxSuccess",[ba,W])}function V(){W.complete&&W.complete.call(F,ba,J);W.global&&R("ajaxComplete",[ba,W]);W.global&&!--ap.active&&ap.event.trigger("ajaxStop")}function R(bn,bm){(W.context?ap(W.context):ap.event).trigger(bn,bm)}var W=ap.extend(true,{},ap.ajaxSettings,Q),A,J,L,F=Q&&Q.context||W,K=W.type.toUpperCase();if(W.data&&W.processData&&typeof W.data!=="string"){W.data=ap.param(W.data,W.traditional)}if(W.dataType==="jsonp"){if(K==="GET"){af.test(W.url)||(W.url+=(a5.test(W.url)?"&":"?")+(W.jsonp||"callback")+"=?")}else{if(!W.data||!af.test(W.data)){W.data=(W.data?W.data+"&":"")+(W.jsonp||"callback")+"=?"}}W.dataType="json"}if(W.dataType==="json"&&(W.data&&af.test(W.data)||af.test(W.url))){A=W.jsonpCallback||"jsonp"+x++;if(W.data){W.data=(W.data+"").replace(af,"="+A+"$1")}W.url=W.url.replace(af,"="+A+"$1");W.dataType="script";aj[A]=aj[A]||function(bn){L=bn;P();V();aj[A]=an;try{delete aj[A]}catch(bm){}aa&&aa.removeChild(Y)}}if(W.dataType==="script"&&W.cache===null){W.cache=false}if(W.cache===false&&K==="GET"){var c=ac(),w=W.url.replace(l,"$1_="+c+"$2");W.url=w+(w===W.url?(a5.test(W.url)?"&":"?")+"_="+c:"")}if(W.data&&K==="GET"){W.url+=(a5.test(W.url)?"&":"?")+W.data}W.global&&!ap.active++&&ap.event.trigger("ajaxStart");c=(c=aY.exec(W.url))&&(c[1]&&c[1]!==location.protocol||c[2]!==location.host);if(W.dataType==="script"&&K==="GET"&&c){var aa=am.getElementsByTagName("head")[0]||am.documentElement,Y=am.createElement("script");Y.src=W.url;if(W.scriptCharset){Y.charset=W.scriptCharset}if(!A){var X=false;Y.onload=Y.onreadystatechange=function(){if(!X&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){X=true;P();V();Y.onload=Y.onreadystatechange=null;aa&&Y.parentNode&&aa.removeChild(Y)}}}aa.insertBefore(Y,aa.firstChild);return an}var Z=false,ba=W.xhr();if(ba){W.username?ba.open(K,W.url,W.async,W.username,W.password):ba.open(K,W.url,W.async);try{if(W.data||Q&&Q.contentType){ba.setRequestHeader("Content-Type",W.contentType)}if(W.ifModified){ap.lastModified[W.url]&&ba.setRequestHeader("If-Modified-Since",ap.lastModified[W.url]);ap.etag[W.url]&&ba.setRequestHeader("If-None-Match",ap.etag[W.url])}c||ba.setRequestHeader("X-Requested-With","XMLHttpRequest");ba.setRequestHeader("Accept",W.dataType&&W.accepts[W.dataType]?W.accepts[W.dataType]+", */*":W.accepts._default)}catch(s){}if(W.beforeSend&&W.beforeSend.call(F,ba,W)===false){W.global&&!--ap.active&&ap.event.trigger("ajaxStop");ba.abort();return false}W.global&&R("ajaxSend",[ba,W]);var T=ba.onreadystatechange=function(bn){if(!ba||ba.readyState===0||bn==="abort"){Z||V();Z=true;if(ba){ba.onreadystatechange=ap.noop}}else{if(!Z&&ba&&(ba.readyState===4||bn==="timeout")){Z=true;ba.onreadystatechange=ap.noop;J=bn==="timeout"?"timeout":!ap.httpSuccess(ba)?"error":W.ifModified&&ap.httpNotModified(ba,W.url)?"notmodified":"success";var bm;if(J==="success"){try{L=ap.httpData(ba,W.dataType,W)}catch(bo){J="parsererror";bm=bo}}if(J==="success"||J==="notmodified"){A||P()}else{ap.handleError(W,ba,J,bm)}V();bn==="timeout"&&ba.abort();if(W.async){ba=null}}}};try{var G=ba.abort;ba.abort=function(){ba&&G.call(ba);T("abort")}}catch(N){}W.async&&W.timeout>0&&setTimeout(function(){ba&&!Z&&T("timeout")},W.timeout);try{ba.send(K==="POST"||K==="PUT"||K==="DELETE"?W.data:null)}catch(O){ap.handleError(W,ba,null,O);V()}W.async||T();return ba}},handleError:function(w,s,c,A){if(w.error){w.error.call(w.context||w,s,c,A)}if(w.global){(w.context?ap(w.context):ap.event).trigger("ajaxError",[s,w,A])}},active:0,httpSuccess:function(s){try{return !s.status&&location.protocol==="file:"||s.status>=200&&s.status<300||s.status===304||s.status===1223||s.status===0}catch(c){}return false},httpNotModified:function(w,s){var c=w.getResponseHeader("Last-Modified"),A=w.getResponseHeader("Etag");if(c){ap.lastModified[s]=c}if(A){ap.etag[s]=A}return w.status===304||w.status===0},httpData:function(A,w,c){var F=A.getResponseHeader("content-type")||"",s=w==="xml"||!w&&F.indexOf("xml")>=0;A=s?A.responseXML:A.responseText;s&&A.documentElement.nodeName==="parsererror"&&ap.error("parsererror");if(c&&c.dataFilter){A=c.dataFilter(A,w)}if(typeof A==="string"){if(w==="json"||!w&&F.indexOf("json")>=0){A=ap.parseJSON(A)}else{if(w==="script"||!w&&F.indexOf("javascript")>=0){ap.globalEval(A)}}}return A},param:function(F,A){function s(J,K){if(ap.isArray(K)){ap.each(K,function(N,L){A||/\[\]$/.test(J)?G(J,L):s(J+"["+(typeof L==="object"||ap.isArray(L)?N:"")+"]",L)})}else{!A&&K!=null&&typeof K==="object"?ap.each(K,function(N,L){s(J+"["+N+"]",L)}):G(J,K)}}
		function G(J,K){K=ap.isFunction(K)?K():K;w[w.length]=encodeURIComponent(J)+"="+encodeURIComponent(K)}var w=[];if(A===an){A=ap.ajaxSettings.traditional}if(ap.isArray(F)||F.jquery){ap.each(F,function(){G(this.name,this.value)})}else{for(var c in F){s(c,F[c])}}return w.join("&").replace(u,"+")}});var ai={},aT=/toggle|show|hide/,q=/^([+-]=)?([\d+-.]+)(.*)$/,U,p=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]];ap.fn.extend({show:function(A,w){if(A||A===0){return this.animate(ad("show",3),A,w)}else{A=0;for(w=this.length;A<w;A++){var c=ap.data(this[A],"olddisplay");this[A].style.display=c||"";if(ap.css(this[A],"display")==="none"){c=this[A].nodeName;var F;if(ai[c]){F=ai[c]}else{var s=ap("<"+c+" />").appendTo("body");F=s.css("display");if(F==="none"){F="block"}s.remove();ai[c]=F}ap.data(this[A],"olddisplay",F)}}A=0;for(w=this.length;A<w;A++){this[A].style.display=ap.data(this[A],"olddisplay")||""}return this}},hide:function(w,s){if(w||w===0){return this.animate(ad("hide",3),w,s)}else{w=0;for(s=this.length;w<s;w++){var c=ap.data(this[w],"olddisplay");!c&&c!=="none"&&ap.data(this[w],"olddisplay",ap.css(this[w],"display"))}w=0;for(s=this.length;w<s;w++){this[w].style.display="none"}return this}},_toggle:ap.fn.toggle,toggle:function(w,s){var c=typeof w==="boolean";if(ap.isFunction(w)&&ap.isFunction(s)){this._toggle.apply(this,arguments)}else{w==null||c?this.each(function(){var A=c?w:ap(this).is(":hidden");ap(this)[A?"show":"hide"]()}):this.animate(ad("toggle",3),w,s)}return this},fadeTo:function(w,s,c){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:s},w,c)},animate:function(A,w,c,F){var s=ap.speed(w,c,F);if(ap.isEmptyObject(A)){return this.each(s.complete)}return this[s.queue===false?"each":"queue"](function(){var L=ap.extend({},s),G,K=this.nodeType===1&&ap(this).is(":hidden"),N=this;for(G in A){var J=G.replace(a7,a4);if(G!==J){A[J]=A[G];delete A[G];G=J}if(A[G]==="hide"&&K||A[G]==="show"&&!K){return L.complete.call(this)}if((G==="height"||G==="width")&&this.style){L.display=ap.css(this,"display");L.overflow=this.style.overflow}if(ap.isArray(A[G])){(L.specialEasing=L.specialEasing||{})[G]=A[G][1];A[G]=A[G][0]}}if(L.overflow!=null){this.style.overflow="hidden"}L.curAnim=ap.extend({},A);ap.each(A,function(O,T){var Q=new ap.fx(N,L,O);if(aT.test(T)){Q[T==="toggle"?K?"show":"hide":T](A)}else{var V=q.exec(T),R=Q.cur(true)||0;if(V){T=parseFloat(V[2]);var P=V[3]||"px";if(P!=="px"){N.style[O]=(T||1)+P;R=(T||1)/Q.cur(true)*R;N.style[O]=R+P}if(V[1]){T=(V[1]==="-="?-1:1)*T+R}Q.custom(R,T,P)}else{Q.custom(R,T,"")}}});return true})},stop:function(w,s){var c=ap.timers;w&&this.queue([]);this.each(function(){for(var A=c.length-1;A>=0;A--){if(c[A].elem===this){s&&c[A](true);c.splice(A,1)}}});s||this.dequeue();return this}});ap.each({slideDown:ad("show",1),slideUp:ad("hide",1),slideToggle:ad("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"}},function(s,c){ap.fn[s]=function(w,A){return this.animate(c,w,A)}});ap.extend({speed:function(w,s,c){var A=w&&typeof w==="object"?w:{complete:c||!c&&s||ap.isFunction(w)&&w,duration:w,easing:c&&s||s&&!ap.isFunction(s)&&s};A.duration=ap.fx.off?0:typeof A.duration==="number"?A.duration:ap.fx.speeds[A.duration]||ap.fx.speeds._default;A.old=A.complete;A.complete=function(){A.queue!==false&&ap(this).dequeue();ap.isFunction(A.old)&&A.old.call(this)};return A},easing:{linear:function(w,s,c,A){return c+A*w},swing:function(w,s,c,A){return(-Math.cos(w*Math.PI)/2+0.5)*A+c}},timers:[],fx:function(w,s,c){this.options=s;this.elem=w;this.prop=c;if(!s.orig){s.orig={}}}});ap.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this);(ap.fx.step[this.prop]||ap.fx.step._default)(this);if((this.prop==="height"||this.prop==="width")&&this.elem.style){this.elem.style.display="block"}},cur:function(c){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null)){return this.elem[this.prop]}return(c=parseFloat(ap.css(this.elem,this.prop,c)))&&c>-10000?c:parseFloat(ap.curCSS(this.elem,this.prop))||0},custom:function(A,w,c){function F(G){return s.step(G)}this.startTime=ac();this.start=A;this.end=w;this.unit=c||this.unit||"px";this.now=this.start;this.pos=this.state=0;var s=this;F.elem=this.elem;if(F()&&ap.timers.push(F)&&!U){U=setInterval(ap.fx.tick,13)}},show:function(){this.options.orig[this.prop]=ap.style(this.elem,this.prop);this.options.show=true;this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur());ap(this.elem).show()},hide:function(){this.options.orig[this.prop]=ap.style(this.elem,this.prop);this.options.hide=true;this.custom(this.cur(),0)},step:function(A){var w=ac(),c=true;if(A||w>=this.options.duration+this.startTime){this.now=this.end;this.pos=this.state=1;this.update();this.options.curAnim[this.prop]=true;for(var F in this.options.curAnim){if(this.options.curAnim[F]!==true){c=false}}if(c){if(this.options.display!=null){this.elem.style.overflow=this.options.overflow;A=ap.data(this.elem,"olddisplay");this.elem.style.display=A?A:this.options.display;if(ap.css(this.elem,"display")==="none"){this.elem.style.display="block"}}this.options.hide&&ap(this.elem).hide();if(this.options.hide||this.options.show){for(var s in this.options.curAnim){ap.style(this.elem,s,this.options.orig[s])}}this.options.complete.call(this.elem)}return false}else{s=w-this.startTime;this.state=s/this.options.duration;A=this.options.easing||(ap.easing.swing?"swing":"linear");this.pos=ap.easing[this.options.specialEasing&&this.options.specialEasing[this.prop]||A](this.state,s,0,1,this.options.duration);this.now=this.start+(this.end-this.start)*this.pos;this.update()}return true}};ap.extend(ap.fx,{tick:function(){for(var s=ap.timers,c=0;c<s.length;c++){s[c]()||s.splice(c--,1)}s.length||ap.fx.stop()},stop:function(){clearInterval(U);U=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(c){ap.style(c.elem,"opacity",c.now)},_default:function(c){if(c.elem.style&&c.elem.style[c.prop]!=null){c.elem.style[c.prop]=(c.prop==="width"||c.prop==="height"?Math.max(0,c.now):c.now)+c.unit}else{c.elem[c.prop]=c.now}}}});if(ap.expr&&ap.expr.filters){ap.expr.filters.animated=function(c){return ap.grep(ap.timers,function(s){return c===s.elem}).length}}ap.fn.offset="getBoundingClientRect" in am.documentElement?function(w){var s=this[0];if(w){return this.each(function(F){ap.offset.setOffset(this,w,F)})}if(!s||!s.ownerDocument){return null}if(s===s.ownerDocument.body){return ap.offset.bodyOffset(s)}var c=s.getBoundingClientRect(),A=s.ownerDocument;s=A.body;A=A.documentElement;return{top:c.top+(self.pageYOffset||ap.support.boxModel&&A.scrollTop||s.scrollTop)-(A.clientTop||s.clientTop||0),left:c.left+(self.pageXOffset||ap.support.boxModel&&A.scrollLeft||s.scrollLeft)-(A.clientLeft||s.clientLeft||0)}}:function(K){var J=this[0];if(K){return this.each(function(O){ap.offset.setOffset(this,K,O)})}if(!J||!J.ownerDocument){return null}if(J===J.ownerDocument.body){return ap.offset.bodyOffset(J)}ap.offset.initialize();var N=J.offsetParent,L=J,c=J.ownerDocument,s,A=c.documentElement,G=c.body;L=(c=c.defaultView)?c.getComputedStyle(J,null):J.currentStyle;for(var w=J.offsetTop,F=J.offsetLeft;(J=J.parentNode)&&J!==G&&J!==A;){if(ap.offset.supportsFixedPosition&&L.position==="fixed"){break}s=c?c.getComputedStyle(J,null):J.currentStyle;w-=J.scrollTop;F-=J.scrollLeft;if(J===N){w+=J.offsetTop;F+=J.offsetLeft;if(ap.offset.doesNotAddBorder&&!(ap.offset.doesAddBorderForTableAndCells&&/^t(able|d|h)$/i.test(J.nodeName))){w+=parseFloat(s.borderTopWidth)||0;F+=parseFloat(s.borderLeftWidth)||0}L=N;N=J.offsetParent}if(ap.offset.subtractsBorderForOverflowNotVisible&&s.overflow!=="visible"){w+=parseFloat(s.borderTopWidth)||0;F+=parseFloat(s.borderLeftWidth)||0}L=s}if(L.position==="relative"||L.position==="static"){w+=G.offsetTop;F+=G.offsetLeft}if(ap.offset.supportsFixedPosition&&L.position==="fixed"){w+=Math.max(A.scrollTop,G.scrollTop);F+=Math.max(A.scrollLeft,G.scrollLeft)}return{top:w,left:F}};ap.offset={initialize:function(){var F=am.body,A=am.createElement("div"),s,G,w,c=parseFloat(ap.curCSS(F,"marginTop",true))||0;ap.extend(A.style,{position:"absolute",top:0,left:0,margin:0,border:0,width:"1px",height:"1px",visibility:"hidden"});A.innerHTML="<div style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;'><div></div></div><table style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>";F.insertBefore(A,F.firstChild);s=A.firstChild;G=s.firstChild;w=s.nextSibling.firstChild.firstChild;this.doesNotAddBorder=G.offsetTop!==5;this.doesAddBorderForTableAndCells=w.offsetTop===5;G.style.position="fixed";G.style.top="20px";this.supportsFixedPosition=G.offsetTop===20||G.offsetTop===15;G.style.position=G.style.top="";s.style.overflow="hidden";s.style.position="relative";this.subtractsBorderForOverflowNotVisible=G.offsetTop===-5;this.doesNotIncludeMarginInBodyOffset=F.offsetTop!==c;F.removeChild(A);ap.offset.initialize=ap.noop},bodyOffset:function(w){var s=w.offsetTop,c=w.offsetLeft;ap.offset.initialize();if(ap.offset.doesNotIncludeMarginInBodyOffset){s+=parseFloat(ap.curCSS(w,"marginTop",true))||0;c+=parseFloat(ap.curCSS(w,"marginLeft",true))||0}return{top:s,left:c}},setOffset:function(G,F,s){if(/static/.test(ap.curCSS(G,"position"))){G.style.position="relative"}var J=ap(G),w=J.offset(),c=parseInt(ap.curCSS(G,"top",true),10)||0,A=parseInt(ap.curCSS(G,"left",true),10)||0;if(ap.isFunction(F)){F=F.call(G,s,w)}s={top:F.top-w.top+c,left:F.left-w.left+A};"using" in F?F.using.call(G,s):J.css(s)}};ap.fn.extend({position:function(){if(!this[0]){return null}var w=this[0],s=this.offsetParent(),c=this.offset(),A=/^body|html$/i.test(s[0].nodeName)?{top:0,left:0}:s.offset();c.top-=parseFloat(ap.curCSS(w,"marginTop",true))||0;c.left-=parseFloat(ap.curCSS(w,"marginLeft",true))||0;A.top+=parseFloat(ap.curCSS(s[0],"borderTopWidth",true))||0;A.left+=parseFloat(ap.curCSS(s[0],"borderLeftWidth",true))||0;return{top:c.top-A.top,left:c.left-A.left}},offsetParent:function(){return this.map(function(){for(var c=this.offsetParent||am.body;c&&!/^body|html$/i.test(c.nodeName)&&ap.css(c,"position")==="static";){c=c.offsetParent}return c})}});ap.each(["Left","Top"],function(w,s){var c="scroll"+s;ap.fn[c]=function(G){var A=this[0],F;if(!A){return null}if(G!==an){return this.each(function(){if(F=aZ(this)){F.scrollTo(!w?G:ap(F).scrollLeft(),w?G:ap(F).scrollTop())}else{this[c]=G}})}else{return(F=aZ(A))?"pageXOffset" in F?F[w?"pageYOffset":"pageXOffset"]:ap.support.boxModel&&F.document.documentElement[c]||F.document.body[c]:A[c]}}});ap.each(["Height","Width"],function(w,s){var c=s.toLowerCase();ap.fn["inner"+s]=function(){return this[0]?ap.css(this[0],c,false,"padding"):null};ap.fn["outer"+s]=function(A){return this[0]?ap.css(this[0],c,false,A?"margin":"border"):null};ap.fn[c]=function(F){var A=this[0];if(!A){return F==null?null:this}if(ap.isFunction(F)){return this.each(function(J){var G=ap(this);G[c](F.call(this,J,G[c]()))})}return"scrollTo" in A&&A.document?A.document.compatMode==="CSS1Compat"&&A.document.documentElement["client"+s]||A.document.body["client"+s]:A.nodeType===9?Math.max(A.documentElement["client"+s],A.body["scroll"+s],A.documentElement["scroll"+s],A.body["offset"+s],A.documentElement["offset"+s]):F===an?ap.css(A,c):this.css(c,typeof F==="string"?F:F+"px")}});aj.jQuery=aj.$=ap})(window);var Langs=new Array();(function(a){a.fn.changeLang=function(b){var c={file:"Languages/vbdMap-lang.xml",lang:"vi"};if(b){a.extend(c,b)}a.ajax({type:"GET",url:c.file,dataType:"xml",async:false,success:function(d){a(d).find("text").each(function(){var f=a(this).attr("name");var e=a(this).find("vi").text();var g=a(this).find(c.lang).text();if(f!=""){Langs[f]=g}a("a, span, input, h1, h2, h3").each(function(){if(a(this).text()!=""&&a(this).text()==e){a(this).text(g)}else{if(a(this).val()!=""&&a(this).val()==e){a(this).val(g)}}})})}})}})(jQuery);function Node(f,a,b,h,c,g,d,j,e){this.id=f;this.parentid=a;this.name=b;this.url=h;this.title=c;this.target=g;this.icon=d;this.iconOpen=j;this.isOpen=e||false;this.isSelected=false;this._ls=false;this._hc=false;this._ai=0;this.parent}function dTree(b,a){this.imgDir="vbdScript/dtree/";if(a!=this.imgDir&&a!=null){this.imgDir=a}this.config={target:null,folderLinks:true,useSelection:true,useCookies:true,useLines:true,useIcons:true,useStatusText:false,closeSameLevel:false,inOrder:false};this.icon={root:this.imgDir+"img/base.gif",folder:this.imgDir+"img/folder.gif",folderOpen:this.imgDir+"img/folderopen.gif",node:this.imgDir+"img/page.gif",empty:this.imgDir+"img/empty.gif",line:this.imgDir+"img/line.gif",join:this.imgDir+"img/join.gif",joinBottom:this.imgDir+"img/joinbottom.gif",plus:this.imgDir+"img/plus.gif",plusBottom:this.imgDir+"img/plusbottom.gif",minus:this.imgDir+"img/minus.gif",minusBottom:this.imgDir+"img/minusbottom.gif",nlPlus:this.imgDir+"img/nolinesparentlus.gif",nlMinus:this.imgDir+"img/nolines_minus.gif"};this.obj=b;this.Nodes=[];this.aIndent=[];this.root=new Node(-1);this.selectedNode=null;this.selectedFound=false;this.completed=false}dTree.prototype.add=function(f,a,b,h,c,g,d,j,e){this.Nodes[this.Nodes.length]=new Node(f,a,b,h,c,g,d,j,e)};dTree.prototype.openAll=function(){this.openAll(true)};dTree.prototype.closeAll=function(){this.openAll(false)};dTree.prototype.toString=function(){var a='<div class="dtree">\n';if(document.getElementById){if(this.config.useCookies){this.selectedNode=this.getSelected()}a+=this.addNode(this.root)}else{a+="Browser not supported."}a+="</div>";if(!this.selectedFound){this.selectedNode=null}this.completed=true;return a};dTree.prototype.addNode=function(c){var d="";var b=0;if(this.config.inOrder){b=c._ai}for(b;b<this.Nodes.length;b++){if(this.Nodes[b].parentid==c.id){var a=this.Nodes[b];a.parent=c;a._ai=b;this.setCS(a);if(!a.target&&this.config.target){a.target=this.config.target}if(a._hc&&!a.isOpen&&this.config.useCookies){a.isOpen=this.isOpen(a.id)}if(!this.config.folderLinks&&a._hc){a.url=null}if(this.config.useSelection&&a._ai==this.selectedNode&&!this.selectedFound){a.isSelected=true;this.selectedNode=b;this.selectedFound=true}d+=this.node(a,b);if(a._ls){break}}}return d};dTree.prototype.node=function(c,b){var a="";if(this.config.useIcons){if(!c.icon){c.icon=(this.root.id==c.parentid)?this.icon.root:((c._hc)?this.icon.folder:this.icon.node)}if(!c.iconOpen){c.iconOpen=(c._hc)?this.icon.folderOpen:this.icon.node}if(this.root.id==c.parentid){c.icon=this.icon.root;c.iconOpen=this.icon.root}a=((c.isOpen)?c.iconOpen:c.icon)}var d='<div class="dTreeNode">';if(c._ai==0){d='<div class="dTreeNav" style="background: url('+a+') no-repeat;" >'}if(c.url){d+='<a id="s'+this.obj+b+'" class="'+((this.config.useSelection)?((c.isSelected?"nodeSel":"node")):"node")+'" href="'+c.url+'"';if(c.title){d+=' title="'+c.title+'"'}if(c.target){d+=' target="'+c.target+'"'}if(this.config.useStatusText){d+=" onmouseover=\"window.status='"+c.name+"';return true;\" onmouseout=\"window.status='';return true;\" "}else{d+=" onmouseover=\"window.status='';return true;\" onmouseout=\"window.status='';return true;\" "}if(this.config.useSelection&&((c._hc&&this.config.folderLinks)||!c._hc)){d+=' onclick="javascript: '+this.obj+".s("+b+');"'}d+=">"}else{if((!this.config.folderLinks||!c.url)&&c._hc&&c.parentid!=this.root.id){d+='<a href="javascript: '+this.obj+".o("+b+');" class="node">'}}d+=c.name;if(c.url||((!this.config.folderLinks||!c.url)&&c._hc)){d+="</a>"}d+="</div>";if(c._hc){d+='<div id="d'+this.obj+b+'" class="clip" style="display:'+((this.root.id==c.parentid||c.isOpen)?"block":"none")+';">';d+=this.addNode(c);d+="</div>"}this.aIndent.pop();return d};dTree.prototype.indent=function(c,a){var d="";if(this.root.id!=c.parentid){for(var b=0;b<this.aIndent.length;b++){d+='<img src="'+((this.aIndent[b]==1&&this.config.useLines)?this.icon.line:this.icon.empty)+'" alt="" />'}(c._ls)?this.aIndent.push(0):this.aIndent.push(1);if(c._hc){d+='<a href="javascript: '+this.obj+".o("+a+');"><img id="j'+this.obj+a+'" src="';if(!this.config.useLines){d+=(c.isOpen)?this.icon.nlMinus:this.icon.nlPlus}else{d+=((c.isOpen)?((c._ls&&this.config.useLines)?this.icon.minusBottom:this.icon.minus):((c._ls&&this.config.useLines)?this.icon.plusBottom:this.icon.plus))}d+='" alt="" /></a>'}else{d+='<img src="'+((this.config.useLines)?((c._ls)?this.icon.joinBottom:this.icon.join):this.icon.empty)+'" alt="" />'}}return d};dTree.prototype.setCS=function(c){var a;for(var b=0;b<this.Nodes.length;b++){if(this.Nodes[b].parentid==c.id){c._hc=true}if(this.Nodes[b].parentid==c.parentid){a=this.Nodes[b].id}}if(a==c.id){c._ls=true}};dTree.prototype.DeleteNode=function(a){this.DeleteAllChild(a);for(var b=0;b<this.Nodes.length;b++){if(this.Nodes[b].id==a){RemoveElement(this.Nodes,b);break}}};dTree.prototype.ChangeName=function(a,c){for(var b=0;b<this.Nodes.length;b++){if(this.Nodes[b].id==a){this.Nodes[b].name=c}}};dTree.prototype.AddNew=function(a,b,c){this.add(a,b,c,"javascript:this.SelectNode("+a+")");this.openTo(a,true,true)};function RemoveElement(c,b){for(var a=b;a<c.length-1;a++){c[a]=c[a+1]}c.pop()}dTree.prototype.DeleteAllChild=function(a){for(var b=0;b<this.Nodes.length;b++){if(this.Nodes[b].parentid==a){RemoveElement(this.Nodes,b)}}};dTree.prototype.GetIndexOfarr=function(b){for(var a=0;a<this.Nodes.length;a++){if(this.Nodes[a].id==b){return a}}return -1};dTree.prototype.ChildsCount=function(c){var a=0;for(var b=0;b<this.Nodes.length;b++){if(this.Nodes[b].parentid==c){a++}}return a};dTree.prototype.isOpening=function(b){var a=this.getNode(b);return a.isOpen};dTree.prototype.ToggleNode=function(b){var a=this.getNode(b);this.o(a._ai)};dTree.prototype.getNode=function(b){for(var a=0;a<this.Nodes.length;a++){if(this.Nodes[a].id==b){return this.Nodes[a]}}};dTree.prototype.getSelected=function(){var a=this.getCookie("cs"+this.obj);return(a)?a:null};dTree.prototype.s=function(b){if(!this.config.useSelection){return}var a=this.Nodes[b];if(a._hc&&!this.config.folderLinks){return}if(this.selectedNode!=b){if(this.selectedNode||this.selectedNode==0){eOld=document.getElementById("s"+this.obj+this.selectedNode);eOld.className="node";this.Nodes[this.selectedNode].isSelected=false}eNew=document.getElementById("s"+this.obj+b);if(eNew==null){return}eNew.className="nodeSel";a.isSelected=true;this.selectedNode=b;if(this.config.useCookies){this.setCookie("cs"+this.obj,a.id)}}};dTree.prototype.o=function(b){var a=this.Nodes[b];this.nodeStatus(!a.isOpen,b,a._ls);a.isOpen=!a.isOpen;if(this.config.closeSameLevel){this.closeLevel(a)}if(this.config.useCookies){this.updateCookie()}};dTree.prototype.openAll=function(b){for(var a=0;a<this.Nodes.length;a++){if(this.Nodes[a]._hc&&this.Nodes[a].parentid!=this.root.id){this.nodeStatus(b,a,this.Nodes[a]._ls);this.Nodes[a].isOpen=b}}if(this.config.useCookies){this.updateCookie()}};dTree.prototype.openTo=function(b,e,a){if(!a){for(var c=0;c<this.Nodes.length;c++){if(this.Nodes[c].id==b){b=c;break}}}var d=this.Nodes[b];if(d.parentid==this.root.id||!d.parent){return}d.isOpen=true;d.isSelected=e;if(this.completed&&d._hc){this.nodeStatus(true,d._ai,d._ls)}if(this.completed&&e){this.s(d._ai)}else{if(e){this._sn=d._ai}}this.openTo(d.parent._ai,false,true)};dTree.prototype.closeLevel=function(b){for(var a=0;a<this.Nodes.length;a++){if(this.Nodes[a].parentid==b.parentid&&this.Nodes[a].id!=b.id&&this.Nodes[a]._hc){this.nodeStatus(false,a,this.Nodes[a]._ls);this.Nodes[a].isOpen=false;this.closeAllChildren(this.Nodes[a])}}};dTree.prototype.closeAllChildren=function(b){for(var a=0;a<this.Nodes.length;a++){if(this.Nodes[a].parentid==b.id&&this.Nodes[a]._hc){if(this.Nodes[a].isOpen){this.nodeStatus(false,a,this.Nodes[a]._ls)}this.Nodes[a].isOpen=false;this.closeAllChildren(this.Nodes[a])}}};dTree.prototype.nodeStatus=function(b,c,a){eDiv=document.getElementById("d"+this.obj+c);eJoin=document.getElementById("j"+this.obj+c);if(this.config.useIcons){eIcon=document.getElementById("i"+this.obj+c);eIcon.src=(b)?this.Nodes[c].iconOpen:this.Nodes[c].icon}eJoin.src=(this.config.useLines)?((b)?((a)?this.icon.minusBottom:this.icon.minus):((a)?this.icon.plusBottom:this.icon.plus)):((b)?this.icon.nlMinus:this.icon.nlPlus);eDiv.style.display=(b)?"block":"none"};dTree.prototype.clearCookie=function(){var b=new Date();var a=new Date(b.getTime()-1000*60*60*24);this.setCookie("co"+this.obj,"cookieValue",a);this.setCookie("cs"+this.obj,"cookieValue",a)};dTree.prototype.setCookie=function(c,a,f,b,e,d){document.cookie=escape(c)+"="+escape(a)+(f?"; expires="+f.toGMTString():"")+(b?"; path="+b:"")+(e?"; domain="+e:"")+(d?"; secure":"")};dTree.prototype.getCookie=function(d){var b="";var c=document.cookie.indexOf(escape(d)+"=");if(c!=-1){var a=c+(escape(d)+"=").length;var e=document.cookie.indexOf(";",a);if(e!=-1){b=unescape(document.cookie.substring(a,e))}else{b=unescape(document.cookie.substring(a))}}return(b)};dTree.prototype.updateCookie=function(){var b="";for(var a=0;a<this.Nodes.length;a++){if(this.Nodes[a].isOpen&&this.Nodes[a].parentid!=this.root.id){if(b){b+="."}b+=this.Nodes[a].id}}this.setCookie("co"+this.obj,b)};dTree.prototype.isOpen=function(c){var a=this.getCookie("co"+this.obj).split(".");for(var b=0;b<a.length;b++){if(a[b]==c){return true}}return false};if(!Array.prototype.push){Array.prototype.push=function arrayparentush(){for(var a=0;a<arguments.length;a++){this[this.length]=arguments[a]}return this.length}}if(!Array.prototype.pop){Array.prototype.pop=function arrayparentop(){lastElement=this[this.length-1];this.length=Math.max(this.length-1,0);return lastElement}}var GLOBAL_SEARCH_ALL=0;var GLOBAL_SEARCH_BUSINESS=1;var GLOBAL_SEARCH_MAP=2;var GLOBAL_SEARCH_ADDRESS=2;var GLOBAL_SEARCH_FUNCTION=3;var GLOBAL_FINDPATH_FUNCTION=4;var GLOBAL_MYMAP_FUNCTION=5;var GLOBAL_ACTIVE_ZINDEX=2;var GLOBAL_HIDDEN_ZINDEX=1;var map;var cMnu=null;var current_searchtype=0;var current_functype;var MARKER_POI=0;var MARKER_AB=1;var MYMAPOBJ=2;var MMCONTROLOBJ=3;var MMAPCONTROLOBJ=4;var FPMARKEROBJ=5;var FPPOLYLINEOBJ=6;var ADDPLACEOBJ=7;var MARKER_MPOI=8;var BLOCKHOUSEOBJ=9;var TRAFFICJAMOBJ=10;var mkD=null;var mkP=null;var mkOP=null;var arrow=null;var directionLatLng=null;var directionLevel=null;var onlineSupportShow=false;var SearchWhat="";var SearchWhere="";var CurrentCenter;var ClientID;var lastPointClick=null;function ChangeTextColor(a,b){if(a!=null){a.style.color=b}}function ChangeFontWeight(b,a){if(b!=null){b.style.fontWeight=a}}var firstLoadMymap=false;function ChangeFunctionType(a){current_functype=a;var d="Clear result",c="Create new map";if(nLanguage==0){d="Xa k?t qu?";c="T?o b?n d? m?i"}if(a==GLOBAL_SEARCH_FUNCTION){activeTabById("searchtab");document.getElementById("clearSearchResultText").innerHtml=d;document.getElementById("clearSearchResultText").onclick=ClearSearchResult;for(var b=0;b<arrSearchMapResult.length;b++){arrSearchMapResult[b].show()}}else{if(a==GLOBAL_FINDPATH_FUNCTION){activeTabById("findpathtab");document.getElementById("clearPathResultText").innerHtml=d;document.getElementById("clearPathResultText").onclick=ClearPathResult;LoadDirectionTool();for(var b=PlaceToFindPathArray.length-1;b>=0;b--){RemovePlace_History(b+",0",1,false)}}else{if(a==GLOBAL_MYMAP_FUNCTION){activeTabById("mymaptab");document.getElementById("createNewMap").innerHtml=c;document.getElementById("createNewMap").onclick=createNewMap}}}HideSelectPlaceBox()}

function closeContextMenu(){
	if(cMnu!=null){
		map.removeControl(cMnu);
		cMnu=null
		}
	}
var MapLoaded=false;
var welcomeHTML="";
var MymapHelpHTML="";
var FavHelppHTML="";
var dirInputTemplate="";
var inputTextHelp="";
var inputDirHelp="";
function StartApp(){
	if(self!=top){
		top.location.replace(self.location)
		}
		if(MapLoaded){
	return
	}
	MapLoaded=true;
	BrowserDetect();
	changeLang();
	ResizeWindow();	
	ClientID=Math.round(Math.random()*(1000000-1))+1+"";
	welcomeHTML=$("#searchresult_div").html();
	MymapHelpHTML=$("#MyMapList").html();
	FavHelppHTML=$("#MarkLocation_Cookie").html();
	dirInputTemplate=$("#dirInputTemplate").html();
	inputTextHelp=Langs.mapinput;
	inputDirHelp="Nh?p vo d?a danh, d?a ch?...";
	ContextMenu.prototype=new VControl();
	MapToolbar.prototype=new VControl();
	var c=document.getElementById("container");
	map=new VMap(c);
	map.addControl(new VLargeMapControl());
	map.addControl(new VScaleControl());
	map.addControl(new VOverviewMapControl());
	map.addControl(new MapToolbar());
	map.fitOverlays();
	infoWindow=map.getInfoWindow();
	AddListeners();
	InitMapArea();
	TreeBinding.InitTree("Tree","TreeFilter",LoadTree,UnLoadTree);
	loadMyMap();
	ShowFav();
	if(GetSearchType()==0){
		SetSearchType(0)
	}
	var e=window.location.href.split("?");
	var k=new Array();
	var a=new Array();
	if(e.length>1){
		var r=e[1];
		var b=r.split("&");
		for(var f=0;f<b.length;f++){
			var d=b[f].split("=");
			k.push(d[0]);
			a.push(d[1])
		}
	}
	var o=GetStoredLevel();
	var s=GetStoredLatLng();
	var m=null;var p=null;
	var n="";
	var g="";
	var l=0;var j=false;
	for(var f=0;f<k.length;f++){
		switch(k[f]){
		case"l":o=parseInt(a[f]);
			break;
		case"kv":var h=a[f].split(",");
			s=new VLatLng(parseFloat(h[0]),parseFloat(h[1]));
			break;
		case"fp":var q=a[f].split(";");
			var h=q[0].split(",");
			m=new VLatLng(parseFloat(h[0]),parseFloat(h[1]));
			if(h.length>3){
				p=new VLatLng(parseFloat(h[2]),parseFloat(h[3]))
				}
				h=q[1].split(",");
				n=unescape(h[0]);
				g=unescape(h[1]);PathOptions.Alley=parseInt(q[3]);
				PathOptions.Vehicle=parseInt(q[2]);
				if(PathOptions.Alley==1){
					checkAlley()
				}
				else{
					uncheckAlley()
				}
				changeVehicle(PathOptions.Vehicle);
				break;
		case"sk":SearchKey=a[f];
						SearchKey=unescape(SearchKey);
						if(browserName=="msie"||browserName=="firefox"){
							if(/%[a-zA-Z0-9]{2}/g.test(a[f])){
								SearchKey=Utf8.decode(SearchKey).replace(/[+]/g," ")
								}
							else{
								SearchKey=SearchKey.replace(/[+]/g," ")
								}
						}
						else{
							SearchKey=Utf8.decode(SearchKey).replace(/[+]/g," ")
						}
						document.getElementById("mapinput").value=SearchKey;l=1;
						break;
		case"st":current_searchtype=parseInt(a[f]);
						SetSearchType(current_searchtype);
						break;case"bh":viewBlockHouse();
						break;
		case"mi":ChangeFunctionType(GLOBAL_MYMAP_FUNCTION);
						if(checkLogin())
						{
							bSendMyMap=parseInt(a[f]);
							loadMyMap()
						}
						else{
							bSendMyMap=true;
							loadMyMapCoor(parseInt(a[f]))
						}
						j=true;
						break
		}
	}
	$("input","#direction0")[0].value=inputDirHelp;
	$("input","#direction1")[0].value=inputDirHelp;
	if(m!=null){AddPlaceFromFind(m);
	$("input","#direction0")[0].value=n}
	if(p!=null){AddPlaceToFind(p);
		$("input","#direction1")[0].value=g}if(!j){
			map.setCenter(s,o)
		}
	current_searchtype=0;
	if(!sessionExists())
	{
		saveState()
	}
}
								
function AddListeners(){VEvent.addListener(map,"singlerightclick",function(a,e,d){var b=map.fromContainerPixelToLatLng(a);if(b!=null){if(mkD!=null){map.removeOverlay(mkD);mkD=null}closeContextMenu();var f=new Array();if(d!=null&&d.vType!=undefined){if(d.type==MYMAPOBJ||d.type==MMCONTROLOBJ||d.type==MMAPCONTROLOBJ){if(!bReadOnly){if(d.type==MMAPCONTROLOBJ){f[f.length]=new Array("cminsertpoint",(nLanguage==0)?"Thm di?m":"Insert point",function(){closeContextMenu();clearControlPoint();enableSaveBtn();arrMyMapCoorObj[d.editObjectIndex].insertPoint(d.addPointIndex,d.getLatLng().copy());if(arrMyMapCoorObj[d.editObjectIndex].actionType!="New"){arrMyMapCoorObj[d.editObjectIndex].actionType="Edit"}showControlPoint(arrMyMapCoorObj[d.editObjectIndex])})}else{if(d.type==MMCONTROLOBJ){var c=(arrMyMapCoorObj[d.editObjectIndex].vType()=="VPolyline")?2:4;if(arrMyMapCoorObj[d.editObjectIndex].getVertexCount()>c){f[f.length]=new Array("cmdeletepoint",(nLanguage==0)?"Xa di?m":"Delete point",function(){closeContextMenu();clearControlPoint();enableSaveBtn();arrMyMapCoorObj[d.editObjectIndex].deletePoint(d.editPointIndex);if(arrMyMapCoorObj[d.editObjectIndex].actionType!="New"){arrMyMapCoorObj[d.editObjectIndex].actionType="Edit"}showControlPoint(arrMyMapCoorObj[d.editObjectIndex])})}}}}}else{if(d.type==FPMARKEROBJ){f[f.length]=new Array("cmdeletepoint",(nLanguage==0)?"Xa di?m ny":"Delete this point",function(){closeContextMenu();RemovePlace(d.sid)});f[f.length]=new Array("","-",null)}}}f[f.length]=new Array("cmfromhere",(nLanguage==0)?"T? dy":"From here",FromHereClick);f[f.length]=new Array("cmtohere",(nLanguage==0)?"?n dy":"To here",ToHereClick);f[f.length]=new Array("","-",null);f[f.length]=new Array("cmshowstreet",(nLanguage==0)?"Xem u?ng":"Show Streets",function(g){zoomTo(g,17)});f[f.length]=new Array("cmshowcity",(nLanguage==0)?"Xem Thnh ph?":"Show Cities",function(g){zoomTo(g,13)});f[f.length]=new Array("","-",null);f[f.length]=new Array("cmsearchnearby",(nLanguage==0)?"Tm xung quanh":"Search nearby",searchNearBy);f[f.length]=new Array("cmcapturemap",(nLanguage==0)?"Ch?p b?n d?":"Capture map",captureMap);if(d!=null&&d.vType!=undefined&&d.vType()=="VMarker"){cMnu=new ContextMenu(d.getLatLng(),f)}else{cMnu=new ContextMenu(b,f)}map.addControl(cMnu)}});VEvent.addListener(map,"movestart",function(){closeContextMenu();enableSaveBtn();DisplayPopupScroll("hidden")});VEvent.addListener(map,"zoomstart",function(){closeContextMenu();enableSaveBtn()});VEvent.addListener(map,"click",function(e,b){map.IsMoved=false;lastPointClick=map.getCurrentPointer();closeContextMenu();if(bIsPlaceAdding&&b!=null){ShowAddPlacePopup(b);return}if(selTbrButton!=null&&selTbrButton.id!="btnMove"&&b!=null){if(selTbrButton.id=="btnAddPoint"||selTbrButton.id=="btnAddText"){var f=(selTbrButton.id=="btnAddPoint")?"images/MyMap_icon/point-1.gif":"images/icon_text.gif";var a=(nLanguage==0)?"Chua d?t tn":"Noname";createMyMapCoor(nMyMapCoorObj,f,a,"")}if(selTbrButton.id=="btnAddPoint"){selectToolbarBtn(document.getElementById("btnMove"));var d=new VMarker(b,new VIcon("images/mymap_icon/point-1.gif",new VSize(32,32)));d.type=MYMAPOBJ;d.mmIndex=nMyMapCoorObj;d.actionType="New";map.addOverlay(d);arrMyMapCoorObj[nMyMapCoorObj]=d;nMyMapCoorObj++;d.enableDragging();var g=new Object();g.MyMapCoorID="";g.MyMapID="";if(nLanguage==0){g.ObjectTitle="Chua d?t tn"}else{g.ObjectTitle="No name"}g.ObjectDesc="";g.Coor="POINT("+b.lng()+" "+b.lat()+")";g.Style=";;;;point-1.gif;";dsMyMapCoor.Tables[0].Rows[dsMyMapCoor.Tables[0].Rows.length]=g;bCreateNewMMObj=true;showMyMapInfoWindow(d.mmIndex,0)}else{if(selTbrButton.id=="btnAddText"){selectToolbarBtn(document.getElementById("btnMove"));var h=new VText(b,"vietbando");h.type=MYMAPOBJ;h.mmIndex=nMyMapCoorObj;h.actionType="New";map.addOverlay(h);arrMyMapCoorObj[nMyMapCoorObj]=h;nMyMapCoorObj++;h.enableDragging();var g=new Object();g.MyMapCoorID="";g.MyMapID="";if(nLanguage==0){g.ObjectTitle="Chua d?t tn"}else{g.ObjectTitle="No name"}g.ObjectDesc="";g.Coor="POINT("+b.lng()+" "+b.lat()+")";g.Style="normal;#ff0000;20;Arial;;vietbando";dsMyMapCoor.Tables[0].Rows[dsMyMapCoor.Tables[0].Rows.length]=g;bCreateNewMMObj=true;showMyMapInfoWindow(h.mmIndex,0)}else{if(selTbrButton.id=="btnAddPolyline"){map.disableDoubleClickZoom();bDrawingPolyline=true;if(tempPolyline!=null){map.removeOverlay(tempPolyline);tempPolyline=null}if(arrDrawingPts==null){arrDrawingPts=new Array()}arrDrawingPts[nDrawingPts]=b.copy();nDrawingPts++;if(nDrawingPts==2){var c=new VPolyline(arrDrawingPts);c.type=MYMAPOBJ;c.mmIndex=nMyMapCoorObj;c.actionType="New";map.addOverlay(c);arrMyMapCoorObj[nMyMapCoorObj]=c;nMyMapCoorObj++;VEvent.addListener(c,"mouseover",function(){showControlPoint(c)})}else{if(nDrawingPts>2){arrMyMapCoorObj[nMyMapCoorObj-1].setLatLngs(arrDrawingPts)}}}else{if(selTbrButton.id=="btnAddPolygon"){map.disableDoubleClickZoom();bDrawingPolyline=true;if(tempPolyline!=null){map.removeOverlay(tempPolyline);tempPolyline=null}if(arrDrawingPts==null){arrDrawingPts=new Array()}arrDrawingPts[nDrawingPts]=b.copy();nDrawingPts++;if(nDrawingPts==2){var j=new VPolygon(arrDrawingPts);j.type=MYMAPOBJ;j.mmIndex=nMyMapCoorObj;j.reductionTol=0;j.actionType="New";map.addOverlay(j);arrMyMapCoorObj[nMyMapCoorObj]=j;nMyMapCoorObj++;VEvent.addListener(j,"mouseover",function(){showControlPoint(j)})}else{if(nDrawingPts>2){arrMyMapCoorObj[nMyMapCoorObj-1].setLatLngs(arrDrawingPts)}}}}}}return}if(isMeasureDistance&&b!=null){bMeasureLine=true;if(tempPolyline!=null){map.removeOverlay(tempPolyline);tempPolyline=null}if(arrDrawingPtsML==null){arrDrawingPtsML=new Array()}arrDrawingPtsML[nDrawingPtsML]=b.copy();nDrawingPtsML++;if(nDrawingPtsML==2){var c=new VPolyline(arrDrawingPtsML,"green");map.addOverlay(c);arrMLObj[nMLObj]=c;nMLObj++}else{if(nDrawingPtsML>2){arrMLObj[nMLObj-1].setLatLngs(arrDrawingPtsML)}}if(arrDrawingPtsML.length>1){CurrentDistance=CalculateDistance(arrDrawingPtsML[arrDrawingPtsML.length-2],arrDrawingPtsML[arrDrawingPtsML.length-1])}else{CurrentDistance=CalculateDistance(arrDrawingPtsML[arrDrawingPtsML.length-1],b)}if(CurrentDistance>=1000){$("#lblCurDistance").html('<FONT style="color:#FF3300">'+(CurrentDistance/1000)+" km</FONT>")}else{$("#lblCurDistance").html('<FONT style="color:#FF3300">'+CurrentDistance+" m</FONT>")}TotalDistance+=CurrentDistance;if(TotalDistance>=1000){$("#lblTotalDistance").html('<FONT style="color:#FF3300;font-weight:bold">'+(TotalDistance/1000)+" km</FONT>")}else{$("#lblTotalDistance").html('<FONT style="color:#FF3300;font-weight:bold">'+TotalDistance+" m</FONT>")}}else{if(e!=null&&e.vType!=undefined){if(e.vType()=="VMarker"&&e.type==MARKER_POI){if(document.getElementById("resultItem_"+e.order)!=null){document.getElementById("searchresult_div").scrollTop=document.getElementById("resultItem_"+e.order).offsetTop-10}ResultViewDetailCurrentLevel(e.order);return}if(bIsPlaceAdding&&(e.type==ADDPLACEOBJ||e.type==MMCONTROLOBJ||e.type==MMAPCONTROLOBJ)){AP_showInfoWindow();return}if(e.type==BLOCKHOUSEOBJ){showBlockHouseInfoWindow(e.bhIndex)}else{if(e.type==TRAFFICJAMOBJ){showTrafficJamInfoWindow(e.bhIndex)}}if(e.type==MYMAPOBJ||e.type==MMCONTROLOBJ||e.type==MMAPCONTROLOBJ){clickedPoint=b;if(e.mmIndex!=undefined){showMyMapInfoWindow(e.mmIndex,1)}else{showMyMapInfoWindow(e.editObjectIndex,1)}}}}});VEvent.addListener(map,"mousemove",function(b){if(selTbrButton!=null&&selTbrButton.id!="btnMove"){if(b!=null&&bDrawingPolyline){if(tempPolyline==null){var m=new VPolylineOptions(false,false,"Dot");tempPolyline=new VPolyline([arrDrawingPts[arrDrawingPts.length-1],b]);tempPolyline.opts=m;map.addOverlay(tempPolyline)}else{tempPolyline.setLatLngs([arrDrawingPts[arrDrawingPts.length-1],b])}}return}if(b!=null&&bMeasureLine){if(tempPolyline==null){var m=new VPolylineOptions(false,false,"Dot");tempPolyline=new VPolyline([arrDrawingPtsML[arrDrawingPtsML.length-1],b],"green");tempPolyline.opts=m;map.addOverlay(tempPolyline)}else{tempPolyline.setLatLngs([arrDrawingPtsML[arrDrawingPtsML.length-1],b])}if(arrDrawingPtsML.length>1){if(arrDrawingPtsML[arrDrawingPtsML.length-1].lat()==b.lat()){CurrentDistance=CalculateDistance(arrDrawingPtsML[arrDrawingPtsML.length-2],b)}else{CurrentDistance=CalculateDistance(arrDrawingPtsML[arrDrawingPtsML.length-1],b)}}else{CurrentDistance=CalculateDistance(arrDrawingPtsML[arrDrawingPtsML.length-1],b)}window.status=CurrentDistance+"aa";if(CurrentDistance>=1000){document.getElementById("lblCurDistance").innerHTML='<FONT style="color:#FF3300">'+(CurrentDistance/1000)+" km</FONT>"}else{document.getElementById("lblCurDistance").innerHTML='<FONT style="color:#FF3300">'+CurrentDistance+" m</FONT>"}return false}if(mkD!=null&&selectedPoly!=null&&!isFPObjDragging&&!bCPDragging){var j=selectedPoly.split(",");var e=parseInt(j[0]);var f=parseInt(j[1]);var k=PathPolylineArray[e][f].latlngs;var l=new Array();VUtil.ClosestPointPolylines(b.lng(),b.lat(),k,l);var g=l[0];var h=map.fromLatLngToDivPixel(b);var c=map.fromLatLngToDivPixel(g);var o=map.fromLatLngToDivPixel(k[0][0]);var n=k.length;var d=k[n-1].length;var a=map.fromLatLngToDivPixel(k[n-1][d-1]);if(VUtil.Distance(h.x,h.y,c.x,c.y)>300||VUtil.Distance(c.x,c.y,o.x,o.y)<150||VUtil.Distance(c.x,c.y,a.x,a.y)<150){map.removeOverlay(mkD);mkD=null;selectedPoly=null}else{mkD.setPoint(g)}}if(iMyMapCoorOver!=-1&&!bCPDragging&&!isFPObjDragging){var k=arrMyMapCoorObj[iMyMapCoorOver].latlngs;var l=new Array();VUtil.ClosestPointPolyline(b.lng(),b.lat(),k,l);var g=l[0];var h=map.fromLatLngToDivPixel(b);var c=map.fromLatLngToDivPixel(g);if(VUtil.Distance(h.x,h.y,c.x,c.y)>300){clearControlPoint();iMyMapCoorOver=-1}}});VEvent.addListener(map,"dblclick",function(f,b){if(nDrawingPts>1&&bDrawingPolyline&&(selTbrButton.id=="btnAddPolyline"||selTbrButton.id=="btnAddPolygon")){var c=(selTbrButton.id=="btnAddPolyline")?"images/icon_polyline.gif":"images/icon_polygon.gif";var a=(nLanguage==0)?"Chua d?t tn":"Noname";createMyMapCoor((nMyMapCoorObj-1),c,a,"");bDrawingPolyline=false;if(tempPolyline!=null){map.removeOverlay(tempPolyline);tempPolyline=null}if(browserName!="msie"){arrDrawingPts.pop();nDrawingPts--}if(selTbrButton.id=="btnAddPolygon"){arrDrawingPts[nDrawingPts]=arrDrawingPts[0].copy();nDrawingPts++}arrMyMapCoorObj[nMyMapCoorObj-1].setLatLngs(arrDrawingPts);var d=new Object();d.MyMapCoorID="";d.MyMapID="";d.ObjectTitle=a;d.ObjectDesc="";var e=(selTbrButton.id=="btnAddPolyline")?"LINESTRING":"POLYGON";d.Coor=GeoAsText(arrDrawingPts,e);if(selTbrButton.id=="btnAddPolyline"){d.Style="3;#ff0000;#ff0000;0.5;;"}else{if(selTbrButton.id=="btnAddPolygon"){d.Style="3;#ff0000;#00ff00;0.3;0.5;"}}dsMyMapCoor.Tables[0].Rows[dsMyMapCoor.Tables[0].Rows.length]=d;arrDrawingPts=null;nDrawingPts=0;bCreateNewMMObj=true;selectToolbarBtn(document.getElementById("btnMove"));showMyMapInfoWindow(arrMyMapCoorObj[nMyMapCoorObj-1].mmIndex,0)}if(nDrawingPtsML>1&&bMeasureLine){bMeasureLine=false;if(tempPolyline!=null){map.removeOverlay(tempPolyline);tempPolyline=null}if(browserName!="msie"){arrDrawingPtsML.pop();nDrawingPtsML--}if(arrDrawingPtsML.length>1){CurrentDistance=CalculateDistance(arrDrawingPtsML[arrDrawingPtsML.length-2],arrDrawingPtsML[arrDrawingPtsML.length-1])}else{CurrentDistance=CalculateDistance(arrDrawingPtsML[arrDrawingPtsML.length-1],b)}if(CurrentDistance>=1000){document.getElementById("lblCurDistance").innerHTML='<FONT style="color:#FF3300">'+(CurrentDistance/1000)+" km</FONT>"}else{document.getElementById("lblCurDistance").innerHTML='<FONT style="color:#FF3300">'+CurrentDistance+" m</FONT>"}arrDrawingPtsML=null;nDrawingPtsML=0;isMeasureDistance=false;return false}});VEvent.addListener(map,"infowindowclosebuttonclick",function(){if(bIsPlaceAdding){AP_Cancel()}if(iMyMapCoorSel!=-1){changeCoorBkColor(iMyMapCoorSel,false);iMyMapCoorSel=-1}curTitle="";curDesc="";curIcon="";curText="";curFontFamily="";curFontWeight="";curFontSize="";curFontColor="";curLineColor="";curLineWidth="";curLineOpacity="";curFillColor="";curFillOpacity="";bCreateNewMMObj=false});VEvent.addListener(map,"infowindowclose",function(){if(bCreateNewMMObj){map.enableDoubleClickZoom()}if(resultActive!=-1){var a=document.getElementById("resultItem_"+resultActive);if(a!=null){ResultEntryInActive(a)}resultActive=-1}if(nearbymarker!=null){map.removeOverlay(nearbymarker);nearbymarker=null}});VEvent.addListener(map,"zoomend",function(){if(directionLevel!=map.getLevel()){GetDirectionLatLngs()}TreeBinding.ZoomEnd();enableSaveRegion()});VEvent.addListener(map,"moveend",function(){if(lastPointClick!=null){var a=map.getCurrentPointer();if(a.x!=lastPointClick.x&&a.y!=lastPointClick.y){map.IsMoved=true}}if(CurrentCenter!=null&&arrHightLight.length>0){var b=map.fromLatLngToDivPixel(CurrentCenter);var c=map.fromLatLngToDivPixel(map.getCenter());if(Math.sqrt(VUtil.Distance(b.x,b.y,c.x,c.y))>map.getSize().width||Math.sqrt(VUtil.Distance(b.x,b.y,c.x,c.y))>map.getSize().height){CurrentCenter=map.getCenter().copy();TreeBinding.ZoomEnd()}}if(directionLatLng!=null&&PlaceToFindPathArray.length>1){var b=map.fromLatLngToDivPixel(directionLatLng);var c=map.fromLatLngToDivPixel(map.getCenter());if(Math.sqrt(VUtil.Distance(b.x,b.y,c.x,c.y))>map.getSize().width||Math.sqrt(VUtil.Distance(b.x,b.y,c.x,c.y))>map.getSize().height){GetDirectionLatLngs()}}DisplayPopupScroll("auto");enableSaveRegion();if(bWeatherDynChange){}})}var arrMapArea=new Array();function InitMapArea(){var a=new VMappingLayer(0);a.getMappingAreas=function(c,f,g){if(g<10){return}var e="";for(var d=0;d<f.length;d++){var b=f[d].x+","+f[d].y+","+g;if(arrMapArea[b]!=null){a.setMappingAreas([c[d]],[arrMapArea[b]]);c.remove(d);f.remove(d);d--}else{e+=f[d].x+","+f[d].y+";"}}if(e==""){return}AJLocationSearch.GetPoiForTiles(e,g,function(h){BindMapArea(h,c,f,g,a)})};a.addListener("click",function(b){if(!map.IsMoved){ShowLocationInfo(null,b.GUID,"poi",b.latlng)}});map.setMappingLayer(a)}function BindMapArea(e,h,c,d,g){if(e.value!=null){var f=e.value;for(var k=0;k<f.Tables[0].Rows.length;k++){if(f.Tables[0].Rows[k].Coord==null){arrMapArea[c[k].x+","+c[k].y+","+d]="NoMap";continue}var b=new Array();var o=f.Tables[0].Rows[k].Coord.split(";");var l=f.Tables[0].Rows[k].GUID.split(";");for(var n=0;n<o.length;n++){var q=o[n].split(",");var r=q[0]*1;var p=q[1]*1;var m=new Array(r-8,p-8,r+8,p-8,r+8,p+8,r-8,p+8,r-8,p-8);var a=new VPoint(c[k].x*256+r,c[k].y*256+p);a=VProjection.fromPixelToLatLng(a,d);b[n]=new VMappingArea(m.join(","));b[n].GUID=l[n];b[n].latlng=a}g.setMappingAreas([h[k]],[b]);arrMapArea[c[k].x+","+c[k].y+","+d]=b}}}function ResizeWindow(){calculateWindowSize();var b=document.getElementById("container");var c=document.getElementById("leftpanel");var a=document.getElementById("copyright");b.style.width=myWidth-b.offsetLeft-1+"px";b.style.height=myHeight-b.offsetTop-1+"px";$("#leftpanel").css("height",myHeight-b.offsetTop+3+"px");$("#searchresult_div").css("height",myHeight-b.offsetTop-45+"px");$("#findpath_div").css("height",myHeight-b.offsetTop-125+"px");$("#findpathtabdiv").css("height",myHeight-b.offsetTop-13+"px");$("#mymap_div").css("height",myHeight-b.offsetTop-93+"px");$("#MarkLocation").css("height",myHeight-b.offsetTop-67+"px");document.getElementById("centerSplit").style.height=myHeight-b.offsetTop+"px";document.getElementById("moveicon").style.top=b.offsetHeight/2-20+"px";a.style.top=myHeight-25+"px";if(map!=null){map.checkResize()}}function CalculatePopupSize(){var a=document.getElementById("container");if(a==null){return}popupW=myWidth-a.offsetLeft-Global.pHPad;popupH=myHeight-a.offsetTop-Global.pVPad;popupW=(popupW<Global.pMinW)?Global.pMinW:popupW;popupH=(popupH<Global.pMinH)?Global.pMinH:popupH;popupW=(popupW>Global.pMaxW)?Global.pMaxW:popupW;popupH=(popupH>Global.pMaxH)?Global.pMaxH:popupH}var resultActive=-1;

function HightlightActiveItem(a){if(resultActive!=-1){var b=document.getElementById("resultItem_"+resultActive);ResultEntryInActive(b)}if(dsResultData.Tables[0].Rows[a-1].DolGisId!=-1){resultActive=a;var b=document.getElementById("resultItem_"+resultActive);ResultEntryActive(b)}}

function ResultEntryMouseOver(a){}
function ResultEntryMouseOut(a){}
function ResultEntryActive(a){arrSearchMapResult[resultActive-1].active();$(a).addClass("resultItem-active")}
function ResultEntryInActive(a){arrSearchMapResult[resultActive-1].unactive();if(a==null){return}$(a).removeClass("resultItem-active")}
function ResultEntryPlaceABMouseOver(a){$(a).addClass("SPresultItem-active")}
function ResultEntryPlaceABMouseOut(a){$(a).removeClass("SPresultItem-active")}
function captureMap(a){closeContextMenu();var b="l="+(map.getLevel())+"&kv="+a.toUrlValue()+"&m="+a.toUrlValue()+",point-1.gif";window.open("/Maps/ShareMap/Default.aspx?qs="+AJLocationSearch.URLEncoding(b).value);ClickStatisticsInsert("CaptureMap","Chup anh ban do")}

function zoomTo(a,b){closeContextMenu();map.setCenter(a,b)}
function zoomIn(a){closeContextMenu();map.setCenter(a,map.getLevel()+1)}
function zoomOut(a){closeContextMenu();map.setCenter(a,map.getLevel()-1)}isMeasureDistance=false;
function measureDistance(a){closeContextMenu();isMeasureDistance=true;ShowPopUpMyMapDistance()}
function searchNearBy(a){closeContextMenu();ShowSearchNearByLngLat(a)}
function RestoreUserRegion(){map.setCenter(GetStoredLatLng(),GetStoredLevel())}
function SaveUserRegion(){if(bRegionSaved){return}disableSaveRegion();SetUserRegion(map.getCenter().lat(),map.getCenter().lng(),map.getLevel())}
function SetUserRegion(b,c,a){setCookie("UserRegion",b+"%"+c+"%"+a,5000,"","","")}
function GetStoredLatLng(){var b=getCookie("UserRegion");if(b!=null&&b!=""){var a=b.split("%");return new VLatLng(a[0],a[1])}else{return new VLatLng(14.102783,109.649506)}}function GetStoredLevel(){var b=getCookie("UserRegion");if(b!=null&&b!=""){var a=b.split("%");return parseInt(a[2])}else{return 5}}var bRegionSaved=false;
function enableSaveRegion(){if(!bRegionSaved){return}if(isSupportEffect()){$("#ReturnHome").css("opacity","1");$("#ReturnHome").css("filter","alpha(opacity = 100)");$("#SaveView").css("opacity","1");$("#SaveView").css("filter","alpha(opacity = 100)")}bRegionSaved=false}function disableSaveRegion(){if(isSupportEffect()){$("#ReturnHome").css("opacity","0.4");$("#ReturnHome").css("filter","alpha(opacity = 40)");$("#SaveView").css("opacity","0.4");$("#SaveView").css("filter","alpha(opacity = 40)")}bRegionSaved=true}

function DisplayPopupScroll(b){var a=document.getElementById("popup_max");if(a!=null){a.style.overflow=b}var c=document.getElementById("Tree");if(c!=null){c.style.overflow=b}}

function ContextMenu(g,b){this.latlng=g;this.arrCMItem=b;this.initialize=d;this.remove=a;this.copy=f;this.redraw=c;function d(j){var n=document.createElement("div");this.id=j.id+"_ContextMenu";n.id=j.id+"_ContextMenu";n.style.position="absolute";n.style.width="120px";var k=0;var m='<ul class="MapOptions" style="width:120px;">';for(var h=0;h<this.arrCMItem.length;h++){if(this.arrCMItem[h][1]=="-"){m+='<li class="separate"></li>';k+=5}else{var l="";if(h==this.arrCMItem.length-1){l='style="padding-bottom:4px" class="botradius"'}else{if(h==0){l='style="padding-top:4px" class="topradius"'}}m+="<li "+l+' > <a class="'+this.arrCMItem[h][0]+'"><span>'+this.arrCMItem[h][1]+"</span></a> </li>";k+=20}}m+="</ul>";this.width=120;this.height=k+10;n.style.height=this.height+"px";n.innerHTML=m;j.getContainer().appendChild(n);for(var h=0;h<this.arrCMItem.length;h++){e(this.arrCMItem[h],this.latlng)}this.mapObj=j;this.divObj=n;this.redraw();return n}

function e(j,h){if(j[1]!="-"&&j[2]!=null){$(("."+j[0])).click(function(){j[2](h)})}}
function a(){this.divObj.parentNode.removeChild(this.divObj)}
function f(){return new ContextMenu(this.latlng)}
function c(){var h=this.mapObj.fromLatLngToContainerPixel(this.latlng);var k=this.mapObj.getContainer();var j=h.x;var l=h.y;if(j+this.width>=parseInt(k.style.width)){j-=this.width}if(l+this.height>=parseInt(k.style.height)){l-=this.height}this.divObj.style.left=j+"px";this.divObj.style.top=l+"px"}}
function MapToolbar(h){this.regionName=h;this.initialize=b;this.remove=e;this.copy=c;this.hide=d;this.show=j;this.isHidden=g;this.redraw=f;this.vType=a;
function b(k){var n=document.createElement("div");this.id=k.id+"_MapToolbar";n.id=k.id+"_MapToolbar";n.className="MapToolbar";n.style.position="absolute";n.style.textAlign="right";n.style.width="286px";n.style.height="27px";n.style.backgroundColor="transparent";n.innerHTML='<div class="MapTools"> <a id="ViewBlockHouse" class="MTools-raochanDis"></a> <a id="ViewGeo" class="MTools-ranhgioiDis"></a> <a id="MeasureDis" class="MTools-dokhcachDis"></a> </div>';k.getContainer().appendChild(n);n.style.width=n.offsetWidth+"px";this.mapObj=k;this.divObj=n;this.redraw();var o=document.getElementById("ViewGeo");var m=document.getElementById("ViewBlockHouse");var l=document.getElementById("MeasureDis");o.onclick=function(){if(this.className=="MTools-ranhgioiDis"){this.className="MTools-ranhgioiEna"}else{this.className="MTools-ranhgioiDis"}TreeBinding.ViewGeoChange()};m.onclick=TogglePopupTraffic;l.onclick=function(){if(this.className=="MTools-dokhcachDis"){this.className="MTools-dokhcachEna";measureDistance()}else{this.className="MTools-dokhcachDis";ClosePopupDistance()}};return n}
function e(){this.divObj.parentNode.removeChild(this.divObj)}
function c(){return new MapToolbar(this.regionName)}
function d(){this.divObj.style.zIndex=-1}
function j(){this.divObj.style.zIndex=101}
function g(){return(this.divObj.style.display=="")?false:true}
function f(){var k=this.mapObj.getContainer();this.divObj.style.right="5px";this.divObj.style.top="0px"}
function a(){return"MapToolbar"}}var arrSearchMapResult=new Array();var arrMorePlaceResult=new Array();var arrFavPlace=new Array();var current_index=0;var currentSelectedResAB_Id=-1;var currentSelectedResAB_Lat=-1;var currentSelectedResAB_Lng=-1;var currentSelectedResAB_Text="";var plHighlight=null;var KeySearch;var TypeSearch;var selectedResAB_Text="";var prev_selectedResAB_Text="";var isFirstSearch=false;var isBindingMorePlace=false;var searchFromExample=false;var infoWindow;

function doSearch(b){if(b!=null){document.getElementById("mapinput").value=b}var a=RemoveHTMLTag(document.getElementById("mapinput").value.replace(/[']/g,"\\'"));switch(a){case inputTextHelp:inputTextClick();document.getElementById("mapinput").focus();return false;break;case"-vbd:newlogo":$("a","#logo")[0].className="logo-new";return false;break;case"-vbd:oldlogo":$("a","#logo")[0].className="logo-old";return false;break;case"-vbd:newlocation":ShowNewestUserAddPlace();return false;break}isFirstSearch=true;TypeSearch=0;saveState();return false}

function GetSearchType(){return(document.getElementById("searchoptions")!=null)?document.getElementById("searchoptions").value:0}
function SetSearchType(a){if(document.getElementById("searchoptions")==null){return}if(a==null||a==undefined){return}document.getElementById("searchoptions").selectedIndex=a;ControlEvent.OnChangeSearchOption(document.getElementById("searchoptions"))}

function FindPlace(v,x,c,m,e,t,y,j,f){ping_connection();if(isSearching==true){return}var d,B,p,l,k,g;if(f==null){f=TypeSearch}SetSearchType(f);current_searchtype=GetSearchType();f=current_searchtype;ChangeFunctionType(GLOBAL_SEARCH_FUNCTION);showBusyDiv("","searchresult_div");if(x==null){c="";m="";x=document.getElementById("mapinput").value}if(x!=null&&x.length>0){if(e==null||t==null||y==null||j==null){var n=map.getBounds();p=n.getNorthWest().lng();l=n.getNorthWest().lat();k=n.getSouthEast().lng();g=n.getSouthEast().lat();if(l>g){var q=l;l=g;g=q}}else{p=e;l=t;k=y;g=j}var h=map.getLevel();x=x.replace(/\[QUOTE]/g,'"');FillQueryToTextBox(x);if(isFirstSearch){m="$$"+TreeBinding.GetMapPath(", ",false)}searchFromExample=false;var b=SearchWhere.toLowerCase();if(b.indexOf("do?n du?ng ")==0||b.indexOf("doan duong ")==0){var r=100;b=b.substring(11).replace(/^\s+|\s+$/g,"");var a=GetSectionId(b[0]);SearchNearByPolylineExt(a,SearchWhat,"",1,r);return}if(b.indexOf("g?n ")==0||b.indexOf("gan ")==0){b=b.substring(4).replace(/^\s+|\s+$/g,"");var o=b.indexOf(",");var A=b.substring(0,o);var z=b.substring(o+1);var w=2000;if(o>=0){A=b.substring(0,o);z=b.substring(o+1);z=z.replace(/^\s+|\s+$/g,"")}else{A=b;z=""}SearchNearByPointExt(A,z,"","",SearchWhat,"",v,w);return}if(f==1||isPhoneNumber(x)){AJLocationSearch.SearchResult(x,c,m,v,h,p,l,k,g,1,PhoneBinding);return}if(x.indexOf("dt:")==0){x=x.replace("dt:","");var u=x.split(",");if(u[0]==""){return}if(u[1]==null){u[1]=""}AJLocationSearch.SearchUniversityExam(u[0],u[1],v,function(s){PlaceBinding(s);$(".searchinwrap","#TablePlace").remove()});return}AJLocationSearch.SearchResult(x,c,m,v,h,p,l,k,g,f,PlaceBinding);isSearching=true;return}else{hideBusyDiv()}}var connection_timeout=15*60*1000;var last_ping=0;

function ping_connection(){
	var a=new Date();
	if(a-last_ping>connection_timeout){
		last_ping=a;AJLocationSearch.ping_connection("1")
	}
}
function FillQueryToTextBox(a){a=a.replace(" ? g?n "," g?n ");a=a.replace(" o gan "," g?n ");a=a.replace(" ? trn do?n du?ng "," | do?n du?ng ");a=a.replace(" o tren doan duong "," | do?n du?ng ");a=a.replace(" trn do?n du?ng "," | do?n du?ng ");a=a.replace(" tren doan duong "," | do?n du?ng ");a=a.replace(" ? "," | ? ");a=a.replace(", g?n "," g?n ");a=a.replace(" g?n "," | g?n ");a=a.replace(", gan "," gan ");a=a.replace(" gan "," | gan ");var b=a.indexOf("|");if(b!=-1){SearchWhat=Global.TrimSpace(a.substring(0,b));SearchWhere=Global.TrimSpace(a.substring(b+2))}else{if(a.indexOf("$ ")==0){SearchWhere=Global.TrimSpace(a.substring(2));SearchWhat=""}else{SearchWhat=Global.TrimSpace(a);SearchWhere=""}}}var arrLogoPath;var PointArray=new Array();var PAGE_ROWS=10;var PAGE_SHOW=7;var DELTA_FROM_CENTER=3;var dsResultData;

function SearchPage(g,a,f,d,c,e,b){FindPlace(g,a,f,d,c,e,b)}
function ClearSearchMapResult(){unloadAddPlaceFunc();CloseSendMap();for(var a=0;a<arrSearchMapResult.length;a++){map.removeOverlay(arrSearchMapResult[a])}arrSearchMapResult=new Array();resultActive=-1;if(isFirstSearch){isBindingMorePlace=false;for(var a=0;a<arrMorePlaceResult.length;a++){map.removeOverlay(arrMorePlaceResult[a])}arrMorePlaceResult=new Array();isFirstSearch=false}}

function ClearSearchResult(){if(arrMapPath!=null&&arrMapPath.length==0){arrMapPath=new Array();arrMapPath[0]=new Array(0,"Vi?t Nam","VN")}ClearSearchMapResult();isBindingMorePlace=false;KeySearch="";for(var a=0;a<arrMorePlaceResult.length;a++){map.removeOverlay(arrMorePlaceResult[a])}arrMorePlaceResult=new Array();if(plHighlight!=null){map.removeOverlay(plHighlight);plHighlight=null}LoadPlaceTool();Show_Map_Help()}

function ClearPathResult(){document.getElementById("clearPathResultText").style.display="none";document.getElementById("FindPathStatus").innerHTML="";isFinding=false;isChanging=false;for(var a=PlaceToFindPathArray.length-1;a>=0;a--){RemovePlace(a+",0",1)}AJLocationSearch.RemoveDirectionPlaces(-1,-1);for(var a=0;a<arrFinish.length;a++){map.removeOverlay(arrFinish[a])}arrFinish=new Array();firstStart=true;clearArrows()}

function loadMapMoreInfo(d,b){var f=new VMap(document.getElementById("InfoMap"));f.addControl(new VSmallZoomControl());f.setCenter(new VLatLng(d,b),10);var a=new VIcon("images/mymap_icon/point_7.gif");a.iconSize=new VSize(32,32);var c=new VMarkerOptions(a);var e=new VMarker(new VLatLng(d,b),c);f.addOverlay(e)}

function InfoWindowWithSearchNearBy(w,l,a){var u=w.Name;var g=w.Address;var c=w.ShortComment;var B=w.Logo;var z=w.Website;var p=w.VietbandoID;var v=w.Picture;var e=w.Tel;var f=w.Table;var q=w.RootID;var m=w.StoreID;var D=w.URLFriendly;var E=w.GUID;var s=(f!="ds_store")?"ip":"ds";var h=w.Latitude;var o=w.Longitude;var k="From here",n="To here",t="Search nearby",d="Detail...",C="Search inside",j="Full view",A="Mark this location",r="Add content";if(nLanguage==0){k="T? dy";n="?n dy";d="Xem chi ti?t...";t="Tm xung quanh";C="Tm bn trong";j="Xem d?ng l?n";A="nh d?u di?m ny";r="Thm n?i dung"}var y=new Array();y[y.length]='<div class="MiniPopup">';y[y.length]='<span class="Title">'+u+"</span>";y[y.length]='<div class="CommonFunction" style="padding-left:0px">';var G="Find business near by this point",b="Eg: Hotel",F="Radius(m)",x="Find";if(nLanguage==0){G="Tm d?ch v? ? g?n v? tr ny";b="VD: Khch s?n";F="Bn knh(m)";x="Tm"}y[y.length]='<span class="subTit"><b>'+G+'</b></span> <ol class="SearchNearBy"> <li><span class="ServiceTit">'+b+'</span><span class="RadiusTit">'+F+'</span></li> <li> <input id="searchnearbypoint" class="ServiceInput" onkeydown="return SearchNearByPointEnter(event,\''+u+"','"+g+"','"+o+"','"+h+'\', null,null)" type="text"/> <input id="searchnearbypoint_radius" class="RadiusInput" value="2000" onkeydown="return SearchNearByPointEnter(event,\''+u+"','"+g+"','"+o+"','"+h+'\', null,null)" type="text"/> <a class="backbtn" onclick="SearchNearByPointExt(\''+u+"','"+g+"','"+o+"','"+h+"', null,'', 1,null)\"><span>"+x+'</span></a> </li> </ol> <a class="backbtn backbtn2" id="pback'+l+'"><span class="flnk"> Quay l?i</span></a>';y[y.length]="</div>";return y.join("")}var centerObjectNearbyTemp;var centerObjectNearby;

function ViewDetailCurrentLevelWithSearchNearBy(b,d,a){if(d==null){return}var e;centerObjectNearbyTemp=b;var f=new VLatLng(b.Latitude,b.Longitude);if(b.Address!=b.Name&&b.Address!=""){e=b.Name+", "+b.Address}else{e=b.Name}var c=InfoWindowWithSearchNearBy(b,d,e);OpenInfowindow(c,d,a,f);setTimeout(function(){if(document.getElementById("searchnearbypoint")!=null){document.getElementById("searchnearbypoint").focus()}},500);document.getElementById("pback"+d).onclick=function(){switch(a){case"more":ShowLocationInfo(arrMorePlaceResult[d-1],arrMorePlaceResult[d-1].GUID,a);break;case"fav":ShowLocationInfo(arrFavPlace[d],arrFavPlace[d].GUID,a);break;case"poi":ShowLocationInfo(null,b.GUID,"poi",f);break;case"search":case null:ViewDetailCurrentLevel(b,d,a);break}}}

function ResultViewDetailCurrentLevel(a){ViewDetailCurrentLevel(dsResultData.Tables[0].Rows[a-1],a,"search")}
function ViewDetailCurrentLevel(f,d,a){var c=f.Name;var g=f.Address;var e=c;if(g!=c&&g!=""){e=c+", "+g}var b=BuildMiniPopupWindow(f,d-1,e,false);OpenInfowindow(b,d,a,new VLatLng(f.Latitude,f.Longitude));AtachEventMiniPopup(f,d,e,a);AddLogClick(f,2)}

function OpenInfowindow(b,c,a,d){switch(a){case"more":arrMorePlaceResult[c-1].openInfoWindow(b);break;case"fav":arrFavPlace[c].openInfoWindow(b);break;case"poi":map.openInfoWindow(d,b);break;case"search":case null:arrSearchMapResult[c-1].openInfoWindow(b);HightlightActiveItem(c);break}}
function ResultViewOnMap(a){map.zoomToLevel(17);ResultViewDetailCurrentLevel(a)}
function ViewOnMap(c,b,a){
	map.zoomToLevel(17);
	ViewDetailCurrentLevel(c,b,a)
}
var nearbymarker=null;

function ShowSearchNearByLngLat(g){
	var f=g.toUrlValue();
	var h=f.indexOf(",");
	var a=f.substring(0,h);
	var b=f.substring(h+1);
	var c='<div class="MiniPopup">';
	if(nLanguage==0){
		c+='<span class="Title">Tm d?ch v? ? g?n v? tr ny</span> <ol class="SearchNearBy"> <li><span class="ServiceTit">Vd: khch s?n</span><span class="RadiusTit">Bn knh (m)</span></li> <li> <input id="searchnearbypoint" class="ServiceInput" onkeydown="return SearchNearByPointEnter(event,\''+f+"','','"+b+"','"+a+'\', null,null)" type="text"/> <input id="searchnearbypoint_radius" class="RadiusInput" value="2000" onkeydown="return SearchNearByPointEnter(event,\''+f+"','','"+b+"','"+a+'\', null,null)" type="text"/> <a class="backbtn" onclick="SearchNearByPointExt(\''+f+"','','"+b+"','"+a+"',null,'',1,null)\"><span>Tm</span></a> </li> </ol>"
	}else{
		c+='<span class="Title">Find business near by this point</span> <ol class="SearchNearBy"> <li><span class="ServiceTit">Eg: Hotel</span><span class="RadiusTit">Radius (m)</span></li> <li> <input id="searchnearbypoint" class="ServiceInput" onkeydown="return SearchNearByPointEnter(event,\''+f+"','','"+b+"','"+a+'\', null,null)" type="text"/> <input id="searchnearbypoint_radius" class="RadiusInput" value="2000" onkeydown="return SearchNearByPointEnter(event,\''+f+"','','"+b+"','"+a+'\', null,null)" type="text"/> <a class="backbtn" onclick="SearchNearByPointExt(\''+f+"','','"+b+"','"+a+"',null,'',1,null)\"><span>Search</span></a> </li> </ol>"
	}
	c+="</div>";
	map.closeInfoWindow();
	var e=new VIcon("images/mymap_icon/point-1.gif",new VSize(32,32));
	var d=new VMarkerOptions(e,function(){return 1});
	nearbymarker=new VMarker(g,d);
	map.addOverlay(nearbymarker);
	nearbymarker.openInfoWindow(c);
	setTimeout(function(){if(document.getElementById("searchnearbypoint")!=null){document.getElementById("searchnearbypoint").focus()}},500)
}
function ResultFromHere(a,b){FromHere(dsResultData.Tables[0].Rows[a-1],b)}
function ResultToHere(a,b){ToHere(dsResultData.Tables[0].Rows[a-1],b)}
function ResultSearchNearBy(a){ViewDetailCurrentLevelWithSearchNearBy(dsResultData.Tables[0].Rows[a-1],a,"search")}
function FromHere(a,b){b=RemoveHTMLTag(b);AddPlaceFromFind(new VLatLng(a.Latitude,a.Longitude),b);AddLogClick(a,0)}
function ToHere(a,b){b=RemoveHTMLTag(b);AddPlaceToFind(new VLatLng(a.Latitude,a.Longitude),b);AddLogClick(a,1)}
function Show_Map_Help(){$("#topLeftSearchResult").css("display","none");$("#searchresult_div").html(welcomeHTML)}
function MapExampleClick(c){var a=RemoveHTMLTag(document.getElementById(c).innerHTML);a=a.replace("amp;","").replace("&gt;",">");var b=c.split(",");SetSearchType(b[1]);if(b[2]=="undefined"||b[2]==null){document.getElementById("mapinput").value=a;searchFromExample=true;UnLoadHelp();doSearch()}else{SearchPlace(b[2],a,1)}}

function AddLogClick(a,b){}
function LoadPlaceTool(){$("#topLeftSearchResult").css("display","")}var KeySearch;var PAGE_ROWS=10;var PAGE_SHOW=7;var DELTA_FROM_CENTER=3;var RelativeDir="";var pTitleLength=50;var popupW=595;var popupH=250;var CurGuid="";var ContentLocation={ActiveTab:function(a,b,c){if(document.getElementById("tab"+a)==null){return}if(document.getElementById("tab"+a).className!="current"){if(document.getElementById(a+"content").innerHTML==""){switch(a){case"overview":ContentLocation.GetOverview(c);break;case"detail":ContentLocation.GetDetail(b);break;case"review":ContentLocation.GetReview(c);break;case"photo":ContentLocation.GetPhoto(c);break;case"video":ContentLocation.GetVideo(c);break}}}else{ContentLocation.Loading=false;return}document.getElementById("taboverview").className="none";document.getElementById("tabdetail").className="none";document.getElementById("tabreview").className="none";document.getElementById("tabphoto").className="none";document.getElementById("tabvideo").className="none";document.getElementById("overviewcontent").className="pcHide";document.getElementById("detailcontent").className="pcHide";document.getElementById("reviewcontent").className="pcHide";document.getElementById("photocontent").className="pcHide";document.getElementById("videocontent").className="pcHide";document.getElementById(a+"content").className="pc";document.getElementById("tab"+a).className="current"},GetReview:function(k,d){if(k==null||k==""||k=="undefined"||k=="null"){return}if(d==null){d="useful"}dtReview=AJLocationSearch.GetReview(k,d).value;var b=new RegExp("\n","g");var e=new Date();var g=e.getDate();var c=e.getMonth()+1;var l=e.getFullYear();var n='<div id="review" class="review" style="width:100%;">';var m=false;if(dtReview!=null){dtReview=dtReview.Tables[0]}if(dtReview!=null&&dtReview.Rows.length>0){if(dtReview.Rows[0].rou==1&&dtReview.Rows[0].UserName!=""&&dtReview.Rows[0].Content!=null){n+='<div id="wrLink">Nh?n xt c?a b?n';n+=' <div class="row"> <p style="left:40px">'+dtReview.Rows[0].Content.replace(b,"<br/>")+'</p> <p><a href="javascript:ContentLocation.EditReview()">Ch?nh s?a</a> - <a href="javascript:ContentLocation.DeleteReview(\''+k+"')\">Xa</a></p>";if(dtReview.Rows[0].Checked){n+='<span style="color:#336600">Nh?n xt c?a b?n d du?c duy?t</span>'}else{n+='<span style="color:red">Nh?n xt c?a b?n dang ch? ki?m duy?t n?i dung, chng ti s? nhanh chng ph?n h?i trong th?i gian ng?n nh?t</span>'}n+="</div></div>";m=true}}if(!m){n+='<p id="wrLink"><a href="javascript:ContentLocation.ShowReviewForm();">Vi?t nh?n xt c?a b?n</a></p>'}n+='<div id="ReviewForm" class="jForm" style="display:none"> <fieldset> <legend>G?i nh?n xt</legend> <div> <label for="rvTitle">Tiu d?:</label> <input id="rvTitle" name="txtTitle" type="text" style="width:400px" /> </div> <div> <label for="rating">nh gi:</label> <ul id="rating" class="rating"> <li id="r1" class="starunrated" onmouseover="Rating.displayAsRate(1)" onclick="Rating.setRate(1)" onmouseout="Rating.displayRated()"/> <li id="r2" class="starunrated" onmouseover="Rating.displayAsRate(2)" onclick="Rating.setRate(2)" onmouseout="Rating.displayRated()"/> <li id="r3" class="starunrated" onmouseover="Rating.displayAsRate(3)" onclick="Rating.setRate(3)" onmouseout="Rating.displayRated()"/> <li id="r4" class="starunrated" onmouseover="Rating.displayAsRate(4)" onclick="Rating.setRate(4)" onmouseout="Rating.displayRated()"/> <li id="r5" class="starunrated" onmouseover="Rating.displayAsRate(5)" onclick="Rating.setRate(5)" onmouseout="Rating.displayRated()"/> </ul> <span id="RateExplain" class="gray">(Chua dnh gi)</span> </div> <p style="padding-top:10px"><textarea rows="10" cols="100" id="rvContent" name="rvContent"></textarea></p> </fieldset> <div class="submit"> <span id="rverror" style="float:left;color:red"></span> <input type="button" value="G?i nh?n xt" onclick="ContentLocation.SendReview(\''+k+'\')"/> <input name="Reset" type="reset" onclick="ContentLocation.HideReviewForm()" value="H?y" /> </div> </div>';if(dtReview!=null&&((!m&&dtReview.Rows.length>0)||(m&&dtReview.Rows.length>1))){n+='<p style="text-align:right;">S?p x?p theo: ';if(d=="useful"){n+="<strong>Nh?n xt hay</strong>"}else{n+="<a href=\"javascript:ContentLocation.GetReview('"+k+"','useful');\">Nh?n xt hay</a>"}n+="&nbsp;&nbsp;|&nbsp;&nbsp;";if(d=="date"){n+="<strong>Ngy</strong>"}else{n+="<a href=\"javascript:ContentLocation.GetReview('"+k+"','date');\">Ngy</a>"}n+="&nbsp;&nbsp;|&nbsp;&nbsp;";if(d=="rate"){n+="<strong>nh gi</strong>"}else{n+="<a href=\"javascript:ContentLocation.GetReview('"+k+"','rate');\">nh gi</a>"}for(var j=0;j<dtReview.Rows.length;j++){if(dtReview.Rows[j].rou==1){continue}if(dtReview.Rows[j].DateAdded!=null){var a=dtReview.Rows[j].DateAdded.split(" ");var f=a[1].split("/");if(f[0]==g&&f[1]==c&&f[2]==l){a[0]="Today"}if(f[0]==g-1&&f[1]==c&&f[2]==l){a[0]="Yesterday"}dtReview.Rows[j].DateAdded=a.join(" ");dtReview.Rows[j].DateAdded=dtReview.Rows[j].DateAdded.replace("Today","Hm nay");dtReview.Rows[j].DateAdded=dtReview.Rows[j].DateAdded.replace("Yesterday","Hm qua");dtReview.Rows[j].DateAdded=dtReview.Rows[j].DateAdded.replace("Monday","Th? hai");dtReview.Rows[j].DateAdded=dtReview.Rows[j].DateAdded.replace("Tuesday","Th? ba");dtReview.Rows[j].DateAdded=dtReview.Rows[j].DateAdded.replace("Wednesday","Th? tu");dtReview.Rows[j].DateAdded=dtReview.Rows[j].DateAdded.replace("Thursday","Th? nam");dtReview.Rows[j].DateAdded=dtReview.Rows[j].DateAdded.replace("Friday","Th? su");dtReview.Rows[j].DateAdded=dtReview.Rows[j].DateAdded.replace("Saturday","Th? b?y");dtReview.Rows[j].DateAdded=dtReview.Rows[j].DateAdded.replace("Sunday","Ch? nh?t")}n+=' <div class="row"> <img class="avatar" src="'+RelativeDir+'images/mymap_icon/media_4.gif"/> <span class="author">'+dtReview.Rows[j].UserName+'</span> - <span class="date">'+dtReview.Rows[j].DateAdded+"</span> - ";for(var h=1;h<=dtReview.Rows[j].Rating;h++){n+='<img src="'+RelativeDir+'images/start_yellow.gif"/>'}for(var h=dtReview.Rows[j].Rating+1;h<=5;h++){n+='<img src="'+RelativeDir+'images/start_gray.gif"/>'}n+="<p>"+dtReview.Rows[j].Content.replace(b,"<br/>")+"</p> </div>"}n+="</div>"}SafeSetInnerHtml("reviewcontent",n)},EditReview:function(){if(dtReview.Rows[0].Checked){if(confirm("Nh?n xt c?a b?n d du?c duy?t, ch?nh s?a n?i dung c?a nh?n xt ny s? d?n t?i vi?c b?n ph?i ch? d? du?c ki?m duy?t n?i dung l?i, b?n d d?ng  ch?nh s?a khng ?")==false){return}}ContentLocation.ShowReviewForm();document.getElementById("rvTitle").value=dtReview.Rows[0].Title;document.getElementById("rvContent").value=dtReview.Rows[0].Content;Rating.setRate(dtReview.Rows[0].Rating)},ShowReviewForm:function(){var a=AJLocationSearch.BeginWriteAReview().value;if(a){document.getElementById("ReviewForm").style.display="";document.getElementById("wrLink").style.display="none"}else{window.location="Login.aspx"}},HideReviewForm:function(){document.getElementById("ReviewForm").style.display="none";document.getElementById("wrLink").style.display="";Rating.setUnRated()},SendReview:function(a){var e=document.getElementById("rvTitle").value;var d=Rating.RatePoint;var c=document.getElementById("rvContent").value;var f=document.getElementById("rverror");if(a==null||a==""){f.innerHTML="Xin l?i, b?n khng th? g?i nh?n xt cho v? tr ny";return}if(d==0||c==""){f.innerHTML="Vui lng dnh gi v vi?t nh?n xt c?a b?n tru?c khi g?i";return}if(c.length<30){f.innerHTML="Xin l?i, nh?n xt c?a b?n ph?i nhi?u hon 30 k t?";return}var b=AJLocationSearch.SendReview(e,d,c,a).value;if(b){ContentLocation.GetReview(a)}else{f.innerHTML="Nh?n xt c?a b?n khng th? g?i du?c, hy th? Refresh l?i trang"}},DeleteReview:function(a){var b="B?n th?c s? mu?n xa nh?n xt ny ?";if(dtReview.Rows[0].Checked){b="Nh?n xt c?a b?n d du?c duy?t, B?n c ch?c mu?n xa nh?n xt ny ?"}if(confirm(b)==true){AJLocationSearch.DeleteReview(a);ContentLocation.GetReview(a)}},LoadMiniMap:function(e,c){var b=document.getElementById("InfoMap");if(b==null){return}var g=new VMap(b);g.addControl(new VSmallZoomControl());g.setCenter(new VLatLng(e,c),10);var a=new VIcon(RelativeDir+"images/mymap_icon/point_7.gif");a.iconSize=new VSize(32,32);var d=new VMarkerOptions(a);var f=new VMarker(new VLatLng(e,c),d);g.addOverlay(f)}};
function ShowAJLoad(b){var b=document.getElementById(b);if(b!=null){var c=b.style.width;var a=b.style.height;b.className="ajLoading";b.style.width=c;b.style.height=a;b.innerHTML=""}}

function HideAJLoad(b,a){if(document.getElementById(b)!=null){if(a!=null){document.getElementById(b).className=a}else{document.getElementById(b).className=""}}}Rating={RatePoint:0,setUnRated:function(){Rating.RatePoint=0;Rating.displayRated()},displayAsRate:function(c){for(var a=1;a<=c;a++){var b=document.getElementById("r"+a);b.className="starrated"}for(var a=c+1;a<=5;a++){var b=document.getElementById("r"+a);b.className="starunrated"}Rating.displayExplain(c)},setRate:function(a){Rating.displayAsRate(a);Rating.RatePoint=a},displayRated:function(){Rating.displayAsRate(Rating.RatePoint)},displayExplain:function(b){var a=document.getElementById("RateExplain");switch(b){case 0:a.innerHTML="(Chua dnh gi)";break;case 1:a.innerHTML="(Chua t?t)";break;case 2:a.innerHTML="(Bnh thu?ng)";break;case 3:a.innerHTML="(T?t)";break;case 4:a.innerHTML="(R?t t?t)";break;case 5:a.innerHTML="(Tuy?t v?i)";break}}};

function PlaceBinding(j){isSearching=false;hideBusyDiv();dsResultData=j.value;var a=new Array();if((null!=dsResultData)&&("object"==typeof(dsResultData))){var p=dsResultData.Tables[0].Rows.length;var r=dsResultData.Tables[1].Rows[0].HitSize;var g=dsResultData.Tables[1].Rows[0].Key;var b=dsResultData.Tables[1].Rows[0].What;var l=dsResultData.Tables[1].Rows[0].Where;g=g.replace(/\[QUOTE]/g,'"');var e=g.indexOf("|");var v=g,w="";if(e>=0){v=Global.TrimSpace(g.substring(0,e));w=Global.TrimSpace(g.substring(e+1))}if(w!=""){if(v!=""){FillQueryToTextBox(v+" | "+w)}else{FillQueryToTextBox("$ "+w)}}else{FillQueryToTextBox(v)}var u=parseInt((r+PAGE_ROWS-1)/PAGE_ROWS);var k=10;u=(u>k)?k:u;var h=u>PAGE_SHOW?PAGE_SHOW:u;var m=dsResultData.Tables[1].Rows[0].PageIdx;var c=dsResultData.Tables[1].Rows[0].Lx;var o=dsResultData.Tables[1].Rows[0].Ly;var t=dsResultData.Tables[1].Rows[0].Rx;var s=dsResultData.Tables[1].Rows[0].Ry;searchType=dsResultData.Tables[1].Rows[0].SearchType;var f=dsResultData.Tables[1].Rows[0].SuggestedKey;var d=(m-1)*PAGE_ROWS+1;var n=d+PAGE_ROWS-1>r?r:d+PAGE_ROWS-1;if(false&&arrMapPath!=null&&arrMapPath.length>0){var q='<div class="dtree" style="padding: 0px 10px 10px;"><div class="dTreeNode"> <img id="itree0" alt="" src="Treeview/dtree/img/base.gif"/> <div id="map_path_div" style="display:inline;white-space:normal;">';q+=TreeBinding.GetMapPath(" > ",true,true);q+="</div></div>";a[a.length]=q}a[a.length]='<div id="TablePlace">';a[a.length]=Global.GetResultText(g,"<b>"+v+"</b>",w,f,r,dsResultData.Tables[1].Rows[0].IsLonLat,dsResultData.Tables[1].Rows[0].IsAddress,d,n);KeySearch=g;if(m+1<=u&&isFirstSearch){setTimeout(function(){isBindingMorePlace=true;AJLocationSearch.FindMorePlace(g,b,l,1,map.getLevel(),c,o,t,s,searchType,MorePlaceBinding)},1000)}ClearSearchMapResult();if(plHighlight!=null){map.removeOverlay(plHighlight);plHighlight=null}HideSelectPlaceBox();isFirstSearch=false;a[a.length]=BindResult(dsResultData.Tables[0]);a[a.length]="</div>";a[a.length]=Global.GetComplainLink(g);a[a.length]=Global.BuildPaging(m,u,r,h,Global.PagingFindPlace,new Array(RemoveHTMLTag(g),b,l,c,o,t,s,searchType))}else{a[a.length]="</div>";a[a.length]=Global.GetNotFoundText("<b>"+RemoveHTMLTag(document.getElementById("mapinput").value)+"</b>","","","");a[a.length]=Global.GetComplainLink(KeySearch)}LoadPlaceTool();document.getElementById("searchresult_div").innerHTML=a.join("");document.getElementById("searchresult_div").scrollTop=0;map.fitMultiOverlays(arrSearchMapResult)}

function PhoneBinding(h){isSearching=false;hideBusyDiv();dsResultData=h.value;ClearSearchMapResult();if(plHighlight!=null){map.removeOverlay(plHighlight);plHighlight=null}HideSelectPlaceBox();var g=new Array();g[g.length]='<div id="TablePlace">';if(dsResultData!=null&&typeof(dsResultData)=="object"){var b=dsResultData.Tables[1].Rows[0].HitSize;KeySearch=dsResultData.Tables[1].Rows[0].Key;var d=dsResultData.Tables[0].Rows.length;var l=parseInt((b+PAGE_ROWS-1)/PAGE_ROWS);var c=dsResultData.Tables[1].Rows[0].PageIdx;var f=l>PAGE_SHOW?PAGE_SHOW:l;var j=1;var a=10;l=(l>a)?a:l;var e=(c-1)*PAGE_ROWS+1;var k=(c-1)*PAGE_ROWS+dsResultData.Tables[0].Rows.length;if(b>0){g[g.length]=Global.GetFoundText("<b>"+KeySearch+"</b>","s? di?n tho?i","phone number",e,k,b)}else{g[g.length]='<tr><td height=20px align=left valign=middle style="font-size:11px;">'+Global.GetNotFoundText("<b>"+KeySearch+"</b>","s? di?n tho?i","phone number","")+"</td></tr>"}g[g.length]=BindResult(dsResultData.Tables[0]);g[g.length]="</div>";g[g.length]=Global.GetComplainLink(KeySearch);g[g.length]=Global.BuildPaging(c,l,b,f,Global.PagingFindPlace)}else{g[g.length]="</div>";g[g.length]=Global.GetNotFoundText("<b>"+KeySearch+"</b>","s? di?n tho?i","phone number","");g[g.length]=Global.GetComplainLink(KeySearch)}LoadPlaceTool();document.getElementById("searchresult_div").innerHTML=g.join("");document.getElementById("searchresult_div").style.scrollTop=0;map.fitMultiOverlays(arrSearchMapResult)}

function createSMarker(a,g,e,d){if(a==0){d++;var c=new VMarkerOptions(new VIcon("",new VSize(33,33)));c.zIndexProcess=function(){return(resultActive==d)?3:2};c.customMarker=e;c.offset=new VSize(14,33);var b=new VMarker(g,c);b.order=d;b.type=MARKER_POI;map.addOverlay(b);arrSearchMapResult.push(b);VEvent.addListener(b,"mouseover",function(){});VEvent.addListener(b,"mouseout",function(){})}else{var f=new VMarkerOptions(e);f.zIndexProcess=function(){return 1};var b=new VMarker(g,f);b.GUID=d;b.order=numMoreData+1;b.type=MARKER_MPOI;map.addOverlay(b);arrMorePlaceResult.push(b);numMoreData++;VEvent.addListener(b,"click",function(){ShowLocationInfo(b,b.GUID,"more")})}}

function ShowLocationInfo(b,c,a,d){
	if(resultActive!=-1){
		ResultEntryInActive(document.getElementById("resultItem_"+resultActive))
	}
	if(b!=null){
		b.openInfoWindow("ang t?i...")
	}else{
		map.openInfoWindow(d,"ang t?i...")
	}
	AJLocationSearch.GetInfo(c,function(e){BindLocationInfo(e,b,a,d)})
}
	
function BindLocationInfo(c,b,f,h){var e=c.value;if(e!=null&&typeof(e)=="object"&&e.Tables[0].Rows[0]!=null){var d=e.Tables[0].Rows[0];var g=GetLocationFullName(d);h=(b!=null)?b.getLatLng():h;d.Latitude=h.lat();d.Longitude=h.lng();var a=(b!=null)?b.order:0;if(b!=null){b.openInfoWindow(BuildMiniPopupWindow(d,a-1,g,false))}else{map.openInfoWindow(h,BuildMiniPopupWindow(d,a-1,g,false))}AtachEventMiniPopup(d,a,g,f)}else{if(b!=null){b.openInfoWindow("Khng tm th?y thng tin")}else{map.openInfoWindow(h,"Khng tm th?y thng tin")}}}

function BindResult(d){var b="";for(var a=0;a<d.Rows.length;a++){if(d.Rows[a].DolGisId=="-1"){latlng=new VLatLng(d.Rows[a].Latitude,d.Rows[a].Longitude);icon=new VIcon("images/mymap_icon/point-1.gif");icon.iconSize=new VSize(32,32);var c=new VMarkerOptions(icon,function(){return 1});marker=new VMarker(latlng,c);marker.order=a+1;marker.type=MARKER_POI;map.addOverlay(marker);arrSearchMapResult.push(marker);if(centerObjectNearby!=null){d.Rows[a]=centerObjectNearby;centerObjectNearby=null}continue}CombineAddress(d.Rows[a]);if(d.Rows[a].Website!=null&&d.Rows[a].Website!=""&&d.Rows[a].Website.indexOf("http://")!=0){d.Rows[a].Website="http://"+d.Rows[a].Website}b+=BuildLocationItem(d.Rows[a],a+1)}return b}

function BuildLocationItem(a,j){var f='<div id="resultItem_%Number%" class="resultItem" onmouseout="ResultEntryMouseOut(this)" onmouseover="ResultEntryMouseOver(this)"> %Icon%%Title% <div class="Spacer"></div> <p>%Description%</p> <ul class="resultOptions"> <li>%FromHere%</li> <li>%ToHere%</li> <li>%ViewOnMap%</li> <li>%SearchNearby%</li> <li>%Detail%</li> </ul> </div>';var x=ToSafeHTML(a.Name);var B=GetShortText(RemoveHTMLTag(a.Comment),160);var q=a.ShortComment;var k=ToSafeHTML(a.Address);if(x==""){x=a.Name=k;k=a.Address=""}var v=a.Picture;var b=a.Tel;var h=a.Logo;var y=a.Latitude;var l=a.Longitude;var z=a.StoreID;var g=a.Table;var o=a.VietbandoID;var r=a.Property;var A=a.GUID;var e="";if(g=="ds_store"){e="red"}var d="";if(g!="ds_store"){switch(g){case"ips_hochiminh":d+='<img class="resultImg" src="LocationInfo/HoChiMinh/'+A+'/1.jpg" onerror="this.parentNode.removeChild(this)" />';break;case"ips_hanoi":d+='<img class="resultImg" src="LocationInfo/HaNoi/'+A+'/1.jpg" onerror="this.parentNode.removeChild(this)"/>';break;default:}}else{if(v!=""&&v!=null&&v!="UPLOADFOLDER/icon.bmp"){if(v.indexOf("../")==0){v=v.substring(v.indexOf("../"))}d+='<img class="resultImg" src="'+v+'" onerror="this.parentNode.removeChild(this)"/>'}}d+='<span class="address">'+k+"</span>";if(b!=""&&b!=null){d+=' <span class="phone">'+b+"</span>"}if(q=="Placement on map is approximate"){B=a.ShortComment=(nLanguage==0)?"V? tr trn b?n d? ch? l di?m g?n dng":q;e="appr"}if(B!=""&&B!=null){d+='<span class="comment"><span>'+B+"</span></span>"}var p='<a class="icon1-10 '+e+'">'+((dsResultData.Tables[1].Rows[0].PageIdx-1)*10+j)+'<span class="icon1-10Hover"></span></a>';createSMarker(0,new VLatLng(y,l),p,j-1);f=f.replace(/%Number%/g,j);f=f.replace(/%Icon%/g,p);f=f.replace(/%Order%/g,j);f=f.replace(/%Title%/g,'<a class="resultTitle" onclick="ResultViewDetailCurrentLevel('+j+')">'+x+"</a>");f=f.replace(/%Description%/g,d);var m="";if(o!=""&&o!=null){m="font-weight:bold"}var u=x+((k!=x&&k!="")?(", "+k):"");var t='<a onclick="ResultFromHere('+j+",'"+u+"')\">"+Langs.fromhere+"</a>";var c='<a onclick="ResultToHere('+j+",'"+u+"')\">"+Langs.tohere+"</a>";var n='<a class="flnk" onclick="ResultViewOnMap('+j+')">'+Langs.viewonmap+"</a>";var s='<a class="flnk" onclick="ResultSearchNearBy('+j+')">'+Langs.searchnearby+"</a>";var w="";if(o!=""&&o!=null){w='<a target="_blank" style="'+m+'" href="/'+o+'">'+Langs.detail+"</a>"}f=f.replace(/%FromHere%/g,t);f=f.replace(/%ToHere%/g,c);f=f.replace(/%ViewOnMap%/g,n);f=f.replace(/%SearchNearby%/g,s);f=f.replace(/%Detail%/g,w);return f}var dsMoreData;var numMoreData=0;

function MorePlaceBinding(j){dsMoreData=j.value;if(dsMoreData!=null&&typeof(dsMoreData)=="object"&&isBindingMorePlace){var f=RemoveHTMLTag(dsMoreData.Tables[1].Rows[0].Key);var k=dsMoreData.Tables[1].Rows[0].SearchType;if(f!=RemoveHTMLTag(KeySearch)||k!=TypeSearch){return}var b=dsMoreData.Tables[1].Rows[0].HitSize;var l=parseInt((b+PAGE_ROWS-1)/PAGE_ROWS);var d=dsMoreData.Tables[1].Rows[0].PageIdx;var h=l>PAGE_SHOW?PAGE_SHOW:l;if(d==1){numMoreData=0}var a=10;l=(l>a)?a:l;if(b>0){for(var e=0;e<dsMoreData.Tables[0].Rows.length&&e<11;e++){var c=dsMoreData.Tables[0].Rows[e].GUID;if(c==null||c==""){continue}var g=new VIcon("./images/cmark.gif");g.iconSize=new VSize(10,10);createSMarker(1,new VLatLng(dsMoreData.Tables[0].Rows[e].Latitude,dsMoreData.Tables[0].Rows[e].Longitude),g,c)}if(d+1<=l){setTimeout(function(){CallNextMore(f,d,dsMoreData.Tables[1].Rows[0],TypeSearch)},1000)}}}}

function CallNextMore(q,l,e,t){switch(t){case 0:var b=e.What;var m=e.Where;var k,h,g,d;var f=map.getBounds();var k=f.getNorthWest().lng();var h=f.getNorthWest().lat();var g=f.getSouthEast().lng();var d=f.getSouthEast().lat();if(h>d){var j=h;h=d;d=j}AJLocationSearch.FindMorePlace(q,b,m,l+1,map.getLevel(),k,h,g,d,0,MorePlaceBinding);break;case 1:break;case 6:var b=e.What;var o=e.SelName;var n=e.SelAddress;var c=e.SelLng+"";var p=e.SelLat+"";var r=e.Radius;AJLocationSearch.FindMoreNearByPoint(q,b,o,n,c,p,r,l+1,MorePlaceBinding);break;case 7:var a=PathSectionID;var q=e.Key;var b=e.What;var m=e.Where;var s=e.Radius;AJLocationSearch.FindMoreNearByPolyline(ClientID,GetPolylineOrder(a),PlaceToFindPathArray[a].length,q,b,m,l+1,s,MorePlaceBinding);break}}

function BuildMiniPopupWindow(q,h,a,o){var v=q.Name;var e=q.Address;var b=GetShortText(RemoveHTMLTag(q.Comment),320);var t=q.Logo;var s=q.Website;var l=q.VietbandoID;var p=q.Picture;var c=q.Tel;var d=q.Table;var m=q.RootID;var j=q.StoreID;var u=q.URLFriendly;var k=q.GUID;var n=(d!="ds_store")?"ip":"ds";var r=new Array();r[r.length]='<div class="MiniPopup">';r[r.length]='<span class="Title">'+v;if(k!=""&&k!=null){if(arrListFavour!=null){var f=false;for(var g=0;g<arrListFavour.length;g++){if(arrListFavour[g][1]==k){f=true;break}}if(f){r[r.length]='<a id="pmarklocation" class="favToogle-Dis favToogle-Ena"></a>'}else{r[r.length]='<a id="pmarklocation" class="favToogle-Dis"></a>'}}else{r[r.length]='<a id="pmarklocation" class="favToogle-Dis"></a>'}}r[r.length]='</span><br/><p class="Content">';if(p!=""&&p!=null&&p!="UPLOADFOLDER/icon.bmp"){if(p.indexOf("../")==0){p=p.substring(p.indexOf("../"))}r[r.length]='<span class="popupImg"><img src="'+p+'"/></span>'}if(e!=""&&e!=null){r[r.length]='<span class="address">'+e+"</span>"}if(c!=""&&c!=null){r[r.length]='<span class="phone">'+c+"</span>"}if(l!=""&&l!=null){r[r.length]='<a class="vietbandoid" target="_blank" href="/'+l+'">'+l+"</a>"}if(s!=""&&s!=null){r[r.length]='<a class="website" target="_blank" href="'+s+'">Website</a>'}r[r.length]='<span class="comment">'+b+"</span>";if(k!=""&&k!=null&&n=="ip"){r[r.length]='<a class="flnk" id="createcontent'+h+'" onclick=\'window.open("DS_Manager/ManageStore.aspx?guid='+k+"&type="+n+"\")'>"+Langs.editinfo+"</a>"}r[r.length]="</p>";r[r.length]='<ul class="CommonFunction">';r[r.length]='<li><a class="flnk" id="pfromhere">'+Langs.fromhere+"</a></li>";r[r.length]='<li><a class="flnk" id="ptohere">'+Langs.tohere+"</a><li>";r[r.length]='<li><a class="flnk" id="pviewonmap">'+Langs.viewonmap+"</a><li>";r[r.length]='<li><a class="flnk" id="pviewsearchnearby">'+Langs.searchnearby+"</a></li>";r[r.length]="</ul>";r[r.length]="</div>";return r.join("")}

function AtachEventMiniPopup(d,c,a,b){$("#pfromhere").click(function(){FromHere(d,a)});$("#ptohere").click(function(){ToHere(d,a)});$("#pviewonmap").click(function(){ViewOnMap(d,c,b)});$("#pviewsearchnearby").click(function(){ViewDetailCurrentLevelWithSearchNearBy(d,c,b)});$("#pmarklocation").click(function(){if($(this).hasClass("favToogle-Ena")){DeleteFavByGuid(d.GUID)}else{AddFav(d);MMSubTabChange(FAVOURITE_TAB)}})}
function ShowNewestUserAddPlace(){jQuery.facebox("some html<br/>")}var tree=null;var PreviousSelectNode;var arrMapPath=new Array();arrMapPath[0]=new Array(0,"Vi?t Nam","VN");var bViewGeo=false;TreeBinding={TreeElement:null,MapPathElement:null,ShowTreeFunc:null,HideTreeFunc:null,InitTree:function(b,c,a,d){TreeBinding.TreeElement=document.getElementById(b);TreeBinding.MapPathElement=document.getElementById(c);TreeBinding.ShowTreeFunc=a;TreeBinding.HideTreeFunc=d;TreeBinding.BindTree()},GetMapPath:function(f,d,e){var c="";if(d&&arrMapPath!=null&&arrMapPath.length>0){c='<div id="map_path_div" style="display:inline;white-space:normal;">';for(var b=0;b<arrMapPath.length;b++){var a=f;if(b==0){a=""}if(!e&&b==arrMapPath.length-1){c+=a+"<span>"+arrMapPath[b][1]+"</span>"}else{c+=a+'<a onclick="TreeBinding.TreeClick(event,'+arrMapPath[b][0]+",'"+arrMapPath[b][1]+"','"+arrMapPath[b][2]+"')\">"+arrMapPath[b][1]+"</a>"}}c+="</div>"}else{if(arrMapPath!=null&&isFirstSearch&&NeedFilter&&!searchFromExample){for(var b=1;b<arrMapPath.length;b++){if(arrMapPath[b][2]!="L"){c=f+arrMapPath[b][1]+c}}}}return c},GetNavigatorPath:function(f,d,e){var c="";if(d&&arrMapPath!=null&&arrMapPath.length>0){c='<div id="map_path_div" style="display:inline;white-space:normal;">';for(var b=0;b<arrMapPath.length;b++){var a=f;if(b==0){a=""}c+=a+'<a onclick="TreeBinding.NavigatorClick(event,'+arrMapPath[b][0]+",'"+arrMapPath[b][1]+"','"+arrMapPath[b][2]+"')\">"+arrMapPath[b][1]+"</a>"}c+="</div>"}else{if(arrMapPath!=null&&isFirstSearch&&NeedFilter&&!searchFromExample){for(var b=1;b<arrMapPath.length;b++){c=f+arrMapPath[b][1]+c}}}return c},ShowMapList:function(b,c,d,a){if(!TreeBinding.TreeShowed){TreeBinding.ShowTreeFunc();TreeBinding.TreeShowed=true}if(c=="D"||c=="P"||c=="VN"){TreeBinding.BindTree(b,false,c)}TreeBinding.ShowOnMap(b,c,d,a);TreeBinding.TreeElement.innerHTML='<div style="float:right"><a class="TreeClose" onclick="TreeBinding.HideMapList()">X</a></div><div style="padding:0px 10px 10px 10px">'+tree+"</div>"},HideMapList:function(){if(TreeBinding.TreeShowed){TreeBinding.HideTreeFunc();TreeBinding.TreeShowed=false}},ToogleListMap:function(b,c,d,a){if(TreeBinding.TreeShowed){TreeBinding.HideMapList()}else{TreeBinding.ShowMapList(b,c,d,a)}},AdjustNavigator:function(c,b,d){for(var a=0;a<arrMapPath.length;a++){if(arrMapPath[a][2]==d){arrMapPath.length=a;break}}arrMapPath[arrMapPath.length]=new Array(c,b,d)},TreeClick:function(e,d,c,b,f,a){TreeBinding.AdjustNavigator(d,c,b);if(b=="D"||b=="P"||b=="VN"){TreeBinding.BindTree(d,false,b)}else{TreeBinding.BindTree(d,false,"W");TreeBinding.HideMapList()}TreeBinding.ReloadTree();TreeBinding.ShowOnMap(d,b,f,a);TreeBinding.ReSearch()},NavigatorClick:function(e,d,c,b,f,a){TreeBinding.AdjustNavigator(d,c,b);if(tree!=null&&tree.Nodes.length>0&&tree.Nodes[0].id==d){TreeBinding.HideMapList()}if(b=="D"||b=="P"||b=="VN"){TreeBinding.BindTree(d,false,b)}TreeBinding.ReloadTree();TreeBinding.ShowOnMap(d,b,f,a);TreeBinding.ReSearch()},LoadTreeTo:function(a){if(a!=null){TreeBinding.TreeElement=document.getElementById(a)}TreeBinding.TreeElement.innerHTML='<div style="float:right"><a class="TreeClose" onclick="TreeBinding.HideMapList()">X</a></div><div style="padding:0px 10px 10px 10px">'+tree+"</div>";TreeBinding.TreeElement.scrollTop=0;$(".dTreeNode").mouseover(function(){$(this).addClass("dTreeNode-active")});$(".dTreeNode").mouseout(function(){$(this).removeClass("dTreeNode-active")})},ReloadTree:function(){if(TreeBinding.TreeElement==null){return}TreeBinding.TreeElement.innerHTML='<div style="float:right"><a class="TreeClose" onclick="TreeBinding.HideMapList()">X</a></div><div style="padding:0px 10px 10px 10px">'+tree+"</div>";TreeBinding.TreeElement.scrollTop=0;$(".dTreeNode").mouseover(function(){$(this).addClass("dTreeNode-active")});$(".dTreeNode").mouseout(function(){$(this).removeClass("dTreeNode-active")})},ResetTree:function(){TreeBinding.HideMapList();cID=0;cType="VN";cLatLng=CurrentCenter=null;removeArea();TreeBinding.AdjustNavigator(0,"Vi?t Nam","VN");TreeBinding.BindTree(0,false,"VN");TreeBinding.ReSearch()},ReSearch:function(){if(KeySearch!=""){doSearch()}},BindTree:function(e,b,c){TreeBinding.MapPathElement.innerHTML=TreeBinding.GetNavigatorPath(" > ",true,true);if(c=="VN"||c==null){$(".SWCloseArea").hide()}else{$(".SWCloseArea").show()}if(tree!=null&&tree.Nodes.length>0&&tree.Nodes[0].id==e){return}if(c=="W"){e=arrMapPath[arrMapPath.length-2][0]}var a=new dTree("tree");a.config.inOrder=true;a.config.useStatusText=true;a.icon.root="Resources/Contours/VietNam.png";var d=TreeBinding.GetMapPath(" > ",true,true);a.add(e,-1,d);TreeBinding.AddChilds(a,e);if(b){removeArea();removePosition()}if(a.ChildsCount(e)>0){tree=a}else{arrMapPath.length=arrMapPath.length-1}},AddChilds:function(h,f){var a=AJLocationSearch.GetChild(f).value;if(a==null||a.Rows.length==0){return}for(var g=0;g<a.Rows.length;g++){var c=a.Rows[g].Longitude;var b=a.Rows[g].Latitude;var e=a.Rows[g].NAME;var d=a.Rows[g].UniqueName;var j=a.Rows[g].TYPE;var k=a.Rows[g].ID;h.add(k,f,'<a style="background: url(Resources/Contours/'+d+'.png) no-repeat;" onclick="TreeBinding.TreeClick(event,'+k+",'"+e+"','"+j+"',"+b+","+c+')">'+e+"</a>","",e,"","","Resources/Contours/"+d+".png",h.icon.folderOpen,false)}},ShowOnMap:function(c,f,b,a){if(f=="VN"||f=="NT"){cID=0;cType=f;cLatLng=null;CurrentCenter=cLatLng;removeArea();if(arrSearchMapResult==null||arrSearchMapResult.length==0){map.setCenter(new VLatLng(14.102783,109.649506),5)}return}cID=c;cType=f;cLatLng=new VLatLng(b,a);CurrentCenter=new VLatLng(b,a);if(f=="W"||f=="D"||f=="P"||f=="L"||f=="DC"||f=="UI"){removeArea();var k=AJLocationSearch.GetFitLevel(c,f,map.getSize().width,map.getSize().height).value;if(k!=null){var e=k[0];b=k[1];a=k[2];var h=k[3];var d=k[4];var j=k[5];var g=k[6];if(arrSearchMapResult==null||arrSearchMapResult.length==0){map.setCenter(new VLatLng(b,a),e+5)}if(bViewGeo){AJLocationSearch.GetAHGeometry(c,e,f,h,d,j,g,DrawGeometry)}}}},ZoomEnd:function(){removeArea();if(cLatLng!=null&&bViewGeo){var b=map.getLevel();var a=map.getDirectionBounds();AJLocationSearch.GetAHGeometry(cID,b,cType,a.getNorthWest().lng(),a.getNorthWest().lat(),a.getSouthEast().lng(),a.getSouthEast().lat(),DrawGeometry)}},bViewGeo:false,ViewGeoChange:function(){bViewGeo=!bViewGeo;if(bViewGeo){if(arrMapPath[arrMapPath.length-1][2]=="VN"){LoadTree()}TreeBinding.ShowOnMap(cID,cType)}else{removeArea()}}};var isRegionSelected=false;var pre=-1;var cur=-1;var cLatLng,cID,cType;var arrHightLight=new Array();

function DrawGeometry(d){removeArea();var e=d.value;if(e==""){isRegionSelected=false;return}if(e==null){isRegionSelected=false;return}isRegionSelected=true;arrHightLight=new Array();var c=0.3;for(var a=0;a<e.length;a++){if(e[a]!=null&&e[a]!=""){var b=new VPolygon(e[a],"red",3,"#84C221",c,c);map.addOverlay(b);arrHightLight.push(b)}}}

function removeArea(){if(arrHightLight!=null){for(var a=0;a<arrHightLight.length;a++){map.removeOverlay(arrHightLight[a])}arrHightLight=new Array()}}
function removePosition(){if(arrSearchMapResult!=null){if(arrSearchMapResult.length==1){map.removeOverlay(arrSearchMapResult[0])}}arrSearchMapResult=new Array()}var NeedFilter=true;

function FilterChange(a){NeedFilter=a}var ControlEvent={OnChangeSearchOption:function(a){}};var Global={NormalSearchStatus:'Tm d?a ch?, d?ch v?, s?n ph?m v s? di?n tho?i. <a href="Help/index.html" style="cursor: pointer;">Xem thm</a>',ProductSearchStatus:'Vd: <a id="cafe,1" onclick="MapExampleClick(this.id)" style="cursor: pointer;">Cafe</a>, <a id="qa,1" onclick="MapExampleClick(this.id)" style="cursor: pointer;">Qu?n o tr? em</a>, <a id="ga,1" onclick="MapExampleClick(this.id)" style="cursor: pointer;">Com g</a>, <a id="ht,1" onclick="MapExampleClick(this.id)" style="cursor: pointer;">H? ti?u</a>, <a id="pi,1" onclick="MapExampleClick(this.id)" style="cursor: pointer;">Pizza</a>, v.v...',NormalSearchStatusE:'Find addresses, businesses, products and phones. <a href="Help/index.html" style="cursor: pointer;">Learn more</a>',ProductSearchStatusE:'Ex: <a id="cafe,1" onclick="MapExampleClick(this.id)" style="cursor: pointer;">Cafe</a>, <a id="qa,1" onclick="MapExampleClick(this.id)" style="cursor: pointer;">Qu?n o tr? em</a>, <a id="ga,1" onclick="MapExampleClick(this.id)" style="cursor: pointer;">Com g</a>, <a id="ht,1" onclick="MapExampleClick(this.id)" style="cursor: pointer;">H? ti?u</a>, <a id="pi,1" onclick="MapExampleClick(this.id)" style="cursor: pointer;">Pizza</a>, v.v...',LoginUrl:"/Accounts/Login.aspx",GetDataUpdating:function(b,a){return"<p>D? li?u dang c?p nh?t.</p>"},DataUpdating:'<p>D? li?u dang c?p nh?t.</p><p>N?u b?n mu?n c?p nh?t thng tin cho v? tr ny, b?n c th? lin h? v?i chng ti b?ng nh?ng hnh th?c sau:</p> <ul> <li>Thng qua trang gp : <a href="vbdfeedback.aspx">B?m vo dy</a></li><br/> <li>H? tr? tr?c tuy?n: <a href="ymsgr:sendIM?hotro_vietbando" class="nav2"><img border="0" src="http://opi.yahoo.com/online?u=hotro_vietbando&m=g&t=1"/></a></li> </ul>',GetResultText:function(j,g,c,k,b,m,f,a,l,e){var h="";var d="T?a d?:";if(nLanguage==1){d="Coordinate:"}if(b>0){if(m){h='<span class="countPlace">'+d+'</span> <span class="keyPlace">'+j.replace("|","")+"</span>"}else{if(f){h=Global.GetFoundText("<b>"+j+"</b>","d?a ch?","address",a,l,b)}else{if(c!=""&&g!=""){h=Global.GetFoundText("<b>"+g+"</b> ? <b>"+c+"</b>","","",a,l,b)}else{if(c!=""&&g==""){h=Global.GetFoundText(c,"","",a,l,b)}else{h=Global.GetFoundText(g,"","",a,l,b)}}}}}else{if(m){h=Global.GetNotFoundText(j,"t?a d?","coordinate",k,e)}else{if(f){h=Global.GetNotFoundText("<b>"+j+"</b>","d?a ch?","address",k,e)}else{if(g!=""&&c!=""){h=Global.GetNotFoundText("<b>"+g+"</b> ? <b>"+c+"</b>","","",k,e)}if(g==""){h=Global.GetNotFoundText(c,"","",k,e)}if(c==""){h=Global.GetNotFoundText(g,"","",k,e)}}}}return h},GetNotFoundText:function(e,d,c,a,b){if(nLanguage==0){return'<div class="kotimthay"> Khng tm th?y '+d+' <p class="searchKey">'+e.replace(/[|]/g,"")+"</p>"+((a!="")?'<p class="goiy">C ph?i b?n mu?n tm: <a id="dym,0,'+b+'" onclick="MapExampleClick(this.id)">'+a+"</a> <span>?</span></p>":"")+" <p>? xu?t:</p> <ul class=\"dexuat\"> <li>Xin b?n ch?c ch?n d vi?t dng chnh t?.</li> <li>Hy ch?c b?n d ch?n dng vng c?n tm. Th? t? kha c?a b?n ? ton <a onclick=\"TreeBinding.TreeClick(event,0,'Vi?t Nam','VN')\">Vi?t Nam</a></li> <li>N?u b?n vi?t t?t, hy th? khng vi?t t?t.</li> <li>Hy th? dng cc t? kha khc c nghia tuong t?.</li> </ul> </div>"}else{return'<div class="kotimthay"> We couldn\'t found '+c+' <p class="searchKey">'+e.replace(/[|]/g,"").replace(/? g?n/g,"near").replace(/?/g,"in").replace("trong ph?m vi","within")+"</p>"+((a!="")?'<p class="goiy">Did you mean: <a id="dym,0,'+b+'" onclick="MapExampleClick(this.id)">'+a+"</a> <span>?</span></p>":"")+" <p>Suggestion:</p> <ul class=\"dexuat\"> <li>Make sure all keywords are spelled correctly.</li> <li>Make sure that you chose the correct region. <br/>try your keyword at <a onclick=\"TreeBinding.TreeClick(event,0,'Vi?t Nam','VN')\">Vi?t Nam</a></li> <li>Please do not use abbreviation.</li> <li>Please try another search with synonym keywords.</li> </ul> </div>"}},GetFoundText:function(g,b,j,a,k,d){if(b==null){b=""}if(j==null){j=""}var f="cho "+b;var c="K?t qu? t?";var h="K?t qu? tm ki?m";var e="trong s?";g=g.replace(/^\s+|\s+$/g,"");if(nLanguage==1){c="Results from";h="Results";e="of about";f="for "+j;g=g.replace(/? g?n/g,"near").replace(/?/g,"in").replace("trong ph?m vi","within")}if(d>1){return'<span class="countPlace">'+c+" <b>"+a+"-"+k+"</b> "+e+" <b>"+d+"</b> "+f+'</span> <span class="keyPlace"> '+g.replace("|","")+' <span class="searchinwrap"><a><span onclick="LoadTree()">Tm ?</span></a></span> </span>'}else{return'<span class="countPlace">'+h+" "+f+'</span> <span class="keyPlace"> '+g.replace("|","")+' <span class="searchinwrap"><a><span onclick="LoadTree()">Tm ?</span></a></span> </span>'}},GetComplainLink:function(a){if(nLanguage==0){return'<div class="kohailong"> <div id="fblnk"><p>B?n khng hi lng v? k?t qu? tm ki?m?</p> <ul> <li><a onclick="Global.ShowFeedBackForm()">G?i  ki?n c?a b?n.</a></li> <li><a onclick="loadAddPlaceFunc()">Thm v? tr c?a b?n vo b?n d?.</a></li> </ul></div> <div id="fbForm" class="jForm" style="display:none"> <p>G?i ph bnh</p> <span class="typevnmese" id="fberror">*B?n vui lng g ti?ng Vi?t c d?u</span> <div> <label for="fbName">H? tn:</label> <input id="fbName" name="fbName" type="text" style="width:220px" /> </div> <div> <label for="fbEmail">Email:</label> <input id="fbEmail" name="fbEmail" type="text" style="width:220px" /> </div> <span> ki?n c?a b?n</span> <textarea rows="6" cols="40" id="fbContent" name="fbContent"></textarea> <a class="submit_wrap" onclick="Global.SendFeedBack(\''+a+'\')"><span class="submit">G?i ph bnh</span></a> <a class="cancel_wrap" onclick="Global.HideFeedBackForm()"><span class="cancel">H?y</span></a> </div> </div>'}else{return'<div class="kohailong"> <div id="fblnk"><p>Can\'t find what you are looking for?</p> <ul> <li><a onclick="Global.ShowFeedBackForm()">Send your feedback.</a></li> <li><a onclick="loadAddPlaceFunc()">Add your place to the map.</a></li> </ul></div> <div id="fbForm" class="jForm" style="display:none"> <p>Feedback</p> <span class="typevnmese" id="fberror">*Please enter valid email</span> <div> <label for="fbName">Name:</label> <input id="fbName" name="fbName" type="text" style="width:220px" /> </div> <div> <label for="fbEmail">Email:</label> <input id="fbEmail" name="fbEmail" type="text" style="width:220px" /> </div> <span>Your opinion:</span> <textarea rows="6" cols="40" id="fbContent" name="fbContent"></textarea> <span class="typevnmese" id="fberror"></span> <input class="submit" type="button" onclick="Global.SendFeedBack(\''+a+'\')" value="Send"/> <input class="cancel" type="button" onclick="Global.HideFeedBackForm()" value="Cancel"/> </div> </div>'}},ShowFeedBackForm:function(){document.getElementById("fbForm").style.display="";document.getElementById("fblnk").style.display="none"},HideFeedBackForm:function(){document.getElementById("fbForm").style.display="none";document.getElementById("fblnk").style.display="";document.getElementById("fbName").value="";document.getElementById("fbEmail").value="";document.getElementById("fberror").innerHTML=""},SendFeedBack:function(h){var g="Vui lng di?n d?y d? thng tin";var j="Email c?a b?n khng chnh xc";var k=" ki?n c?a b?n ph?i trn 30 k t?";var b="<b>C?m on b?n,  ki?n c?a b?n d du?c g?i t?i ban qu?n tr?</b>";if(nLanguage==1){g="Please enter required information.";j="Your is email is invalid";k="Your opinion must be more than 30 characters";b="<b>Thank you, your feedback has sent successfully</b>"}var a=document.getElementById("fbName").value;var d=document.getElementById("fbEmail").value;var l=document.getElementById("fbContent").value;var m=document.getElementById("fberror");var e=document.getElementById("fblnk");if(a.length==0||d.length==0||l.length==0){m.innerHTML=g;return}if(!Global.CheckEmail(d)){m.innerHTML=j;return}if(l.length<30){m.innerHTML=k;return}var c="T? kha tm: "+RemoveHTMLTag(h)+"<br/> ki?n: "+l+"<br/>Trnh duy?t: "+Browser.Name+" "+Browser.FullVersion;var f=AJLocationSearch.SendFeedBack(a,d,c).value;if(f){Global.HideFeedBackForm();document.getElementById("fblnk").innerHTML=b}},CheckEmail:function(a){var b=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;if(!b.test(a)){return false}else{return true}},pHPad:30,pVPad:120,pMinW:595,pMinH:250,pMaxW:595,pMaxH:5000,TreeRatio:0.33,LockRequest:false,BuildPaging:function(d,n,b,k,j,f){var g="";if(n>1||b>PAGE_ROWS){var m=" First",l="Last ",e="Previous",c="Next";if(nLanguage==0){m=" ?u";l="Cu?i ";e="Tru?c";c="Sau"}g+='<ul class="resultPage">';if(d>1){g+='<li><a onclick="'+j(1,f)+'">'+m+"</a></li>"}else{g+="<li><span>"+m+"</span></li>"}var o=Math.max(d-DELTA_FROM_CENTER,1);var h=Math.min(d+DELTA_FROM_CENTER,n);if(o==1){h=Math.min(o+2*DELTA_FROM_CENTER,n)}else{if(h==n){o=Math.max(h-2*DELTA_FROM_CENTER,1)}}for(var a=o;a<=h;a++){if(a==d){g+='<li><span class="active_page">'+a+"</span></li>"}else{g+='<li><a onclick="'+j(a,f)+'">'+a+"</a></li>"}}if(d<n){g+='<li><a onclick="'+j(n,f)+'">'+l+"</a></li>"}else{g+="<li><span>"+l+"</span></li>"}g+="</ul>"}return g},PagingFindPlace:function(b,a){if(a!=null&&a.length>0){return BuildFunction("FindPlace",a,b,0)}else{return"FindPlace("+b+")"}},PagingSearchPlaceForPath:function(b,a){return BuildFunction("SearchPlace",a,b,2)},PagingSearchNearByPolylineExt:function(b,a){return BuildFunction("SearchNearByPolylineExt",a,b,3)},PagingSearchNearByPointExt:function(b,a){return BuildFunction("SearchNearByPointExt",a,b,6)},PagingFindProcductInsideStore:function(b,a){return"ContentLocation.SearchInsideStore("+b+")"},PagingProductMatch:function(b,a){return"ContentLocation.GetDetailPage("+a[0]+","+b+")"},SearchProduct:function(b,a){return"ContentLocation.GetProductInsideStore("+b+")"},TrimSpace:function(a){if(a==null){return""}a=a.replace(/\s+/g," ");a=a.replace(/^\s+|\s+$/g,"");return a},RemoveSpace:function(a){if(a==null){return""}a=a.replace(/\s/g,"");return a}};function BuildFunction(a,e,f,d){var c=a+"(";for(var b=0;b<e.length;b++){if(d!=null&&b==d){c+=f+","}if(typeof(e[b])=="string"){c+="'"+e[b].replace(/'/g,"\\'").replace(/"/g,"&quot;")+"',"}else{c+=e[b]+","}}return c.substr(0,c.length-1)+")"}

function SafeSetInnerHtml(c,b){var a=document.getElementById(c);if(a!=null){a.innerHTML=b}}
function SafeAppendInnerHtml(c,b){var a=document.getElementById(c);if(a!=null){a.innerHTML+=b}}
function installSearchEngine(){if(window.external&&("AddSearchProvider" in window.external)){var a=window.location.href;a=a.substring(0,a.lastIndexOf("/")+1);window.external.AddSearchProvider(a+"vietbando.xml")}else{if(window.sidebar&&("addSearchEngine" in window.sidebar)){}else{alert("No search engine support")}}}

function getIFrameDocument(){var a=document.getElementById("historyFrame");var b=a.contentDocument;if(b==undefined){b=a.contentWindow.document}return b}
function sessionExists(){var b=getIFrameDocument();try{if(b.body.innerHTML==""){return false}else{return true}}catch(a){return true}}
function saveState(){var c=Global.TrimSpace(RemoveHTMLTag(document.getElementById("mapinput").value.replace(/[']/g,"\\'")));if(isPhoneNumber(c)){c=Global.RemoveSpace(c)}var b=document.getElementById("iframestate");var d=b.firstChild;while(d&&d.nodeType!=8){d=d.nextSibling}var e=d.nodeValue;e=e.replace(/\%SearchType\%/g,GetSearchType());e=e.replace(/\%SearchKey\%/g,c);var a=e;var f=getIFrameDocument();f.open();f.write(a);f.close()}

function loadState(b,c){var a=top.document.getElementById("mapinput");if(b==""||b==inputTextHelp){top.document.title="Vietbando";top.document.getElementById("mapinput").value=b;top.ClearSearchResult()}else{top.document.title=b+" - Vietbando";top.isFirstSearch=true;top.TypeSearch=c;top.SetSearchType(c);top.document.getElementById("mapinput").value=unescape(b);top.FindPlace(1)}}var MessageBox={Show:function(f,h,d,c,a,g,e){if(getCookie("No"+f)=="1"){return}MessageBox.Hide(f);var b=$("#PopupTempl").clone();b[0].id=f;b.css("z-index",1000);$("#messcontent",b).html(h);$(".close",b)[0].onclick=function(){MessageBox.Close(f)};if(d!=-1){b.css("left",d)}if(c!=-1){b.css("top",c)}if(a!=-1){b.css("right",a)}if(g!=-1){b.css("bottom",g)}$(".messagebox-leftbot",b)[0].className="messagebox-"+e;$(document.body).append(b);b.show()},Hide:function(a){$("#"+a).remove()},Close:function(a){if($("#chkNoMess","#"+a).is(":checked")){setCookie("No"+a,"1",1)}MessageBox.Hide(a)}};var Utf8={encode:function(d){d=d.replace(/\r\n/g,"\n");var b="";for(var a=0;a<d.length;a++){var e=d.charCodeAt(a);if(e<128){b+=String.fromCharCode(e)}else{if((e>127)&&(e<2048)){b+=String.fromCharCode((e>>6)|192);b+=String.fromCharCode((e&63)|128)}else{b+=String.fromCharCode((e>>12)|224);b+=String.fromCharCode(((e>>6)&63)|128);b+=String.fromCharCode((e&63)|128)}}}return b},decode:function(b){var d="";var a=0;var e=c1=c2=0;while(a<b.length){e=b.charCodeAt(a);if(e<128){d+=String.fromCharCode(e);a++}else{if((e>191)&&(e<224)){c2=b.charCodeAt(a+1);d+=String.fromCharCode(((e&31)<<6)|(c2&63));a+=2}else{c2=b.charCodeAt(a+1);c3=b.charCodeAt(a+2);d+=String.fromCharCode(((e&15)<<12)|((c2&63)<<6)|(c3&63));a+=3}}}return d}};function includeJavascript(a){var b=document.getElementsByTagName("head").item(0);var c=document.createElement("script");c.setAttribute("language","javascript");c.setAttribute("type","text/javascript");c.setAttribute("src",a);b.appendChild(c);return false}

function GetShortText(b,a){if(b==null||b==""){return""}if(b.length<a){return b}var c=b.substring(a).indexOf(" ");if(c<0){return b}return b.substring(0,a+c)+"..."}
function CombineAddress(a){if(a.Address!=null){return a.Address}a.Address=ConcatAddress(a.Number,a.Street,a.Ward,a.District,a.Province);return Address}
function ConcatAddress(c,b,e,d,f){var a="";a+=(c!="")?c+" ":"";a+=(b!="")?b+", ":"";a+=(e!="")?e+", ":"";a+=(d!="")?d+", ":"";a+=f;return a}var randomLocation;
function RandomLocationHTML(){if(randomLocation==null){randomLocation=AJLocationSearch.GetRandomLocation().value}var c="";if((null!=randomLocation)&&("object"==typeof(randomLocation))){for(var a=0;a<randomLocation.Tables[0].Rows.length;a++){var b=randomLocation.Tables[0].Rows[a].Name;c+='<a title="'+b+'" onclick="ShowLocation(\''+randomLocation.Tables[0].Rows[a].GUID+"')\">"+((b.length>42)?(b.substring(0,42)+"..."):b)+"</a><br/>"}if(c!=""){c='<div class="Acor"><span class="Title">V? tr ng?u nhin</span> <div class="Content">'+c+"</div></div>"}}return c}

function setImageDelay(b,c){var a=document.getElementById(b);if(a==null){setTimeout(function(){setImageDelay(b,c)},200);return}a.src=c}
function setCookie(b,d,a,g,f,h){var c=new Date();c.setTime(c.getTime());if(a){a=a*1000*60*60*24}var e=new Date(c.getTime()+(a));document.cookie=b+"="+escape(d)+((a)?";expires="+e.toGMTString():"")+((g)?";path="+g:"")+((f)?";domain="+f:"")+((h)?";secure":"")}

function getCookie(a){var d=document.cookie.indexOf(a+"=");var b=d+a.length+1;if((!d)&&(a!=document.cookie.substring(0,a.length))){return null}if(d==-1){return null}var c=document.cookie.indexOf(";",b);if(c==-1){c=document.cookie.length}return unescape(document.cookie.substring(b,c))}

function DeleteCookie(a,c,b){if(getCookie(a)){document.cookie=a+"="+((c)?";path="+c:"")+((b)?";domain="+b:"")+";expires=Thu, 01-Jan-1970 00:00:01 GMT"}}var busyDivTmr=null;var keepContentID="";var bShowingBusy=false;

function showBusyDiv(k,c){if(document.getElementById("divBusy")!=null){return}if($("#"+c)[0].style.display=="none"){return}bShowingBusy=true;if(c==null||document.getElementById(c)==null){c="leftpanel"}if(k==null||k==""){k="ang t?i d? li?u, vui lng ch? trong giy lt.<br/>N?u ch? qu lu, b?n hy b?m <span><b>Ctrl+F5</b></span>."}keepContentID=c;var d=$("#"+c).clone();d[0].id="divBusy";d.html("<img width='24px' height='24px' id='loadingImg' src='images/loading.gif' /><a class='a1' id='loadingText' style='line-height:20px;font-size:12px;color:#333;'>"+k+"</a>");var f=document.getElementById(c);f.parentNode.appendChild(d[0]);var j=document.getElementById("loadingImg");var a=(parseInt(f.offsetWidth)-parseInt(j.offsetWidth))/2;var h=(parseInt(f.offsetHeight)-parseInt(j.offsetHeight))/2-50;j.style.position="absolute";j.style.left=a+"px";j.style.top=h+"px";var e=document.getElementById("loadingText");var b=(parseInt(f.offsetWidth)-parseInt(e.offsetWidth))/2;var g=(parseInt(f.offsetHeight)-parseInt(e.offsetHeight))/2-10;e.style.position="absolute";e.style.left=b+"px";e.style.top=g+"px";f.style.display="none"}

function hideBusyDiv(){if(!bShowingBusy){return}$("#divBusy").remove();$("#"+keepContentID).show()}var myWidth=0,myHeight=0;

function calculateWindowSize(){if(typeof(window.innerWidth)=="number"){myWidth=window.innerWidth;myHeight=window.innerHeight}else{if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)){myWidth=document.documentElement.clientWidth;myHeight=document.documentElement.clientHeight}else{if(document.body&&(document.body.clientWidth||document.body.clientHeight)){myWidth=document.body.clientWidth;myHeight=document.body.clientHeight}}}}

function MakeItLoom(d,b,c){var a=document.getElementById(d);if(a==null||browserName=="msie"){return}a.style.opacity=b/100;a.style.filter="alpha(opacity = "+b+")";VEvent.addDOMListener(a,"mouseout",function(){$("#"+d).stop().animate({opacity:b/100},c,"linear")});VEvent.addDOMListener(a,"mouseover",function(){$("#"+d).stop().animate({opacity:1},c,"linear")})}

function isPhoneNumber(a){a=Global.RemoveSpace(a.replace(".",""));if(a.length>=6&&!isNaN(a)){return true}else{return false}}
function RemoveHTMLTag(a){if(a==null){return""}a=a.replace(/<.*?>|<[/].*?>/g,"");return a}
function ToSafeHTML(a){if(a==null){return""}return a.replace(/'/g,"&#39").replace(/"/g,"&quot;")}
function checkLogin(){return AJLocationSearch.IsAuthenticated().value}
function RedirectToLoginForm(){window.location=Global.LoginUrl+"?ReturnUrl="+escape(BuildMapLink())}
function MembershipRequire(){if(!checkLogin()){RedirectToLoginForm();return false}return true}
function NormalizeGeo(c,a){var b=new RegExp(a,"g");return c.replace(b,"").replace(/[)]/g,"").replace(/[(]/g,"").replace(/[ ]+/g,",")}
function GeoAsText(d,b){var c=b;if(b=="LINESTRING"){c+="("}else{c+="(("}for(var a=0;a<d.length;a++){c+=d[a].lng()+" "+d[a].lat();if(a<d.length-1){c+=","}}if(b=="LINESTRING"){c+=")"}else{c+="))"}return c}Array.prototype.remove=function(a,b){var c=this.slice((b||a)+1||this.length);this.length=a<0?this.length+a:a;return this.push.apply(this,c)};

function ReportError(){if(nLanguage==0){alert(" c l?i trong qu trnh k?t n?i d?n server. B?n vui lng nh?n Ctrl + F5 d? refresh l?i trang web.")}else{alert("Error occured while trying to connect server. Press Ctrl + F5 to refresh page.")}}

function autoIncrease(c,d,b,a,e){if(e==null){$("#"+c).stop().animate({opacity:0.2},500,"linear")}$("#"+c).html(d);if(d==b){$("#"+c).stop().animate({opacity:1},500,"linear");return}setTimeout(function(){autoIncrease(c,d+1,b,a,true)},a)}

function isSupportEffect(){return(browserName!="msie")}
function LocationObjectHook(a){return AJLocationSearch.GetGeoObjectByPoint(a.lng()+"",a.lat()+"").value}
function LocationHook(a){return AJLocationSearch.GetGeoInfoByPoint(a.lng()+"",a.lat()+"").value}
function GetLocationFullName(b){var c=b.Name;var d=CombineAddress(b);var a=c;if(d!=c&&d!=""){a=c+", "+d}return a}
function QueryString(a){var b=window.location.href;var c="";c=new RegExp("([?]|&)"+a+"=([^&#]*)").exec(b);if(!c){return""}return c[2]}var Browser={Name:"",FullVersion:"",MajorVersion:"",AppName:"",UserAgent:""};

function BrowserDetect(){var f=navigator.appVersion;var a=navigator.userAgent;var c=navigator.appName;var e=""+parseFloat(navigator.appVersion);var h=parseInt(navigator.appVersion,10);var g,d,b;if((d=a.indexOf("MSIE"))!=-1){c="Internet Explorer";e=a.substring(d+5)}else{if((d=a.indexOf("Opera"))!=-1){c="Opera";e=a.substring(d+6)}else{if((d=a.indexOf("Chrome"))!=-1){c="Chrome";e=a.substring(d+7)}else{if((d=a.indexOf("Safari"))!=-1){c="Safari";e=a.substring(d+7)}else{if((d=a.indexOf("Firefox"))!=-1){c="Firefox";e=a.substring(d+8)}else{if((g=a.lastIndexOf(" ")+1)<(d=a.lastIndexOf("/"))){c=a.substring(g,d);e=a.substring(d+1);if(c.toLowerCase()==c.toUpperCase()){c=navigator.appName}}}}}}}if((b=e.indexOf(";"))!=-1){e=e.substring(0,b)}if((b=e.indexOf(" "))!=-1){e=e.substring(0,b)}h=parseInt(""+e,10);if(isNaN(h)){e=""+parseFloat(navigator.appVersion);h=parseInt(navigator.appVersion,10)}Browser.Name=c;Browser.FullVersion=e;Browser.MajorVersion=h;Browser.AppName=navigator.appName;Browser.UserAgent=navigator.userAgent}var VirtualMarker={OverlayLoc:new Array(),currLoc:null,isClicked:true,Layers:new Array(),Init:function(a){a="#"+a;VEvent.addListener(map,"mousemove",function(){var c=map.getCurrentPointer();c.x-=$(a).offset().left;c.y-=$(a).offset().top;c=map.fromContainerPixelToLatLng(c);c=VProjection.fromLatLngToPixel(c,map.getLevel());var e=new Array();e.x=parseInt(c.x/256);e.y=parseInt(c.y/256);for(var d=VirtualMarker.Layers.length-1;d>=0;d--){var f=VirtualMarker.OverlayLoc[VirtualMarker.Layers[d].Name][e.x+"_"+e.y];if(f==null){continue}for(var b=0;b<f.length;b++){var g=f[b];if(Math.abs(g.X-c.x)<=g.Radius&&Math.abs(g.Y-c.y)<=g.Radius){$(a)[0].style.cursor="pointer";VirtualMarker.currLoc=g;return}}}VirtualMarker.currLoc=null});VEvent.addListener(map,"click",function(){if(VirtualMarker.isClicked&&VirtualMarker.currLoc!=null){VirtualMarker.currLoc.onclickfunc()}setTimeout(function(){VirtualMarker.isClicked=true},100)})},CreateLayer:function(d,j,a,h,c,k,b,l,n,g){if(VirtualMarker.Layers[d]!=null&&VirtualMarker.Layers[d].MapType!=null){map.setCenter(map.getCenter(),map.getLevel(),VirtualMarker.Layers[d].MapType);return}var e=new Array();e.Name=d;VirtualMarker.OverlayLoc[d]=new Array();if(g){VEvent.addListener(V_NORMAL_MAP.getTileLayers()[0],"tileload",function(p,o){if(o>=j&&o<=a){l(d,p.x+","+p.y,o,function(q){VirtualMarker.BindOverlay(q,d,n,p,o,h,c,k)})}});e.MapType=V_NORMAL_MAP.getTileLayers()[0]}else{var m=new VTileLayer(new VCopyrightCollection("Vietbando Inc"),j,a);m.getTileUrl=function(p,o){if(o>=j&&o<=a){l(d,p.x+","+p.y,o,function(q){VirtualMarker.BindOverlay(q,d,n,p,o,h,c,k)});return b(d,p,o)}else{return"http://www.vietbando.com/mapimages/transparent.png"}};var f=e.MapType=new VMapType([V_NORMAL_MAP.getTileLayers()[0],m],V_NORMAL_MAP.getProjection(),d);map.addMapType(f);map.setCenter(map.getCenter(),map.getLevel(),f)}VirtualMarker.Layers[VirtualMarker.Layers.length]=e},BindOverlay:function(d,c,p,n,b,g,h,k){if(d.value!=null&&d.value.Tables[0].Rows[0].Coord!=null){d=d.value;var a=new Array();var l=d.Tables[0].Rows[0].Coord.split(";");var o=d.Tables[0].Rows[0].GUID.split(";");for(var e=0;e<l.length;e++){var m=l[e].split(",");a[e]=new Array();a[e].X=n.x*256+(m[0]*1)+g;a[e].Y=n.y*256+(m[1]*1)+h;a[e].Radius=k;a[e].GUID=o[e];var f=new VPoint(a[e].X,a[e].Y);f=VProjection.fromPixelToLatLng(f,b);a[e].latlng=f;a[e].onclickfunc=p}VirtualMarker.OverlayLoc[c][n.x+"_"+n.y]=a}}};var PlaceToFindPathArray=new Array();var PathPolylineArray=new Array();var arrArrows=new Array();var PlaceArray=new Array(0,0);var currentIndex=-1;var currentSub=-1;var currentFindtype=0;var isFinding=false;var isChanging=false;var isSearching=false;var isFPObjDragging=false;var selectedPoly=null;var currentStep=null;var toFirstFlag=false;var changeContentFlag=false;var PathSectionID=0;var alphabet="A,B,C,D,E,F,G,H,I,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z";alphabet=alphabet.split(",");

function SetDirectionInputText(b,a){
	$("input","#direction"+b)[0].value=a;
	OnforcusTextBoxAB($("input","#direction"+b));
	if(a!=""){
		$("input","#direction"+b).attr("class","boxtimduong");$(".del-timduong","#direction"+b).css("display","")}else{$("input","#direction"+b).attr("class","boxtimduong timduong-default");$("input","#direction"+b).val(inputDirHelp);$(".del-timduong","#direction"+b).css("display","none")}}
		
function AddPlace(){var a=PlaceArray.length;if(a>alphabet.length-1){return}var c=document.getElementById("findpath_div");var b=dirInputTemplate;b=b.replace(/[$]section[$]/g,a);b=b.replace(/[$]order[$]/g,alphabet[a]);$("#listDirection").append(b);PlaceArray.push(0)}

function AddPathMarker(d,c){var b=new VMarkerOptions(new VIcon("",new VSize(33,33)));b.offset=new VSize(12,32);b.customMarker='<span class="a-z">'+alphabet[c]+"</span>";b.zIndexProcess=function(){return 4};var a=new VMarker(d,b);map.addOverlay(a);a.enableDragging();a.sid=c+",0";a.type=FPMARKEROBJ;VEvent.addListener(a,"dragend",function(){FixCenter=false;isFPObjDragging=false;var e=a.sid.toString().split(",");var f=parseInt(e[0]);if(arrFinish[f]!=null){if(arrFinish.length==1){arrFinish[f].hide();arrFinish.pop();firstStart=true}else{arrFinish[f].hide()}}UpdateShortestPath(a.sid)});VEvent.addListener(a,"dragging",function(){isFPObjDragging=true;if(mkD!=null){map.removeOverlay(mkD);mkD=null}ChangeShortestPath(a.sid)});return a}

function AddPlaceToFind(g,d){var e=PlaceToFindPathArray.length;var f=false;if(toFirstFlag==true){toFirstFlag=false;f=true;e--}if(PlaceToFindPathArray.length==0){e++;toFirstFlag=true}if(e>alphabet.length-1||isFinding==true){return}ChangeFunctionType(GLOBAL_FINDPATH_FUNCTION);if(d==undefined||d==""){d=g.toUrlValue()}var a=document.getElementById("findpath_div").childNodes[0];var c=AddPathMarker(g,e);changeContentFlag=true;SetDirectionInputText(e,d);var b=new Array();b.push(c);PlaceToFindPathArray.push(b);if(f==true){PlaceToFindPathArray[1]=PlaceToFindPathArray[0];PlaceToFindPathArray[0]=b}b=new Array();b.push(0);PathPolylineArray.push(b);b=new Array();b.push(0);arrArrows.push(b);PlaceArray[e]=1;if(PlaceToFindPathArray.length>1){AddPlace()}FindShortestPath(e+","+0,0,1)}

function AddPlaceFromFind(l,g){if(PlaceToFindPathArray.length>alphabet.length-1||isFinding==true){return}var a=0;ChangeFunctionType(GLOBAL_FINDPATH_FUNCTION);if(g==undefined||g==""){g=l.toUrlValue()}var k=document.getElementById("findpath_div");var b=AddPathMarker(l,0);if(toFirstFlag==true){toFirstFlag=false;SetDirectionInputText(0,g);PlaceArray[0]=1;var h=new Array();h.push(b);PlaceToFindPathArray.push(h);h=new Array();h.push(0);PathPolylineArray.push(h);h=new Array();h.push(0);arrArrows.push(h);PlaceToFindPathArray.reverse();AddPlace();FindShortestPath("0,0",0,1);return}if(PlaceArray[0]==0){SetDirectionInputText(0,g);PlaceArray[0]=1;var h=new Array();h.push(b);PlaceToFindPathArray.push(h);h=new Array();h.push(0);PathPolylineArray.push(h);h=new Array();h.push(0);arrArrows.push(h);CheckMissingPlace();return}for(var e=PlaceArray.length-1;e>=0;e--){changeDirectionIndex(e,e+1);var d='<span class="a-z">'+alphabet[e+1]+"</span>";if(e<PlaceToFindPathArray.length){for(var c=0;c<PlaceToFindPathArray[e].length;c++){PlaceToFindPathArray[e][c].sid=e+1+","+c}for(var c=0;c<PathPolylineArray[e].length;c++){PathPolylineArray[e][c].sid=(e+1)+","+c}PlaceToFindPathArray[e][0].setCustomMarker(d)}}PlaceArray.push(0);PlaceToFindPathArray.push(b);PathPolylineArray.push(new Array());arrArrows.push(new Array());for(var e=PlaceArray.length-1;e>0;e--){if(e<PlaceToFindPathArray.length){PlaceToFindPathArray[e]=PlaceToFindPathArray[e-1];PathPolylineArray[e]=PathPolylineArray[e-1];arrArrows[e]=arrArrows[e-1]}PlaceArray[e]=PlaceArray[e-1]}var h=new Array();h.push(b);PlaceToFindPathArray[0]=h;h=new Array();h.push(0);PathPolylineArray[0]=h;h=new Array();h.push(0);arrArrows[0]=h;PlaceArray[0]=1;var f=dirInputTemplate;f=f.replace(/[$]section[$]/g,a);f=f.replace(/[$]order[$]/g,alphabet[a]);$("#direction1").before(f);SetDirectionInputText(a,g);if(PlaceArray.length==alphabet.length+1){$("#direction"+(PlaceArray.length-1)).remove();PlaceArray.pop()}FindShortestPath("0,0",0,1)}

function ClickRemovePlaceButton(a){var g=document.getElementById("findpath_div");var f=a.parentNode.parentNode.id;var b=parseInt(f.substring(9,f.length));var d=b+",0";var h=d.split(",");var e=parseInt(h[0]);var c=parseInt(h[1]);RemovePlace(b+",0");if(toFirstFlag==true){return}}
		
function changeDirectionIndex(a,b){
	var d=document.getElementById("direction"+a);
	if(d==null){
		return
	}
	$(".a-z","#direction"+a).html(alphabet[b]);
	$("input","#direction"+a)[0].onkeydown=function(e){return SearchPlaceEnter(e,b)};
	d.id="direction"+b;
	document.getElementById("guide"+a).id="guide"+b;
	var c=document.getElementById("btnSearchPlace"+a);
	c.id="btnSearchPlace"+b;
	c.onclick=function(){doSearchPlace(b)}
}
function RemovePlace(g,f){
	ping_connection();
	if(mkP!=null){
		map.removeOverlay(mkP);
		mkP=null
	}
	map.closeInfoWindow();
	var h=g.split(",");
	var a=parseInt(h[0]);
	var k=parseInt(h[1]);
	if(toFirstFlag==true&&a==1){
		toFirstFlag=false;
		map.removeOverlay(PlaceToFindPathArray[0][0]);
		PlaceToFindPathArray=new Array();
		PathPolylineArray=new Array();
		arrArrows=new Array();
		PlaceArray=new Array(0,0);
		SetDirectionInputText(1,"");
		document.getElementById("clearPathResultText").style.display="none";
		return
	}
	if(PlaceArray[a]==0){
		return
	}
	if(k>0){
		map.removeOverlay(PathPolylineArray[a][k]);
		map.removeOverlay(arrArrows[a][k]);
		map.removeOverlay(PlaceToFindPathArray[a][k]);
		for(var d=k;d<PlaceToFindPathArray[a].length-1;d++){
			PathPolylineArray[a][d]=PathPolylineArray[a][d+1];
			arrArrows[a][d]=arrArrows[a][d+1];
			PathPolylineArray[a][d].sid=a+","+d;
			PlaceToFindPathArray[a][d]=PlaceToFindPathArray[a][d+1];
			PlaceToFindPathArray[a][d].sid=a+","+d}PathPolylineArray[a].pop();arrArrows[a].pop();
			PlaceToFindPathArray[a].pop();
			AJLocationSearch.RemoveDirectionPlaces(ClientID,GetPolylineOrder(a)+k,1);
			FindShortestPath(a+",0",1,0,1);
			return
		}
		if(f!=1){
			if(a==0&&PlaceToFindPathArray.length>1){
				AJLocationSearch.RemoveDirectionPlaces(ClientID,0,GetPolylineOrder(a+1))
			}else{
				if(a==PlaceToFindPathArray.length-1&&a>0){
					AJLocationSearch.RemoveDirectionPlaces(ClientID,GetPolylineOrder(a-1),GetPolylineOrder(a)-GetPolylineOrder(a-1))
				}else{
					AJLocationSearch.RemoveDirectionPlaces(ClientID,GetPolylineOrder(a-1),GetPolylineOrder(a+1)-GetPolylineOrder(a-1)-1)
				}
			}
		}
		if(a>0){
			for(var d=PlaceToFindPathArray[a-1].length-1;d>=0;d--){
				map.removeOverlay(PathPolylineArray[a-1][d]);
				PathPolylineArray[a-1].pop();
				map.removeOverlay(arrArrows[a-1][d]);
				arrArrows[a-1].pop();
				if(d>0){
					map.removeOverlay(PlaceToFindPathArray[a-1][d]);PlaceToFindPathArray[a-1].pop()
				}
			}
		}
		if(a<PlaceToFindPathArray.length-1){
			for(var d=PlaceToFindPathArray[a].length-1;d>=0;d--){
				map.removeOverlay(PathPolylineArray[a][d]);
				PathPolylineArray[a].pop();
				map.removeOverlay(arrArrows[a][d]);
				arrArrows[a].pop();
				map.removeOverlay(PlaceToFindPathArray[a][d]);
				PlaceToFindPathArray[a].pop()
			}
		}else{
			if(a==PlaceToFindPathArray.length-1){
				map.removeOverlay(PlaceToFindPathArray[a][0]);PlaceToFindPathArray[a].pop()
			}
		}
		if(PlaceArray.length==2){
			prev_selectedResAB_Text="";
			PlaceArray[a]=0;
			SetDirectionInputText(0,"")
		}else{
			var e=a;
			if(a==PlaceToFindPathArray.length-1){
				e=a-1}$("#direction"+a).remove();
				$("#guide"+a).remove();
				$("#guide"+(e)).html("");
				$(".swrap-timduong",("#direction"+e)).removeClass("background")
			}
			for(var d=a;d<PlaceArray.length;d++){
				if(d>=a&&PlaceArray.length>2){
					changeDirectionIndex(d,d-1)
				}
				if(d<PlaceToFindPathArray.length){
					var c='<span class="a-z">'+alphabet[d-1]+"</span>";
					if(d!=a){
						PlaceToFindPathArray[d][0].setCustomMarker(c)
					}
					for(var b=0;b<PlaceToFindPathArray[d].length;b++){
						PlaceToFindPathArray[d][b].sid=(d-1)+","+b
					}
					for(var b=0;b<PathPolylineArray[d].length;b++){
						PathPolylineArray[d][b].sid=(d-1)+","+b
					}
					PlaceToFindPathArray[d]=PlaceToFindPathArray[d+1];
					PathPolylineArray[d]=PathPolylineArray[d+1];
					arrArrows[d]=arrArrows[d+1]
				}
				if(PlaceArray[d+1]!=undefined){
					PlaceArray[d]=PlaceArray[d+1]
				}else{
					PlaceArray[d]=0}
				}
				PlaceToFindPathArray.pop();
				PathPolylineArray.pop();
				arrArrows.pop();
				if(PlaceArray.length>2){
					PlaceArray.pop()
				}
				if(PlaceToFindPathArray.length==alphabet.length-1){
					AddPlace()
				}
				if(a==0||a==PlaceToFindPathArray.length){
					LoadDirectionTool();
					GetTotalDistance()
				}else{
					FindShortestPath(a-1+","+0,0,0)
				}
}
function LoadDirectionTool(){
	if(PlaceToFindPathArray.length<2){$("#topLeftPathResult").css("display","none");$("#clearPathResultText").css("display","none")}else{$("#topLeftPathResult").css("display","");$("#clearPathResultText").css("display","")}if(PlaceToFindPathArray.length==2){document.getElementById("tdreverse").style.display="";document.getElementById("printDirection").style.display=""}else{document.getElementById("tdreverse").style.display="none"}}
	
function RemovePlace_History(e,d,h){if(mkP!=null){map.removeOverlay(mkP);mkP=null}map.closeInfoWindow();var g=document.getElementById("findpath_div");var f=e.split(",");var a=parseInt(f[0]);var b=parseInt(f[1]);if(PlaceArray[a]==0){return}if(PathPolylineArray[0][0]==0){return}if(PlaceToFindPathArray[0][0]==0){return}if(b>0){if(h){PathPolylineArray[a][b].hide();PlaceToFindPathArray[a][b].hide()}else{PathPolylineArray[a][b].show();PlaceToFindPathArray[a][b].show()}for(var c=b;c<PlaceToFindPathArray[a].length-1;c++){PathPolylineArray[a][c]=PathPolylineArray[a][c+1];PathPolylineArray[a][c].sid=a+","+c;PlaceToFindPathArray[a][c]=PlaceToFindPathArray[a][c+1];PlaceToFindPathArray[a][c].sid=a+","+c}return}if(a>0){for(var c=PlaceToFindPathArray[a-1].length-1;c>=0;c--){if(h){PathPolylineArray[a-1][c].hide()}else{PathPolylineArray[a-1][c].show()}if(c>0){if(h){PlaceToFindPathArray[a-1][c].hide()}else{PlaceToFindPathArray[a-1][c].show()}}}}if(a<PlaceToFindPathArray.length-1){for(var c=PlaceToFindPathArray[a].length-1;c>=0;c--){if(h){PathPolylineArray[a][c].hide();PlaceToFindPathArray[a][c].hide()}else{PathPolylineArray[a][c].show();PlaceToFindPathArray[a][c].show()}}}else{if(a==PlaceToFindPathArray.length-1){if(h){PlaceToFindPathArray[a][0].hide()}else{PlaceToFindPathArray[a][0].show()}}}if(a==0||a==PlaceToFindPathArray.length){LoadDirectionTool();GetTotalDistance()}}var FixCenter=true;

function FromHereClick(a){FixCenter=false;AddPlaceFromFind(a,LocationHook(a));closeContextMenu()}
function ToHereClick(a){FixCenter=false;AddPlaceToFind(a,LocationHook(a));closeContextMenu()}
function GetPolylineOrder(c){var b=0;if(c==PlaceToFindPathArray.length){return -1}for(var a=0;a<c;a++){b+=PlaceToFindPathArray[a].length}return b}
function UpdateShortestPath(c){var a=c.split(",");var d=parseInt(a[0]);var b=parseInt(a[1]);if(PlaceToFindPathArray.length<2||isFinding==true){return}currentIndex=d;currentSub=b;var e=LocationHook(PlaceToFindPathArray[d][0].getLatLng());if(e==undefined||e==""){e=PlaceToFindPathArray[d][0].getLatLng().toUrlValue()}$("input","#direction"+d).val(e);FindShortestPath(d+","+b,0,0)}var PathOptions={Alley:1,Block:0,Vehicle:1};

function CheckMissingPlace(){if(needtoFillAllPlace){for(var b=0;b<PlaceArray.length;b++){var a=$("input","#direction"+b);if(a.val()!=inputDirHelp&&PlaceArray[b]==0){if(CheckInputDatatype(a.val())!="coor"){SearchPlace(b,a.val(),1);return true}}}}return false}var needtoFillAllPlace=false;
function FindAllPath(){needtoFillAllPlace=false;if(PlaceToFindPathArray.length<2||PlaceToFindPathArray.length<PlaceArray.length){needtoFillAllPlace=true;if(CheckMissingPlace()){return}}if(isFinding==true){return}ping_connection();if(mkP!=null){map.removeOverlay(mkP);mkP=null}var d="";var e="";var c=map.getLevel();var a=map.getDirectionBounds();for(var b=0;b<PlaceToFindPathArray.length;b++){for(var f=0;f<PlaceToFindPathArray[b].length;f++){d+=PlaceToFindPathArray[b][f].getPoint().lng()+","+PlaceToFindPathArray[b][f].getPoint().lat()+","}if(b>0&&b<PlaceToFindPathArray.length-1){e+=PlaceToFindPathArray[b-1].length+","}}AJLocationSearch.FindShortestPath(ClientID,d,PathOptions.Vehicle,e,0,-1,c,a.getNorthWest().lng(),a.getNorthWest().lat(),a.getSouthEast().lng(),a.getSouthEast().lat(),currentFindtype,0,0,0,PathOptions.Alley,PathOptions.Block,PathOptions.Block,FindAllPathChange);isFinding=true;showBusyDiv("","findpathtabdiv")}

function FindAllPathChange(c){if(c.error!=null){return}var b=c.value;var d=0;for(var a=0;a<PathPolylineArray.length;a++){for(var e=0;e<PathPolylineArray[a].length;e++){if(PathPolylineArray[a][e]!=null&&d<b.length){PathPolylineArray[a][e].setLatLngs(b[d])}if(arrArrows[a][e]!=null&&d<b.length){arrArrows[a][e].setLatLngs(b[d])}d++}}isFinding=false;isChanging=false;FitDirectionOverlays();GetAllPathDirection()}

function FindShortestPath(g,h,e,k){if(PlaceToFindPathArray.length<2){return}var n=g.split(",");var b=parseInt(n[0]);var l=parseInt(n[1]);currentIndex=b;currentSub=l;if(b<0||b>PlaceToFindPathArray.length-1){return}ping_connection();if(mkP!=null){map.removeOverlay(mkP);mkP=null}var f="";var a="";if(h==1){currentFindtype=1;for(var m=0;m<=l;m++){f+=PlaceToFindPathArray[b][m].getPoint().lng()+","+PlaceToFindPathArray[b][m].getPoint().lat()+","}if(mkD!=null){f+=mkD.getPoint().lng()+","+mkD.getPoint().lat()+","}for(var m=l+1;m<PlaceToFindPathArray[b].length;m++){f+=PlaceToFindPathArray[b][m].getPoint().lng()+","+PlaceToFindPathArray[b][m].getPoint().lat()+","}f+=PlaceToFindPathArray[b+1][0].getPoint().lng()+","+PlaceToFindPathArray[b+1][0].getPoint().lat()}else{currentFindtype=0;if(b>0&&l==0){for(var m=0;m<PlaceToFindPathArray[b-1].length;m++){f+=PlaceToFindPathArray[b-1][m].getPoint().lng()+","+PlaceToFindPathArray[b-1][m].getPoint().lat()+","}}for(var m=0;m<PlaceToFindPathArray[b].length;m++){f+=PlaceToFindPathArray[b][m].getPoint().lng()+","+PlaceToFindPathArray[b][m].getPoint().lat()+","}if(b<PlaceToFindPathArray.length-1){f+=PlaceToFindPathArray[b+1][0].getPoint().lng()+","+PlaceToFindPathArray[b+1][0].getPoint().lat();if(b>0){a=PlaceToFindPathArray[b-1].length.toString()}}}var d=map.getLevel();var c=map.getDirectionBounds();var j=GetPolylineOrder(currentIndex);if(currentIndex==PlaceToFindPathArray.length-1||(currentIndex>0&&l==0&&e==0&&k!=1)){j=GetPolylineOrder(currentIndex-1)}AJLocationSearch.FindShortestPath(ClientID,f,PathOptions.Vehicle,a,0,1,d,c.getNorthWest().lng(),c.getNorthWest().lat(),c.getSouthEast().lng(),c.getSouthEast().lat(),currentFindtype,j,currentSub,e,PathOptions.Alley,PathOptions.Block,PathOptions.Block,FindShortestPathChange);isFinding=true;showBusyDiv("","findpathtabdiv")}var firstStart=true;var mStart=null;var mFinish=null;var arrFinish=new Array();

function FindShortestPathChange(b){hideBusyDiv();if(b==null||b.error!=null||b.value==null){isFinding=false;isChanging=false;return}var k=b.value;var j,e;directionLatLng=map.getCenter();if(currentFindtype==1){var c=0.5;for(var d=0;d<k.length;d++){var g=new VPolyline(k[d],"red",3,"",c);g.sid=currentIndex+","+(d);if(PathPolylineArray[currentIndex][d]!=0&&PathPolylineArray[currentIndex][d]!=null){map.removeOverlay(PathPolylineArray[currentIndex][d])}PathPolylineArray[currentIndex][d]=g;map.addOverlay(g);AddPathMouseMoveEvent(g);var m=new VArrow(k[d],"end");if(arrArrows[currentIndex][d]!=0&&arrArrows[currentIndex][d]!=null){map.removeOverlay(arrArrows[currentIndex][d])}arrArrows[currentIndex][d]=m;map.addOverlay(m);if(d>0){var l=new VLatLng(g.getVertex(0).lat(),g.getVertex(0).lng());var a=PlaceToFindPathArray[currentIndex][d];j=new VIcon("images/circle.gif");j.iconSize=new VSize(10,10);e=new VMarkerOptions(j,null,new VSize(5,5));if(a==null){a=new VMarker(l,e);a.type=FPMARKEROBJ;PlaceToFindPathArray[currentIndex].push(a);map.addOverlay(a)}a.sid=currentIndex+","+(d);a.setPoint(l);a.enableDragging();VEvent.addListener(a,"dragend",function(n){isFPObjDragging=false;FindShortestPath(n.sid,1,0)});VEvent.addListener(a,"dragging",function(n){isFPObjDragging=true;if(mkD!=null){map.removeOverlay(mkD);mkD=null}ChangeShortestPath(n.sid)})}}GetPathDirection();return}var f=0;if(currentIndex>0){f=BindPath(k,f,currentIndex-1)}if(currentIndex<PlaceToFindPathArray.length-1){BindPath(k,f,currentIndex)}var h=$("input","#direction"+currentIndex).val();if(FixCenter){FitDirectionOverlays()}FixCenter=true;GetPathDirection()}

function BindPath(g,e,d){var c=0.5;for(var f=0;f<PlaceToFindPathArray[d].length;f++){var b=new VPolyline(g[e],"red",3,"",c);b.sid=d+","+f;if(PathPolylineArray[d][f]!=0&&PathPolylineArray[d][f]!=null){map.removeOverlay(PathPolylineArray[d][f])}PathPolylineArray[d][f]=b;map.addOverlay(b);AddPathMouseMoveEvent(b);var a=new VArrow(g[e],"end");if(arrArrows[d][f]!=0&&arrArrows[d][f]!=null){map.removeOverlay(arrArrows[d][f])}arrArrows[d][f]=a;map.addOverlay(a);e++;PlaceToFindPathArray[d][f].setPoint(b.getVertex(0));PlaceToFindPathArray[d+1][0].setPoint(b.getVertex(b.getVertexCount()-1))}return e}

function AddPathMouseMoveEvent(a){VEvent.addListener(a,"mousemove",function(c,f,b){if(!isFPObjDragging){var h=new VIcon("images/circle.gif");h.iconSize=new VSize(10,10);if(mkD!=null){map.removeOverlay(mkD);mkD=null}var g=map.fromLatLngToDivPixel(c);var l=map.fromLatLngToDivPixel(b.latlngs[0][0]);var k=b.latlngs.length;var d=b.latlngs[k-1].length;var j=map.fromLatLngToDivPixel(b.latlngs[k-1][d-1]);if(VUtil.Distance(g.x,g.y,l.x,l.y)>150&&VUtil.Distance(g.x,g.y,j.x,j.y)>150){var e=new VMarkerOptions(h,null,new VSize(5,5));mkD=new VMarker(c,e);mkD.sid=b.sid;selectedPoly=b.sid;map.addOverlay(mkD);mkD.enableDragging();VEvent.addListener(mkD,"mousemove",function(q,m){var r=b.latlngs;var s=new Array();VUtil.ClosestPointPolylines(m.lng(),m.lat(),r,s);var p=s[0];var n=map.fromLatLngToDivPixel(p);var v=map.fromLatLngToDivPixel(b.latlngs[0][0]);var u=b.latlngs.length;var o=b.latlngs[u-1].length;var t=map.fromLatLngToDivPixel(b.latlngs[u-1][o-1]);if(VUtil.Distance(n.x,n.y,v.x,v.y)>150&&VUtil.Distance(n.x,n.y,t.x,t.y)>150){mkD.setPoint(p)}});VEvent.addListener(mkD,"dragend",function(){isFPObjDragging=false;FindShortestPath(mkD.sid,1,1)});VEvent.addListener(mkD,"dragging",function(){isFPObjDragging=true;ChangeShortestPath(mkD.sid,1)})}}})}

function GetAllPathDirection(){AJLocationSearch.GetDirection(GetAllPathDirectionChange)}
function GetAllPathDirectionChange(c){if(c.error!=null){return}ChangeFunctionType(GLOBAL_FINDPATH_FUNCTION);var a=ReplaceDirectionText(c.value).split("newsectiontable");hideBusyDiv("");for(var b=0;b<a.length-1;b++){BindPathResult(b,a[b])}GetTotalDistance();isFinding=false;isChanging=false}

function BindPathResult(f,d){$(".swrap-timduong",("#direction"+f)).addClass("background");if(f==0){document.getElementById("guide0").innerHTML=d}else{var e=document.getElementById("guide"+f);e.innerHTML=d;var b=document.getElementById("guide"+(f-1));if(b==null||b.getElementsByTagName("table")[1]==null){return}var g=b.getElementsByTagName("table")[1].rows.length;var c=b.getElementsByTagName("table")[1].rows[g-2].cells[0].innerHTML.replace(".","");c=parseInt(c);var h=e.getElementsByTagName("table")[1];if(h==null){return}for(var a=0;a<h.rows.length-1;a++){h.rows[a].cells[0].innerHTML=(c+a+1)+"."}}}

function ReplaceDirectionText(a){if(nLanguage==0){a=a.replace(/Start at/g,"B?t d?u t?i di?m");a=a.replace(/Arrive at/g,"?n dch t?i di?m");a=a.replace(/Head on/g,"i th?ng");a=a.replace(/Turn right at/g,"R? ph?i vo");a=a.replace(/Turn left at/g,"R? tri vo");a=a.replace(/Continue on/g,"i ti?p");a=a.replace(/Length/g,"Chi?u di");a=a.replace(/Find business on this route/g,"Tm d?ch v? trn do?n ny");a=a.replace(/We cannot drive between two these locations/g,"Chng ti khng tm th?y du?ng di gi?a hai v? tr ny")}return a}

function GetPathDirection(){AJLocationSearch.GetDirection(GetPathDirectionChange)}var complexFindPathObject=new Object();

function GetPathDirectionChange(c){if(c.error!=null){return}if(currentIndex>PlaceToFindPathArray.length-1){return}isFinding=false;isChanging=false;var d=c.value;d=ReplaceDirectionText(d);var a=d.split("newsectiontable");var b=0;hideBusyDiv("");if(currentFindtype==1){BindPathResult(currentIndex,a[0])}else{if(currentIndex>0){BindPathResult(currentIndex-1,a[b]);b++}if(currentIndex<PlaceToFindPathArray.length-1){BindPathResult(currentIndex,a[b].substring(a[b].indexOf("<TABLE")))}}ChangeFunctionType(GLOBAL_FINDPATH_FUNCTION);GetTotalDistance()}var a1,a2,ptMove=null;

function ChangeShortestPath(f,g){if(PlaceToFindPathArray.length<2||isChanging==true||isFinding==true){return}var k=f.split(",");var c=parseInt(k[0]);var d=parseInt(k[1]);currentIndex=c;currentSub=d;if(c<0||c>PlaceToFindPathArray.length-1){return}var j=(mkD!=null)?mkD.getPoint():PlaceToFindPathArray[c][d].getPoint();if(ptMove!=null&&ptMove.equals(j)){return}a1=f;a2=g;if(mkP!=null){map.removeOverlay(mkP);mkP=null}var e="";var b="";if(g==1){currentFindtype=1;e+=PlaceToFindPathArray[c][d].getPoint().lng()+","+PlaceToFindPathArray[c][d].getPoint().lat()+",";e+=mkD.getPoint().lng()+","+mkD.getPoint().lat();if(d<PlaceToFindPathArray[c].length-1){e+=","+PlaceToFindPathArray[c][d+1].getPoint().lng()+","+PlaceToFindPathArray[c][d+1].getPoint().lat()}else{e+=","+PlaceToFindPathArray[c+1][0].getPoint().lng()+","+PlaceToFindPathArray[c+1][0].getPoint().lat()}}else{currentFindtype=0;if(c>0&&d==0){e+=PlaceToFindPathArray[c-1][PlaceToFindPathArray[c-1].length-1].getPoint().lng()+","+PlaceToFindPathArray[c-1][PlaceToFindPathArray[c-1].length-1].getPoint().lat()+","}else{if(d>0){e+=PlaceToFindPathArray[c][d-1].getPoint().lng()+","+PlaceToFindPathArray[c][d-1].getPoint().lat()+","}}e+=PlaceToFindPathArray[c][d].getPoint().lng()+","+PlaceToFindPathArray[c][d].getPoint().lat();if(c<PlaceToFindPathArray.length-1&&d>=PlaceToFindPathArray[c].length-1){e+=","+PlaceToFindPathArray[c+1][0].getPoint().lng()+","+PlaceToFindPathArray[c+1][0].getPoint().lat()}else{if(d<PlaceToFindPathArray[c].length-1){e+=","+PlaceToFindPathArray[c][d+1].getPoint().lng()+","+PlaceToFindPathArray[c][d+1].getPoint().lat()}}}var h=map.getLevel();var a=map.getDirectionBounds();if(mkD!=null){ptMove=mkD.getPoint().copy()}else{ptMove=PlaceToFindPathArray[c][d].getPoint().copy()}AJLocationSearch.FindShortestPath(ClientID,e,PathOptions.Vehicle,b.toString(),1,1,h,a.getNorthWest().lng(),a.getNorthWest().lat(),a.getSouthEast().lng(),a.getSouthEast().lat(),-1,-1,-1,-1,PathOptions.Alley,PathOptions.Block,PathOptions.Block,ChangeShortestPathChange);isChanging=true}

function ChangeShortestPathChange(c){if(c.error!=null){return}var b=c.value;if(b==null||b[0]==null||b.length<1||isFinding==true){return}if(currentFindtype==1){for(var a=0;a<b[1].length;a++){b[0].push(b[1][a])}b.pop();PathPolylineArray[currentIndex][currentSub].setLatLngs(b[0]);arrArrows[currentIndex][currentSub].setLatLngs(b[0]);isChanging=false;ChangeShortestPath(a1,a2);return}var a=0;if(currentIndex>0&&currentSub==0){PathPolylineArray[currentIndex-1][PathPolylineArray[currentIndex-1].length-1].setLatLngs(b[0]);arrArrows[currentIndex-1][arrArrows[currentIndex-1].length-1].setLatLngs(b[0]);a++}else{if(currentSub>0){PathPolylineArray[currentIndex][currentSub-1].setLatLngs(b[0]);arrArrows[currentIndex][currentSub-1].setLatLngs(b[0]);a++}}if(currentIndex<PlaceToFindPathArray.length-1){PathPolylineArray[currentIndex][currentSub].setLatLngs(b[a]);arrArrows[currentIndex][currentSub].setLatLngs(b[a])}isChanging=false;ChangeShortestPath(a1,a2)}

function GetDirectionLatLngs(){if(PlaceToFindPathArray.length<2){return}var b=map.getLevel();var a=map.getDirectionBounds();directionLatLng=map.getCenter();directionLevel=b;AJLocationSearch.GetDirectionLatLngs(ClientID,b,a.getNorthWest().lng(),a.getNorthWest().lat(),a.getSouthEast().lng(),a.getSouthEast().lat(),GetDirectionLatLngsChange)}

function GetDirectionLatLngsChange(d){if(d.error!=null||d==null||d.value==null){return}var b=d.value;var c=0;for(var a=0;a<PlaceToFindPathArray.length;a++){for(var e=0;e<PlaceToFindPathArray[a].length;e++){if(PathPolylineArray[a][e].setLatLngs!=undefined){PathPolylineArray[a][e].setLatLngs(b[c])}if(arrArrows[a][e].setLatLngs!=undefined){arrArrows[a][e].setLatLngs(b[c])}c++}if(c>=b.length){break}}}

function FitDirectionOverlays(){var b=new Array();for(var a=0;a<PlaceToFindPathArray.length;a++){for(var c=0;c<PlaceToFindPathArray[a].length;c++){if(PlaceToFindPathArray[a][c]!=null&&PlaceToFindPathArray[a][c].vType!=null){if(PlaceToFindPathArray[a][c].vType()=="VMarker"){b.push(PlaceToFindPathArray[a][c])}}}}for(var a=0;a<PathPolylineArray.length;a++){for(var c=0;c<PathPolylineArray[a].length;c++){if(PathPolylineArray[a][c]!=null&&PathPolylineArray[a][c].vType!=null){if(PathPolylineArray[a][c].vType()=="VPolyline"){b.push(PathPolylineArray[a][c])}}}}map.fitMultiOverlays(b);b=new Array()}

function CloseDirection(a){if(a==undefined||a.parentNode==undefined){a=this}$(".stepsList",a.parentNode.parentNode).css("display","none");$(".summary",a.parentNode.parentNode).css("display","none");$(".options",a.parentNode.parentNode).attr("class","options");$(".swrap-timduong",a.parentNode.parentNode.parentNode).attr("class","swrap-timduong");a.className="expand";a.onclick=OpenDirection}

function OpenDirection(){var a=this;$(".stepsList",a.parentNode.parentNode).css("display","");$(".summary",a.parentNode.parentNode).css("display","");$(".options",a.parentNode.parentNode).attr("class","options background");$(".swrap-timduong",a.parentNode.parentNode.parentNode).attr("class","swrap-timduong background");a.className="collapse";a.onclick=CloseDirection}

function OverDirectionGuide(b,h,m){if(b!=currentElement){$(b).addClass("StepList-hover")}var a=b.parentNode.parentNode.parentNode.id;var d=parseInt(a.substring(5,a.length));var e=b.id.split("_");var c=parseFloat(e[0]);var k=parseFloat(e[1]);if(d>=0){var n=new VLatLng(k,c);var j=map.getLevel();var f=new VIcon("images/blink2.gif");f.iconSize=new VSize(11,11);var g=new VMarkerOptions(f,null,new VSize(5,5));if(mkOP!=null){map.removeOverlay(mkOP);mkOP=null}mkOP=new VMarker(n,g);map.addOverlay(mkOP)}}
function OutDirectionGuide(a){
	$(a).removeClass("StepList-hover");
	if(mkOP!=null){
		map.removeOverlay(mkOP);
		mkOP=null
	}
}

function SearchPlaceEnter(a,b){
			if(a.keyCode==13){
				doSearchPlace(b)
			}
		}
function doSearchPlace(b){
	var a=$("input","#direction"+b).val();
	if(a==""||a==inputDirHelp){
		return
	}
	if(CheckInputDatatype(a)=="coor"){
		CheckCoorInput(b,a)
	}else{
		SearchPlace(b,a,1)
	}
	return false
}
function CheckInputDatatype(a){
	var b=a.split(",");
	if(b.length==2&&!isNaN(parseFloat(b[0]))&&!isNaN(parseFloat(b[1]))){
		return"coor"
	}else{
		return"string"}
}
function CheckCoorInput(b,a){
	var c=a.split(",");
	var d=new VLatLng(parseFloat(c[0]),parseFloat(c[1]));
	if(PlaceToFindPathArray[b]==null){
		if(b==PlaceToFindPathArray.length&&b==0){
			AddPlaceFromFind(d)
		}else{
			AddPlaceToFind(d)
		}
	}else{
		PlaceToFindPathArray[b][0].setPoint(d);
		FindShortestPath(b+",0",0,0)
	}
}
var currentElement=null;
function GetRoadFromShortestPath(c,f){
	var a=c.parentNode.parentNode.id;
	var e=parseInt(a.substring(5,a.length));
	var m=c.id.split("_");
	var d=$("a",c).html()*1;
	var b=$(".instruction",c).html();
	var g=$(".distance",c).html();
	if(e>=0){
		b+=' <span style="white-space:nowrap;">- '+((b.indexOf("i")==0)?"":"di ")+g+"</span>";
		var j='<div class="MiniPopup" style="width:230px;"><p style="padding:2px;font-size:12px">'+b+"</p>";
		if(nLanguage==0){
			if(isPlayStep){j+='<div class="DirectFunction">';
			j+='<a id="dirPrev" class="dirPrevDis" title="Bu?c tru?c d"></a>';
			j+=' <a id="dirPlay" class="dirStopAvai" title="D?ng" onclick="StopStep('+e+","+d+')"></a>';
			j+=' <a id="dirNext" class="dirNextDis" title="Bu?c ti?p theo"></a>';
			j+="</div></div>"
		}else{
			j+='<div class="DirectFunction">';
			j+='<a id="dirPrev" class="dirPrevAvai" title="Bu?c tru?c d" onclick="ShowStep('+e+","+(d-1)+')"></a>';
			j+=' <a id="dirPlay" class="dirPlayStepAvai" title="Ch?y t? d?ng" onclick="PlayStep('+e+","+d+')"></a>';
			j+=' <a id="dirNext" class="dirNextAvai" title="Bu?c ti?p theo" onclick="ShowStep('+e+","+(d+1)+')"></a>';
			j+="</div></div>"
		}
	}
	var m=new VLatLng(m[1],m[0]);
	currentStep=c;
	if(map.getLevel()<16){
		map.setCenter(m,16)
	}
	var k=new VIcon("images/blink1.gif");
	k.iconSize=new VSize(11,11);
	var h=new VMarkerOptions(k,null,new VSize(5,5));
	h.offset=new VSize(5,5);
	if(mkP!=null){
		map.removeOverlay(mkP);
		mkP=null
	}
	mkP=new VMarker(m,h);
	map.addOverlay(mkP);
	var l=new VInfoWindowOptions();
	l.offset=new VSize(0,5);
	mkP.openInfoWindow(j,l);
	if(currentElement!=null){
		$(currentElement).removeClass("StepList-active")
	}
	$(c).addClass("StepList-active");
	currentElement=c
	}
	}///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
var isPlayStep=false;
function PlayStep(a,b){
	isPlayStep=true;
	ShowStep(a,b,true)
}
function StopStep(c,d){
	isPlayStep=false;
	var e=document.getElementById("dirPrev");
	e.className="dirPrevAvai";
	e.onclick=function(){ShowStep(c,d-1)};
	var b=document.getElementById("dirNext");
	b.className="dirNextAvai";
	b.onclick=function(){ShowStep(c,d+1)};
	var a=document.getElementById("dirPlay");
	a.className="dirPlayStepAvai";
	a.onclick=function(){PlayStep(c,d)}
}
function ShowStep(b,c,d){
	if(c==0){
		b--;
		if(b<0){
			return
		}
		c=$("li","#guide"+b).length
	}else{
		var e=$("li","#guide"+b).length;
		if(c>e){
			b++;
			c=1
		}
	}
	var a=$("li","#guide"+b)[c-1];
	if(a!=undefined&&a.id.indexOf("_")>0){
		GetRoadFromShortestPath(a)
	}else{
		StopStep();
		return
	}if(d){
		setTimeout(function(){if(isPlayStep){c++;PlayStep(b,c)}},3500)
	}
}
function SearchNearByPolylineExt(j,f,h,c,g){
	ping_connection();
	var d=null;
	var b="";
	SetSearchType(0);
	ChangeFunctionType(GLOBAL_SEARCH_FUNCTION);
	showBusyDiv("","searchresult_div");
	if(j==null){
		if(currentStep!=null){
			if(currentStep.parentNode==null){
				return
			}
			var a=currentStep.parentNode.parentNode.parentNode.id;
			d=parseInt(a.substring(5,a.length));
			if(d==null){
				d=PlaceToFindPathArray.length
			}
			b="o?n du?ng "+GetNodeName(d)
		}else{
			b=SearchWhere;
			if(b.toLowerCase().indexOf("do?n du?ng ")==0||b.toLowerCase().indexOf("doan duong ")==0){
				b=b.substring(11);
				b=b.replace(/^\s+|\s+$/g,"");
				d=GetSectionId(b.substring(0,1));
				if(d==null){
					d=PlaceToFindPathArray.length
				}
				b="o?n du?ng "+b}
			}
			}else{
				d=j
			}
			PathSectionID=d;
			if(d>=PlaceToFindPathArray.length-1){
				hideBusyDiv();
				if(nLanguage==0){
					alert("Khng t?n t?i do?n du?ng b?n yu c?u")
					}
				else{
					alert("Road is not exist")
				}
				ClearPathResult();
				return
			}
			if(f!=null){
				if(document.getElementById("shortestpathsearchnearby")!=null){
					document.getElementById("shortestpathsearchnearby").value=f
				}
			}else{
				if(f==null){
					f=document.getElementById("shortestpathsearchnearby").value;
					h=""
				}
			}
			if(g==null){
				g=document.getElementById("shortestpathsearchnearby_radius").value;
				if(isNaN(g)){
					g=100
				}
			}
			f=f.replace(/\[quote]/g,'"');
			FillQueryToTextBox(f+" trn do?n du?ng "+GetNodeName(d));
			document.getElementById("mapinput").value=f+" trn do?n du?ng "+GetNodeName(d);
			if(b==""){
				b=SearchWhere
			}
			b=b.toLowerCase().replace("doan duong","do?n du?ng");
			var e=b.substring(11).toLowerCase();
			b=b.substring(0,11)+" "+e;
			b=b.replace(/^\s+|\s+$/g,"");
			isSearching=true;
			AJLocationSearch.SearchNearByPolyline(ClientID,GetPolylineOrder(d),PlaceToFindPathArray[d].length,f,h,b,c,g,                 SearchNearByPolylineChange)
		}
function SearchNearByPolylineChange(h){
	isSearching=false;if(h.error!=null){return}hideBusyDiv();map.closeInfoWindow();currentStep=null;dsResultData=h.value;var a=new Array();if((null!=dsResultData)&&("object"==typeof(dsResultData))){var q=dsResultData.Tables[0].Rows.length;var s=dsResultData.Tables[1].Rows[0].HitSize;var f=dsResultData.Tables[1].Rows[0].Key;var u=parseInt((s+PAGE_ROWS-1)/PAGE_ROWS);var j=10;u=(u>j)?j:u;var b=u>PAGE_SHOW?PAGE_SHOW:u;var m=dsResultData.Tables[1].Rows[0].PageIdx;var c=dsResultData.Tables[1].Rows[0].Lx;var p=dsResultData.Tables[1].Rows[0].Ly;var t=dsResultData.Tables[1].Rows[0].Rx;var g=dsResultData.Tables[1].Rows[0].Ry;var d=dsResultData.Tables[1].Rows[0].SearchType;var e=dsResultData.Tables[1].Rows[0].SuggestedKey;var k=dsResultData.Tables[1].Rows[0].Radius;var n=dsResultData.Tables[1].Rows[0].What;var l=dsResultData.Tables[1].Rows[0].Where;var r=(m-1)*PAGE_ROWS+1;var o=r+PAGE_ROWS-1>s?s:r+PAGE_ROWS-1;a[a.length]='<table id=TablePlace width=100% border=0 cellspacing=0 cellpadding=0 style="overflow:auto;">';var v="<b>"+f+"</b> trn <b>"+l+"</b> trong ph?m vi <b>"+k+"(m)</b>";a[a.length]=Global.GetResultText(v,v,"",e,s,dsResultData.Tables[1].Rows[0].IsLonLat,dsResultData.Tables[1].Rows[0].IsAddress,r,o);KeySearch=f;if(m+1<=u&&isFirstSearch){TypeSearch=7;setTimeout(function(){isBindingMorePlace=true;AJLocationSearch.SearchNearByPolyline(ClientID,GetPolylineOrder(PathSectionID),PlaceToFindPathArray[PathSectionID].length,f,n,l,1,k,MorePlaceBinding)},1000)}ClearSearchMapResult();HideSelectPlaceBox();a[a.length]=BindResult(dsResultData.Tables[0]);a[a.length]="</table>";a[a.length]=Global.GetComplainLink(KeySearch);a[a.length]=Global.BuildPaging(m,u,s,b,Global.PagingSearchNearByPolylineExt,new Array(null,f,n,k));document.getElementById("searchresult_div").innerHTML=a.join("");document.getElementById("searchresult_div").scrollTop=0;if(s>0){map.fitMultiOverlays(arrSearchMapResult)}LoadPlaceTool()}}
	
function SearchNearByPointExt(j,d,a,b,f,h,c,g){ping_connection();var e=false;if(dsResultData!=null&&dsResultData.Tables.length>1){e=dsResultData.Tables[1].Rows[0].IsAddress}SetSearchType(0);ChangeFunctionType(GLOBAL_SEARCH_FUNCTION);showBusyDiv("","searchresult_div");if(f!=null){if(document.getElementById("searchnearbypoint")!=null){document.getElementById("searchnearbypoint").value=f}}else{if(f==null){f=document.getElementById("searchnearbypoint").value}}if(g!=null){if(document.getElementById("searchnearbypoint_radius")!=null){document.getElementById("searchnearbypoint_radius").value=g}}else{if(g==null){g=document.getElementById("searchnearbypoint_radius").value}}if(isNaN(g)){g=2000}j=RemoveHTMLTag(j);f=f.replace(/\[quote]/g,'"');document.getElementById("mapinput").value=f+" g?n "+j+((d!="")?", "+d:"");isSearching=true;AJLocationSearch.SearchNearByPoint(f,h,j,d,a,b,g,c,SearchNearByPointChange)}

function SearchNearByPointChange(m){isSearching=false;if(m.error!=null){return}hideBusyDiv();map.closeInfoWindow();dsResultData=m.value;var a=new Array();if((null!=dsResultData)&&("object"==typeof(dsResultData))){var u=dsResultData.Tables[0].Rows.length;var x=dsResultData.Tables[1].Rows[0].HitSize;var j=dsResultData.Tables[1].Rows[0].Key;var B=parseInt((x+PAGE_ROWS-1)/PAGE_ROWS);var n=10;B=(B>n)?n:B;var b=B>PAGE_SHOW?PAGE_SHOW:B;var q=dsResultData.Tables[1].Rows[0].PageIdx;var d=dsResultData.Tables[1].Rows[0].Lx;var t=dsResultData.Tables[1].Rows[0].Ly;var A=dsResultData.Tables[1].Rows[0].Rx;var l=dsResultData.Tables[1].Rows[0].Ry;var g=dsResultData.Tables[1].Rows[0].SearchType;var h=dsResultData.Tables[1].Rows[0].SuggestedKey;var v=dsResultData.Tables[0].Rows[u-1].Name;var s=dsResultData.Tables[0].Rows[u-1].Address;var e=dsResultData.Tables[0].Rows[u-1].Longitude+"";var y=dsResultData.Tables[0].Rows[u-1].Latitude+"";var o=dsResultData.Tables[1].Rows[0].Radius;var w;if(s!=""){w=v+", "+s}else{w=v}var r=dsResultData.Tables[1].Rows[0].What;var f=(q-1)*PAGE_ROWS+1;var p=f+PAGE_ROWS-1>x?x:f+PAGE_ROWS-1;a[a.length]='<table id=TablePlace width=100% border=0 cellspacing=0 cellpadding=0 style="overflow:auto;">';var E="<b>"+j+"</b> ? g?n <b>"+w+"</b> trong ph?m vi <b>"+o+"(m)</b>";a[a.length]=Global.GetResultText(E,E,"",h,x,dsResultData.Tables[1].Rows[0].IsLonLat,dsResultData.Tables[1].Rows[0].IsAddress,f,p);var z;var c;var C;var k;var D=0;KeySearch=j;if(q+1<=B&&isFirstSearch){TypeSearch=6;setTimeout(function(){isBindingMorePlace=true;AJLocationSearch.FindMoreNearByPoint(j,r,v,s,e,y,o,1,MorePlaceBinding)},1000)}ClearSearchMapResult();HideSelectPlaceBox();a[a.length]=BindResult(dsResultData.Tables[0]);a[a.length]="</table>";a[a.length]=Global.GetComplainLink(KeySearch);a[a.length]=Global.BuildPaging(q,B,x,b,Global.PagingSearchNearByPointExt,new Array(v,s,e+"",y+"",j,r,o));document.getElementById("searchresult_div").innerHTML=a.join("");document.getElementById("searchresult_div").scrollTop=0;if(x>0){map.fitMultiOverlays(arrSearchMapResult)}LoadPlaceTool()}}

function GetNodeName(a){switch(a){case 0:return"A->B";break;case 1:return"B->C";break;case 2:return"C->D";break;case 3:return"D->E";break;case 4:return"E->F";break;case 5:return"F->G";break;case 6:return"G->H";break;case 7:return"H->I";break;case 8:return"I->J";break;case 9:return"J->K";break;case 10:return"K->L";break;case 11:return"L->M";break;case 12:return"M->N";break;case 13:return"N->O";break;case 14:return"O->P";break;case 15:return"P->Q";break;case 16:return"Q->R";break;case 17:return"R->S";break;case 18:return"S->T";break;case 19:return"T->U";break;case 20:return"U->V";break;case 21:return"V->W";break;case 22:return"W->X";break;case 23:return"X->Y";break;case 24:return"Y->Z";break}}

function GetSectionId(a){if(a==null){return}switch(a.toUpperCase()){case"A":return 0;break;case"B":return 1;break;case"C":return 2;break;case"D":return 3;break;case"E":return 4;break;case"F":return 5;break;case"G":return 6;break;case"H":return 7;break;case"I":return 8;break;case"J":return 9;break;case"K":return 10;break;case"L":return 11;break;case"M":return 12;break;case"N":return 13;break;case"O":return 14;break;case"P":return 15;break;case"Q":return 16;break;case"R":return 17;break;case"S":return 18;break;case"T":return 19;break;case"U":return 20;break;case"V":return 21;break;case"W":return 22;break;case"X":return 23;break;case"Y":return 24;break;case"Z":return 25;break}}

function SearchNearByPolylineEnter(b,c,d){var a;if(document.all){a=event.keyCode}else{a=b.keyCode}if(a==13){isFirstSearch=true;SearchNearByPolylineExt(c,null,null,1,null);return false}return true}

function SearchNearByPointEnter(a,h,d,c,b,f,g){var j;if(document.all){j=event.keyCode}else{j=a.keyCode}if(j==13){isFirstSearch=true;centerObjectNearby=centerObjectNearbyTemp;SearchNearByPointExt(h,d,c,b,f,"",1,g);return false}return true}

function ShowSearchNearByShortestPath(d){var a=d.parentNode.parentNode.id;var c=parseInt(a.substring(5,a.length));var b='<div class="MiniPopup">';if(nLanguage==0){b+='<span class="Title">Tm d?ch v? trn du?ng di</span> <ol class="SearchNearBy"> <li><span class="ServiceTit">Vd: khch s?n</span><span class="RadiusTit">Bn knh (m)</span></li> <li> <input id="shortestpathsearchnearby" class="ServiceInput" onkeydown="return SearchNearByPolylineEnter(event,'+c+')" type="text"/> <input id="shortestpathsearchnearby_radius" class="RadiusInput" value="100" onkeydown="return SearchNearByPolylineEnter(event,'+c+')" type="text"/> <a class="backbtn" onclick="SearchNearByPolylineExt('+c+',null,null,1,null)"><span>Tm</span></a> </li> </ol>'}else{b+='<span class="Title">Find business on road</span> <ol class="SearchNearBy"> <li><span class="ServiceTit">Eg: Hotel</span><span class="RadiusTit">Radius (m)</span></li> <li> <input id="shortestpathsearchnearby" class="ServiceInput" onkeydown="return SearchNearByPolylineEnter(event,'+c+')" type="text"/> <input id="shortestpathsearchnearby_radius" class="RadiusInput" value="100" onkeydown="return SearchNearByPolylineEnter(event,'+c+')" type="text"/> <a class="backbtn" onclick="SearchNearByPolylineExt('+c+',null,null,1,null)"><span>Search</span></a> </li> </ol>'}b+="</div>";if(c>=0){var e=PathPolylineArray[c][0].getVertex(0);currentStep=d;map.openInfoWindow(e,b);setTimeout(function(){if(document.getElementById("shortestpathsearchnearby")!=null){document.getElementById("shortestpathsearchnearby").focus()}},500)}}var isFindReverse=false;

function FindReverseDirection(){if(PlaceToFindPathArray.length!=2){return}isFindReverse=true;var f=$("input","#direction0").val();var d=$("input","#direction1").val();var c=PlaceToFindPathArray[0][0].getLatLng();var e=PlaceToFindPathArray[1][0].getLatLng();ClearPathResult();AddPlaceFromFind(e,d);AddPlaceToFind(c,f)}

function GetTotalDistance(){var d=(nLanguage==0)?"T?ng chi?u di: ":"Total length: ";$("#FindPathStatus").html("");var c=0;for(var a=0;a<PlaceToFindPathArray.length-1;a++){var b=RemoveHTMLTag($(".summary","#guide"+a).html());if(nLanguage==0){b=b.substring(b.indexOf("Chi?u di: ")+11,b.indexOf("m"))}else{b=b.substring(b.indexOf("Length: ")+8,b.indexOf("m"))}if(b.indexOf("k")>-1){c+=parseFloat(b.substring(0,b.length-1))*1000}else{c+=parseFloat(b.substring(0,b.length))}}if(c!=0){if(c>1000){$("#FindPathStatus").html(d+'<b style="color:#333;">'+parseFloat(parseInt(c)/1000)+"</b> km")}else{$("#FindPathStatus").html(d+'<b style="color:#333;">'+parseFloat(c)+"</b> m")}}else{$("#FindPathStatus").html("")}}
function clearArrows(){if(arrArrows.length>0){for(i=0;i<arrArrows.length;i++){map.removeOverlay(arrArrows[i])}arrArrows=new Array()}}
		
function OnforcusTextBoxAB(a){
			a=$(a);
			if(a.val()==inputDirHelp){
				a.val("")
			}
			HideSelectPlaceBox();
			prev_selectedResAB_Text=selectedResAB_Text=a.val()
			}
function OnblurTextBoxAB(a){
	a=$(a);
	var b=a.parent().parent()[0].id;
	var c=parseInt(b.substring(9,b.length));
	if(a.val()==""){
		a.val(inputDirHelp)
	}
}
var g_Index;
var g_Value;
var g_CurPageAB;
function SearchPlace(d,b,a){
	ping_connection();
	if(isSearching==true){
		return
	}
	g_Index=d;
	g_Value=b;
	current_index=d;
	if(b!=null&&b.length>0){
		ShowSelectPlaceBox();
		showBusyDiv("","SelectPlaceContent");
		isSearching=true;var e=map.getBounds();
		var c=GLOBAL_SEARCH_ALL;
		AJLocationSearch.SearchResult(b,"","",a,map.getLevel(),e.getNorthWest().lng(),e.getNorthWest().lat(),e.getSouthEast().lng(),e.getSouthEast().lat(),c,PathBinding)
	}
	return false
}
function PathBinding(j){isSearching=false;hideBusyDiv();var l=j.value;var a=new Array();if((null!=l)&&("object"==typeof(l))){var r=l.Tables[0].Rows.length;var u=l.Tables[1].Rows[0].HitSize;var t=l.Tables[1].Rows[0].IsAddress;var g=l.Tables[1].Rows[0].SuggestedKey;var h=l.Tables[1].Rows[0].Key;var s=l.Tables[1].Rows[0].IsLonLat;var f=h.indexOf("|");var A,B;if(f>=0){A=h.substring(0,f);A=Global.TrimSpace(A);B=h.substring(f+1);B=Global.TrimSpace(B)}var x=parseInt((u+PAGE_ROWS-1)/PAGE_ROWS);var k=10;x=(x>k)?k:x;var c=x>PAGE_SHOW?PAGE_SHOW:x;var o=l.Tables[1].Rows[0].PageIdx;searchType=l.Tables[1].Rows[0].SearchType;var g=l.Tables[1].Rows[0].SuggestedKey;var e=(o-1)*PAGE_ROWS+1;var m=e+PAGE_ROWS-1>u?u:e+PAGE_ROWS-1;if(u==1){var v=l.Tables[0].Rows[0].Address;var w=l.Tables[0].Rows[0].Name;var z=l.Tables[0].Rows[0].Latitude;var d=l.Tables[0].Rows[0].Longitude;var b=z;var n=d;var q=w;if(v!=""){q=w+", "+v}if(t){q=v+((v!="")?", ":"")+w}changeContentFlag=true;AddPlaceAB(current_index,z,d,q);if(PlaceToFindPathArray.length==1){map.setCenter(new VLatLng(b,n),map.getLevel())}return}a[a.length]='<div id="TablePlace">';a[a.length]=Global.GetResultText(h,"<b>"+A+"</b>",B,g,u,l.Tables[1].Rows[0].IsLonLat,l.Tables[1].Rows[0].IsAddress,e,m,g_Index);for(var y=0;y<r;y++){var v=l.Tables[0].Rows[y].Address;var w=l.Tables[0].Rows[y].Name;var p=l.Tables[0].Rows[y].Tel;var z=l.Tables[0].Rows[y].Latitude;var d=l.Tables[0].Rows[y].Longitude;var q=GetLocationFullName(l.Tables[0].Rows[y]);a[a.length]='<div class="resultItem SPresultItem" onmouseover="ResultEntryPlaceABMouseOver(this)" onmouseout="ResultEntryPlaceABMouseOut(this)" onclick="AddPlaceAB('+current_index+","+z+","+d+",'"+q+'\')"> <span class="icon1-10">'+((l.Tables[1].Rows[0].PageIdx-1)*10+y+1)+'</span> <a class="resultTitle SPresultTitle">'+w+'</a> <p><span class="address">'+v+'</span> <span class="phone">'+p+"</span></p> </div>"}var x=parseInt((u+PAGE_ROWS-1)/PAGE_ROWS);var k=10;x=(x>k)?k:x;var c=x>PAGE_SHOW?PAGE_SHOW:x;var o=l.Tables[1].Rows[0].PageIdx;a[a.length]=Global.BuildPaging(o,x,u,c,Global.PagingSearchPlaceForPath,new Array(g_Index,g_Value,o));a[a.length]="</div>";SetSelectPlaceBoxContent(a.join(""));$("#SelectPlaceContent")[0].scrollTop=0;$(".countPlace","#SelectPlace").addClass("SPcountPlace");$(".keyPlace","#SelectPlace").addClass("SPkeyPlace")}}

function AddPlaceAB(e,d,b,c){if(e==null){e=currentSelectedResAB_Id}if(d==null){d=currentSelectedResAB_Lat}if(b==null){b=currentSelectedResAB_Lng}if(c==null){c=currentSelectedResAB_Text}if(e==-1){HideSelectPlaceBox();return}c=RemoveHTMLTag(c);var a=PlaceToFindPathArray.length;if(e+1>=a){RemovePlace(e+",0");if(toFirstFlag==false){if(e==0){AddPlaceFromFind(new VLatLng(d,b),c)}else{AddPlaceToFind(new VLatLng(d,b),c)}}else{AddPlaceFromFind(new VLatLng(d,b),c)}}else{$("input","#direction"+e).val(c);PlaceToFindPathArray[e][0].setPoint(new VLatLng(d,b));FindShortestPath(e+",0",0,0,0)}changeContentFlag=false;HideSelectPlaceBox()}

function ShowSelectPlaceBox(){var c=$("#findpathtabdiv").height();var a=21;var b=$("#topLeftPathResult")[0].offsetHeight+$("#direction"+current_index)[0].offsetTop-$("#findpath_div")[0].scrollTop+110;if(b+$("#SelectPlace").height()-110>=c){b-=261;a=284;if(b<110){a=b+261-150+21;b=150}}$(".SelectPlaceArrow").css("top",a);$(".a-z, .TitFlag","#SelectPlace")[0].innerHTML=alphabet[current_index];$("#SelectPlace").show();$("#SelectPlace").css("top",b)}
function SetSelectPlaceBoxContent(a){ShowSelectPlaceBox();$("#SelectPlaceContent").html(a);$(".searchinwrap","#SelectPlaceContent").remove()}
	
function HideSelectPlaceBox(){
		$("#SelectPlace").css("display","none")
}
var arrListFavour=new Array();
function LoadFav(){var b=getCookie("VBDFav");if(b==null){return}arrListFavour=new Array();b=b.split("$$");for(var a=0;a<b.length;a++){if(b[a]==""){continue}var c=b[a].split("$");arrListFavour[arrListFavour.length]=new Array(c[0],c[1],c[2],c[3],c[4])}}

function AddFav(b){$("#pmarklocation").addClass("favToogle-Ena");for(var a=0;a<arrListFavour.length;a++){if(arrListFavour[a][1]==b.GUID){return}}arrListFavour[arrListFavour.length]=new Array(RemoveHTMLTag(b.Name),b.GUID,b.Latitude,b.Longitude,b.Table);SaveFavState();ShowFav()}

function DeleteFavByGuid(b){for(var a=0;a<arrListFavour.length;a++){if(arrListFavour[a][1]==b){DeleteFav(a);return}}}
function DeleteFav(a){if(confirm((nLanguage==0)?"B?n c th?t s? mu?n xa di?m ua thch ny?":"Are you sure you want to delete this favourite?")){$("#pmarklocation").removeClass("favToogle-Ena");arrListFavour[a][0]="";SaveFavState();ShowFav()}}

function SaveFavState(){var b="";for(var a=0;a<arrListFavour.length;a++){if(arrListFavour[a][0]!=""){b+=arrListFavour[a][0]+"$"+arrListFavour[a][1]+"$"+arrListFavour[a][2]+"$"+arrListFavour[a][3]+"$"+arrListFavour[a][4]+"$$"}}setCookie("VBDFav",b,5000,"","","")}

function ShowFav(){clearFavMarker();var a=FavHTML();if(a!=""){$("#MarkLocation_Cookie").html(a)}else{showFavHelp()}}
function showFavHelp(){$("#MarkLocation_Cookie").html(FavHelppHTML)}

function clearFavMarker(){for(var a=0;a<arrFavPlace.length;a++){map.removeOverlay(arrFavPlace[a])}arrFavPlace=new Array()}

function FavHTML(){LoadFav();var c="";for(var a=0;a<arrListFavour.length;a++){if(arrListFavour[a][0]==""){continue}var b={Name:arrListFavour[a][0],GUID:arrListFavour[a][1],Latitude:arrListFavour[a][2],Longitude:arrListFavour[a][3]};c+=BuildFavItem(b,a)}if(c!=""){c='<h3 class="mymaptitle">V? tr luu t?m th?i</h3>'+c}return c}
function ShowFavInfo(a){ShowLocationInfo(arrFavPlace[a],arrFavPlace[a].GUID,"fav")}
function BuildFavItem(c,g){var a='<div id="favItem_%Number%" class="resultItem"> %Icon%<span id="favTitle_%Number%" onclick="ShowFavInfo(%Number%)">%Title%</span> <a onclick="DeleteFav(%Number%)" class="MyMapDel">Xa</a> <div class="Spacer"></div> </div>';var d=ToSafeHTML(c.Name);var h='<span class="fav1-10">'+(g+1)+"</span>";var e=new VIcon("./images/mymap_icon/favonmap.png",new VSize(19,15));var f=new VMarkerOptions(e);f.offset=new VSize(8,15);f.zIndexProcess=function(){return 5};var b=new VMarker(new VLatLng(c.Latitude,c.Longitude),f);b.GUID=c.GUID;b.order=g;map.addOverlay(b);arrFavPlace.push(b);VEvent.addListener(b,"click",function(){ShowLocationInfo(b,b.GUID,"fav")});a=a.replace(/%Number%/g,g);a=a.replace(/%Icon%/g,h);a=a.replace(/%Order%/g,g);a=a.replace(/%Title%/g,'<a class="resultTitle">'+d+"</a>");return a}var bCreateNewMMObj=false;var bEditMMObj=false;var bReadOnly=true;var bHaveDeletedMM=-1;var bSendMyMap=false;var bWaitingCreateNewMap=false;var bDrawingPolyline=false;var arrDrawingPts=null;var nDrawingPts=0;var tempPolyline=null;var dsMyMap=null;var dsMyMapCoor=null;var iMyMapOpening=-1;var iMyMapCoorSel=-1;var iMyMapCoorOver=-1;var arrMyMapCoorObj=new Array();var nMyMapCoorObj=0;var arrControlPoint=new Array();var nControlPoint=0;var arrAPControlPoint=new Array();var nAPControlPoint=0;var bCPDragging=false;var clickedPoint=null;var selTbrButton=null;var curTitle="";var curDesc="";var curIcon="";var curText="";var curFontFamily="";var curFontWeight="";var curFontSize="";var curFontColor="";var curLineColor="";var curLineWidth="";var curLineOpacity="";var curFillColor="";var curFillOpacity="";var curColElX=0;var curColElY=0;var Ds_MyMapProperty=null;var colorArr=new Array(new Array("#ff8080","#ffff80","#80ff80","#00ff80","#80ffff","#0080ff","#ff80c0","#ff80ff"),new Array("#ff0000","#ffff00","#80ff00","#00ff40","#00ffff","#0080c0","#8080c0","#ff00ff"),new Array("#804040","#ff8040","#00ff00","#008080","#004080","#8080ff","#800040","#ff0080"),new Array("#800000","#ff8000","#008000","#008040","#0000ff","#0000a0","#800080","#8000ff"),new Array("#400000","#804000","#004000","#004040","#000080","#000040","#400040","#400080"),new Array("#000000","#808000","#808040","#808080","#408080","#c0c0c0","#400040","#ffffff"));var iconArr=new Array("point-1.gif","point-2.gif","point-3.gif","point-4.gif","star-1.gif","heart_1.gif","heart_2.gif","taxi.gif","bus-1.gif","bus-2.gif","train.gif","airplane.gif","port.gif","bicyle.png","food-1.gif","drink.png","beer.png","ice-cream.png","food-4.gif","food.png","birthday-cake.png","toast-done.png","college.gif","school.gif","book.gif","snare.png","media_3.gif","media_4.gif","webcam.png","headphone.png","hospital.gif","factory.gif","hotel.gif","bank.gif","ATM.png","umbrella.gif","park.gif","pagoda.png","church.png","light.gif","shopping.gif","bag.gif","petro.gif","home.gif","trambomnuoc.png","fire-engine.png","danphong.png","police.png","radar.png","bomb.gif","radioactive.png","skull.png","virussafe.png","tooth.png","stethoscope.png","pills.png","toilet-paper.png","broom.png","cabinet.png","magic.png","lifebuoy.png","veston.png");var MMListTempl='<div id="MyMapList_%Order%" class="MyMapList" onclick="loadMyMapCoor(%Order%)"> <div class="MyMapListLeft"> <span class="MapListIcon">%ListOrder%</span> <a id="MyMapListTitle_%Order%" class="MapListTitle">%Title%</span></a> <p id="MyMapListDesc_%Order%"> <span class="Info">%Des%</span> </p> </div> <a class="MyMapDel" onclick="deleteMyMap(%Order%)">Xa</a> </div>';var MMCoorTempl='<li id="MyMapCoorList_%Order%"> <div id="MyMapCoorListIcon_%Order%"" class="MyMapCoorListImage" style="background: url(%Icon%) no-repeat 0 center;"> <div class="MMCoorLeft"> <a class="listpinstit" onclick="clickedPoint=null;showMyMapInfoWindow(%Order%, 0)">%Name%</a> <span class="listpinsinfo">%Des%</span> </div> </div> <a class="MyMapDel" onclick="deleteMyMapCoor(%Order%)">Xa</a> </li>';var BUDDY_TAB=1;var FAVOURITE_TAB=2;var CREATEBYME_TAB=3;

function LoadMyMapToolBar(a){if(bSendMyMap&&a!="ViewItem"){return}$("#createNewMap").hide();$("#btnCancelMyMap").hide()[0].onclick=function(){};$("#btnEditMyMap").hide();$("#btnSaveMyMap").hide();$("#btnTrashMyMap").hide()[0].onclick=function(){};switch(a){case"ViewList":$("#createNewMap").show();$("#MyMapInfo").html("");$(".listpins").html("");break;case"ViewItem":if(!bSendMyMap){$("#btnCancelMyMap").show()[0].onclick=function(){closeMyMap()};$("#btnEditMyMap").show();$("#btnTrashMyMap").show()[0].onclick=function(){deleteMyMap(iMyMapOpening)}}$("#MyMapToolbar").hide();$(".ToolbarExplain").hide();$(".MyMapDel","#MyMapCoorList").hide();break;case"EditItem":$("#btnCancelMyMap").show()[0].onclick=function(){cancelEditMyMap()};$("#btnSaveMyMap").show();$("#btnTrashMyMap").show()[0].onclick=function(){deleteMyMap(iMyMapOpening)};$("#MyMapToolbar").show();$(".ToolbarExplain").show();$(".ToolbarExplain").html("Thay d?i v? tr cc d?i tu?ng");$(".MyMapDel","#MyMapCoorList").show();disableSaveBtn();break;default:}}

function createNewMap(){ArrEditProperty=new Array();ArrDeleteProperty=new Array();flagEditProperty=false;ArrPropertyAsLoad=new Array();Ds_MyMapProperty=null;if(bEditMMObj&&iMyMapOpening!=-1&&checkLogin()){if(confirm(((nLanguage==0)?"B?n c mu?n luu l?i b?n d? c?a b?n khng?":"Do you want to save your map?"))){bWaitingCreateNewMap=true;saveMyMap()}else{fnCreateNewMap()}}else{fnCreateNewMap()}}var bjustcreate=false;

function fnCreateNewMap(){if(!MembershipRequire()){return}bEditMMObj=false;bReadOnly=false;bjustcreate=true;$("#MyMapList").hide();$("#MyMapArea").show();showBusyDiv("ang t?o b?n d? m?i","mymap_div");var a=new Object();a.MyMapID="";a.UserID="";a.Title="Chua d?t tn";a.Description="";a.MapID="vietnam";a.ZoomLevel=map.getLevel();var b=map.getCenter();a.LastPosX=b.lng();a.LastPosY=b.lat();dsMyMap.Tables[0].Rows[dsMyMap.Tables[0].Rows.length]=a;iMyMapOpening=(dsMyMap.Tables[0].Rows.length-1);var c=map.getLevel()+"!"+b.lng()+"!"+b.lat();AJLocationSearch.CreateNewMap(c,createNewMapCallback);if(dsMyMapCoor==null){dsMyMapCoor=new Object();dsMyMapCoor.Tables=new Array();dsMyMapCoor.Tables[0]=new Object();dsMyMapCoor.Tables[0].Rows=new Array()}editMyMap()}

function createNewMapCallback(b){hideBusyDiv();if(b.error!=null){ReportError();return}var a=b.value.split("!");dsMyMap.Tables[0].Rows[iMyMapOpening].MyMapID=a[0];dsMyMap.Tables[0].Rows[iMyMapOpening].UserID=a[1]}

function createMyMapCoor(e,d,b,c){var a=MMCoorTempl.replace(/%Order%/g,e);a=a.replace(/%Icon%/g,d);a=a.replace(/%Name%/g,b);a=a.replace(/%Des%/g,c);$(".listpins","#MyMapCoorList").append(a)}

function deleteMyMap(b){bHaveDeletedMM=b;if(confirm((nLanguage==0)?"B?n c th?t s? mu?n xa b?n d? ny?":"Are you sure to delete this map?")){var a=dsMyMap.Tables[0].Rows[b].MyMapID;AJLocationSearch.DeleteMyMap(a);loadMyMap()}}

function deleteMyMapCoor(a){if(confirm((nLanguage==0)?"B?n c th?t s? mu?n xa d?i tu?ng ny?":"Are you sure to delete this object?")){if(arrMyMapCoorObj[a].actionType=="New"){arrMyMapCoorObj[a].actionType="NoAction"}else{arrMyMapCoorObj[a].actionType="Delete"}clearControlPoint();map.removeOverlay(arrMyMapCoorObj[a]);$("#"+("MyMapCoorList_"+a)).remove();iMyMapCoorSel=-1;enableSaveBtn();map.closeInfoWindow()}}

function loadMyMap(){if(!checkLogin()){return}$("#MyMapList").show();$("#MyMapArea").hide();clearControlPoint();map.closeInfoWindow();iMyMapCoorOver=-1;iMyMapCoorSel=-1;iMyMapOpening=-1;for(var a=0;a<nMyMapCoorObj;a++){if(arrMyMapCoorObj[a].actionType!="Delete"){map.removeOverlay(arrMyMapCoorObj[a])}}arrMyMapCoorObj=new Array();nMyMapCoorObj=0;dsMyMapCoor=null;if(nLanguage==0){showBusyDiv("ang t?i b?n d?","mymap_div")}else{showBusyDiv("Map loading","mymap_div")}ArrEditProperty=new Array();ArrDeleteProperty=new Array();flagEditProperty=false;ArrPropertyAsLoad=new Array();AJLocationSearch.GetAllMyMap(loadMyMapCallback)}

function loadMyMapCallback(d){hideBusyDiv();if(d.error!=null){ReportError();return}dsMyMap=d.value;var b=-1;if(dsMyMap!=null&&dsMyMap.Tables[0].Rows.length>0){$("#MyMapList").html("<h3 class='mymaptitle'>Danh sch cc b?n d?</h3>");for(var a=0;a<dsMyMap.Tables[0].Rows.length;a++){if(dsMyMap.Tables[0].Rows[a].MyMapID==bSendMyMap){b=a;bSendMyMap=false}var c=MMListTempl.replace(/%Order%/g,a);c=c.replace(/%ListOrder%/g,a+1);c=c.replace(/%Title%/g,dsMyMap.Tables[0].Rows[a].Title);c=c.replace(/%Des%/g,dsMyMap.Tables[0].Rows[a].Description);$("#MyMapList").append(c)}}else{showMyMapHelp()}if(bSendMyMap==false){loadMyMapCoor(b)}else{loadMyMapCoor(bSendMyMap);bSendMyMap=true}LoadMyMapToolBar("ViewList")}

function showMyMapHelp(){$("#MyMapList").html(MymapHelpHTML)}
function hideMyMapHelp(){$("#MyMapList").html("")}
function loadMyMapCoor(a){if(a==-1){return}if(bSendMyMap){showBusyDiv("ang n?p b?n d?","mymap_div");AJLocationSearch.GetAllMyCoorML(a,loadMyMapCoorCallback)}else{if(bHaveDeletedMM==a){bHaveDeletedMM=-1;return}bHaveDeletedMM=-1;iMyMapOpening=a;showBusyDiv("ang n?p b?n d?","mymap_div");$("#MyMapInfo").html("");$(".listpins").html("");AJLocationSearch.GetAllMyCoor(dsMyMap.Tables[0].Rows[iMyMapOpening].MyMapID,loadMyMapCoorCallback)}}

function loadMyMapCoorCallback(a){hideBusyDiv();if(a.error!=null){ReportError();return}bReadOnly=true;fnLoadMyMapCoor(a)}
function fnLoadMyMapCoor(a){$("#MyMapList").hide();$("#MyMapArea").show();$("#MyMapList").html("");dsMyMapCoor=a.value;if(dsMyMapCoor!=null){if(bSendMyMap){$("#InforOfMyMap").hide()}else{$("#InforOfMyMap").show();map.setCenter(new VLatLng(dsMyMap.Tables[0].Rows[iMyMapOpening].LastPosY,dsMyMap.Tables[0].Rows[iMyMapOpening].LastPosX),dsMyMap.Tables[0].Rows[iMyMapOpening].ZoomLevel);BindMyMapInfo(dsMyMap.Tables[0].Rows[iMyMapOpening])}for(var f=0;f<dsMyMapCoor.Tables[0].Rows.length;f++){var g=(dsMyMapCoor.Tables[0].Rows[f].Style).toString().split(";");var d=dsMyMapCoor.Tables[0].Rows[f].Coor;var b="";if(d.indexOf("POINT")>=0){e=NormalizeGeo(d,"POINT");if(g.length>=6&&g[5].length>0){b="images/icon_text.gif";var c=new VTextStyle(parseInt(g[2]),g[0],g[1],g[3]);createMMText(e,g[5],c)}else{b="images/MyMap_icon/"+g[4];createMMMarker(e,new VIcon(b,new VSize(32,32)))}}else{if(d.indexOf("LINESTRING")>=0){b="images/icon_polyline.gif";var e=NormalizeGeo(d,"LINESTRING");createMMPolyline(e,g[1],parseFloat(g[0]),g[2],parseFloat(g[3]))}else{if(d.indexOf("POLYGON")>=0){b="images/icon_polygon.gif";var e=NormalizeGeo(d,"POLYGON");var h=(g[4]=="")?0.5:g[4];createMMPolygon(e,g[1],parseFloat(g[0]),g[2],h,parseFloat(g[3]))}}}createMyMapCoor(f,b,dsMyMapCoor.Tables[0].Rows[f].ObjectTitle,dsMyMapCoor.Tables[0].Rows[f].ObjectDesc)}}map.fitOverlays();LoadMyMapToolBar("ViewItem")}

function createMMText(c,a,b){var a=new VText(c,a,b);a.type=MYMAPOBJ;a.mmIndex=nMyMapCoorObj;a.actionType="NoAction";map.addOverlay(a);arrMyMapCoorObj[nMyMapCoorObj]=a;nMyMapCoorObj++;VEvent.addListener(a,"dragend",function(d){if(d.actionType!="New"){d.actionType="Edit"}enableSaveBtn()})}

function createMMMarker(a,c){var b=new VMarker(a,c);b.type=MYMAPOBJ;b.mmIndex=nMyMapCoorObj;b.actionType="NoAction";map.addOverlay(b);arrMyMapCoorObj[nMyMapCoorObj]=b;nMyMapCoorObj++;VEvent.addListener(b,"dragend",function(d){if(d.actionType!="New"){d.actionType="Edit"}enableSaveBtn()})}

function createMMPolyline(f,c,d,e,b){var a=new VPolyline(f,c,d,e,b);a.type=MYMAPOBJ;a.mmIndex=nMyMapCoorObj;a.actionType="NoAction";map.addOverlay(a);arrMyMapCoorObj[nMyMapCoorObj]=a;nMyMapCoorObj++;VEvent.addListener(a,"mouseover",function(){showControlPoint(a)})}

function createMMPolygon(b,d,e,f,c,a){var g=new VPolygon(b,d,e,f,c,a);g.type=MYMAPOBJ;g.mmIndex=nMyMapCoorObj;g.actionType="NoAction";g.reductionTol=0;map.addOverlay(g);arrMyMapCoorObj[nMyMapCoorObj]=g;nMyMapCoorObj++;VEvent.addListener(g,"mouseover",function(){showControlPoint(g)})}

function disableSaveBtn(){var a=document.getElementById("btnSaveMyMap");if(a!=null){a.style.filter="alpha(opacity = 40)";a.style.opacity=0.4}bEditMMObj=false}

function enableSaveBtn(){var a=document.getElementById("btnSaveMyMap");if(a!=null){a.style.filter="";a.style.opacity=1}bEditMMObj=true}
function editMyMap(){bReadOnly=false;map.closeInfoWindow();LoadMyMapToolBar("EditItem");var a='<ol class="inputinfo"> <li> <span class="NameTit input">Tn</span> <input id="txtMapTitle" onkeydown="enableSaveBtn()" type="text" value="'+dsMyMap.Tables[0].Rows[iMyMapOpening].Title+'"> </li> <li> <span class="InfoTit input">M t?</span> <textarea id="txtMapDesc" onkeydown="enableSaveBtn()">'+dsMyMap.Tables[0].Rows[iMyMapOpening].Description+"</textarea> </li> </ol>";a+='<span class="subinfo">Thng tin b? sung</span> <ol id="MyMapPropertyInfo" class="listsubinfo listsubinfoinput"> <li> <span class="Mname">Tn</span> <span class="Mvalue">Gi tr?</span> </li> </ol> <a class="addsubinfo" onclick="AddNewPropertyClick(\'MyMapPropertyInfo\',\'MyMapProInfoChild\')"><span>Thm</span></a>';$("#MyMapInfo").html(a);if(Ds_MyMapProperty!=null&&Ds_MyMapProperty.Tables[0].Rows.length>0){for(var b=0;b<Ds_MyMapProperty.Tables[0].Rows.length;b++){AddNewPropertyClick("MyMapPropertyInfo","MyMapProInfoChild",Ds_MyMapProperty.Tables[0].Rows[b].property_name,Ds_MyMapProperty.Tables[0].Rows[b].property_value)}}else{AddNewPropertyClick("MyMapPropertyInfo","MyMapProInfoChild")}disableSaveBtn();selectToolbarBtn(document.getElementById("btnMove"));for(var b=0;b<nMyMapCoorObj;b++){if(arrMyMapCoorObj[b].vType()=="VMarker"||arrMyMapCoorObj[b].vType()=="VText"){arrMyMapCoorObj[b].enableDragging()}}if(iMyMapCoorSel!=-1){clickedPoint=null;showMyMapInfoWindow(iMyMapCoorSel,0)}}

function cancelEditMyMap(){if(bEditMMObj){if(confirm(((nLanguage==0)?"B?n d? c?a b?n d thay d?i.\n\nB?n c mu?n luu l?i khng?":"Your map has changed.\n\nDo you want to save the changes?"))){saveMyMap()}}if(bjustcreate){bHaveDeletedMM=iMyMapOpening;AJLocationSearch.DeleteMyMap(dsMyMap.Tables[0].Rows[iMyMapOpening].MyMapID);loadMyMap();return}bReadOnly=true;selectToolbarBtn($("#btnMove")[0]);selTbrButton=null;map.closeInfoWindow();clearControlPoint();BindMyMapInfo(dsMyMap.Tables[0].Rows[iMyMapOpening]);for(var a=0;a<nMyMapCoorObj;a++){if(arrMyMapCoorObj[a].vType()=="VMarker"||arrMyMapCoorObj[a].vType()=="VText"){arrMyMapCoorObj[a].disableDragging()}}if(iMyMapCoorSel!=-1){clickedPoint=null;showMyMapInfoWindow(iMyMapCoorSel,0)}LoadMyMapToolBar("ViewItem")}

function BindMyMapInfo(c){var a='<ol class="info"> <li class="li-1"> <span class="NameTit">Tn</span> <span class="Name">'+c.Title+'</span> </li> <li> <span class="InfoTit">M t?</span> <span class="Info">'+c.Description+"</span> </li> </ol>";Ds_MyMapProperty=AJLocationSearch.GetMyMapProperty(c.MyMapID).value;if(Ds_MyMapProperty!=null&&Ds_MyMapProperty.Tables[0].Rows.length>0){a+='<span class="subinfo">Thng tin b? sung</span> <ol class="listsubinfo">';for(var b=0;b<Ds_MyMapProperty.Tables[0].Rows.length;b++){a+='<li> <span class="name">'+Ds_MyMapProperty.Tables[0].Rows[b].property_name+':</span> <span class="value">'+Ds_MyMapProperty.Tables[0].Rows[b].property_value+"</span> </li>"}a+="</ol>"}$("#MyMapInfo").html(a)}var ArrEditProperty=new Array();var ArrDeleteProperty=new Array();

function saveMyMap(){if(!bEditMMObj){return}bjustcreate=false;var k=new Array();var D=new Array();var l=new Array();var x=new Array();for(var h=0;h<nMyMapCoorObj;h++){if(arrMyMapCoorObj[h].actionType!="NoAction"){var r="";if(arrMyMapCoorObj[h].actionType!="Delete"){if(arrMyMapCoorObj[h].vType()=="VMarker"||arrMyMapCoorObj[h].vType()=="VText"){var v=arrMyMapCoorObj[h].getLatLng();r="POINT("+v.lng()+" "+v.lat()+")"}else{if(arrMyMapCoorObj[h].vType()=="VPolyline"){var B=arrMyMapCoorObj[h].getLatLngs();r=GeoAsText(B,"LINESTRING")}else{if(arrMyMapCoorObj[h].vType()=="VPolygon"){var B=arrMyMapCoorObj[h].getLatLngs();r=GeoAsText(B,"POLYGON")}}}}var n=dsMyMapCoor.Tables[0].Rows[h];var z=(n.MyMapCoorID!="")?n.MyMapCoorID:"null";var t=(n.ObjectTitle!="")?n.ObjectTitle:"null";var s=(n.ObjectDesc!="")?n.ObjectDesc:"null";var a=(r!="")?r:"null";var A=(n.Style!="")?n.Style:"null";var u=(n.Public!="")?n.Public:"0";if(arrMyMapCoorObj[h].actionType=="New"){if(n.Property!=undefined&&n.Property!=null){k[k.length]=t+"!"+s+"!"+a+"!"+A+"!"+u+"!-"+(h+1);for(var f=0;f<n.Property.length;f++){n.Property[f].MyMapCoorID=(h+1)*(-1);x[x.length]=n.Property[f]}}else{k[k.length]=t+"!"+s+"!"+a+"!"+A+"!"+u+"0"}}else{if(arrMyMapCoorObj[h].actionType=="Edit"){D[D.length]=z+"!"+t+"!"+s+"!"+a+"!"+A+"!"+u}else{if(arrMyMapCoorObj[h].actionType=="Delete"){l[l.length]=z}}}}}var C=k.join("!!");var p=D.join("!!");var y=l.join("!!");var n=dsMyMap.Tables[0].Rows[iMyMapOpening];var q=map.getCenter();var o=document.getElementById("txtMapTitle").value;var d=document.getElementById("txtMapDesc").value;var g=n.MyMapID+"!!"+o+"!!"+d+"!!"+map.getLevel()+"!!"+q.lng()+"!!"+q.lat();var c=GetPropertyForUpdate("MyMapPropertyInfo",Ds_MyMapProperty);var e="";if(ArrDeleteProperty!=null&&ArrDeleteProperty.length>0){for(var h=0;h<ArrDeleteProperty.length-1;h++){e+=ArrDeleteProperty[h].MyMapCoor_property_value_id+","}e+=ArrDeleteProperty[ArrDeleteProperty.length-1].MyMapCoor_property_value_id}var m=AJLocationSearch.SaveMyMap(g,C,p,y,c,x,ArrEditProperty,e);if(m.error!=null){ReportError();return}if(m.value!=null){}if(bWaitingCreateNewMap){fnCreateNewMap();bWaitingCreateNewMap=false}LoadMyMapToolBar("EditItem");ArrEditProperty=new Array();ArrDeleteProperty=new Array();flagEditProperty=false;ArrPropertyAsLoad=new Array();Ds_MyMapProperty=null;var w=document.getElementById("txtMapTitle").value;var b=document.getElementById("txtMapDesc").value;dsMyMap.Tables[0].Rows[iMyMapOpening].Title=w;dsMyMap.Tables[0].Rows[iMyMapOpening].Description=b;dsMyMap.Tables[0].Rows[iMyMapOpening].ZoomLevel=map.getLevel();dsMyMap.Tables[0].Rows[iMyMapOpening].LastPosX=q.lng();dsMyMap.Tables[0].Rows[iMyMapOpening].LastPosY=q.lat();$("#MyMapListTitle_"+iMyMapOpening).html(w);$(".Info","#MyMapListDesc_"+iMyMapOpening).html(b)}

function closeMyMap(){loadMyMap()}
function saveMyMapCoor(){var d=document.getElementById("txtTitle").value;var j=document.getElementById("txtDesc").value;var c=(document.getElementById("chkPublic").checked)?1:0;dsMyMapCoor.Tables[0].Rows[iMyMapCoorSel].ObjectTitle=d;dsMyMapCoor.Tables[0].Rows[iMyMapCoorSel].ObjectDesc=j;dsMyMapCoor.Tables[0].Rows[iMyMapCoorSel].Public=c;$(".listpinstit","#MyMapCoorList_"+iMyMapCoorSel).html(d);$(".listpinsinfo","#MyMapCoorList_"+iMyMapCoorSel).html(j);curIcon="";curTitle="";curDesc="";var a=arrMyMapCoorObj[iMyMapCoorSel];if(a.actionType!="New"){a.actionType="Edit";if(flagEditProperty){var b=new Array();var g=dsMyMapCoor.Tables[0].Rows[iMyMapCoorSel].MyMapCoorID;for(var f=0;f<ArrEditProperty.length;f++){if(ArrEditProperty[f].MyMapCoorID!=g){b.push(ArrEditProperty[f])}}ArrEditProperty=b;b=new Array();for(var f=0;f<ArrDeleteProperty.length;f++){if(ArrDeleteProperty[f].MyMapCoorID!=g){b.push(ArrDeleteProperty[f])}}ArrDeleteProperty=b;GetCoorPropertyForUpdate("CoorPropertyInfo")}dsMyMapCoor.Tables[0].Rows[iMyMapCoorSel].Property=GetProperty("CoorPropertyInfo")}else{dsMyMapCoor.Tables[0].Rows[iMyMapCoorSel].Property=GetProperty("CoorPropertyInfo")}if(a.vType()=="VMarker"){var h=document.getElementById("btnShowPro").src;h=h.substring(h.lastIndexOf("/")+1);dsMyMapCoor.Tables[0].Rows[iMyMapCoorSel].Style=";;;;"+h+";";a.setIcon(new VIcon("images/MyMap_icon/"+h,new VSize(32,32)));$("#MyMapCoorListIcon_"+iMyMapCoorSel).css("background","url(images/MyMap_icon/"+h+") no-repeat 0 center");var k=a.getLatLng();dsMyMapCoor.Tables[0].Rows[iMyMapCoorSel].Coor="POINT("+k.lng()+" "+k.lat()+")"}else{if(a.vType()=="VText"){if(curText!=""){dsMyMapCoor.Tables[0].Rows[iMyMapCoorSel].Style=curFontWeight+";"+curFontColor+";"+curFontSize+";"+curFontFamily+";;"+curText;var e=new VTextStyle(curFontSize,curFontWeight,curFontColor,curFontFamily);a.setText(curText,e);var k=a.getLatLng();dsMyMapCoor.Tables[0].Rows[iMyMapCoorSel].Coor="POINT("+k.lng()+" "+k.lat()+")"}}else{if(a.vType()=="VPolyline"){if(curLineColor!=""){dsMyMapCoor.Tables[0].Rows[iMyMapCoorSel].Style=curLineWidth+";"+curLineColor+";"+curLineColor+";"+(parseFloat(curLineOpacity)/100)+";;";a.setStyle(curLineColor,parseFloat(curLineWidth),curLineColor,parseFloat(curLineOpacity)/100);dsMyMapCoor.Tables[0].Rows[iMyMapCoorSel].Coor=GeoAsText(a.getLatLngs(),"LINESTRING")}}else{if(a.vType()=="VPolygon"){if(curLineColor!=""){dsMyMapCoor.Tables[0].Rows[iMyMapCoorSel].Style=curLineWidth+";"+curLineColor+";"+curFillColor+";"+(parseFloat(curFillOpacity)/100)+";"+(parseFloat(curLineOpacity)/100)+";";a.setStyle(curLineColor,parseFloat(curLineWidth),curFillColor,parseFloat(curLineOpacity)/100,parseFloat(curFillOpacity)/100);dsMyMapCoor.Tables[0].Rows[iMyMapCoorSel].Coor=GeoAsText(a.getLatLngs(),"POLYGON")}}}}}map.closeInfoWindow();curTitle="";curDesc="";curIcon="";curText="";curFontFamily="";curFontWeight="";curFontSize="";curFontColor="";curLineColor="";curLineWidth="";curLineOpacity="";curFillColor="";curFillOpacity=""}var ArrPropertyAsLoad=new Array();

function showMyMapInfoWindow(h,j){if(h>=dsMyMapCoor.Tables[0].Rows.length){return}changeCoorBkColor(iMyMapCoorSel,false);changeCoorBkColor(h,true);iMyMapCoorSel=h;var p=dsMyMapCoor.Tables[0].Rows[h].MyMapCoorID;if(p!=""&&(dsMyMapCoor.Tables[0].Rows[iMyMapCoorSel].Property==null||dsMyMapCoor.Tables[0].Rows[iMyMapCoorSel].Property==undefined)){var k=null;k=AJLocationSearch.GetMyMapCoorProperty(parseInt(dsMyMapCoor.Tables[0].Rows[h].MyMapCoorID)).value;if(k!=null&&k.length>0){dsMyMapCoor.Tables[0].Rows[iMyMapCoorSel].Property=k;var c=ArrPropertyAsLoad.length;ArrPropertyAsLoad[c]=new Object();ArrPropertyAsLoad[c].id=p;ArrPropertyAsLoad[c].value=k}}var d=arrMyMapCoorObj[h];var n=(dsMyMapCoor.Tables[0].Rows[h].Style).toString().split(";");var b='<div id="MyMapCoorPopup">';if(bReadOnly){b+="<h3>"+((nLanguage==0)?"Thng tin d?a di?m":"Place information")+"</h3>";b+='<ol class="info"> <li class="li-1"> <span class="NameTit">'+((nLanguage==0)?"Tn: ":"Name: ")+'</span> <span class="Name">'+dsMyMapCoor.Tables[0].Rows[h].ObjectTitle+"</span> </li>";if(dsMyMapCoor.Tables[0].Rows[h].ObjectDesc!=""){b+='<li> <span class="InfoTit">'+((nLanguage==0)?"M t?: ":"Description: ")+'</span> <span class="Info">'+dsMyMapCoor.Tables[0].Rows[h].ObjectDesc+"</span> </li>"}b+="</ol>";var o=dsMyMapCoor.Tables[0].Rows[iMyMapCoorSel].Property;if(o!=undefined&&o!=null&&o.length>0){b+='<span class="subinfo">Thng tin b? sung</span>';b+='<ol class="listsubinfo">';for(var m=0;m<o.length;m++){b+="<li>";b+='<span class="name">'+o[m].property_name+": </span>";b+='<span class="value">'+o[m].property_value+"</span>";b+="</li>"}}b+="</ol>"}else{var g="";var l=(nLanguage==0)?"Thay d?i thu?c tnh":"Change attribute";if(d.vType()=="VMarker"){g=(curIcon=="")?"mymap_icon/"+n[4]:"mymap_icon/"+curIcon;l=(nLanguage==0)?"Ch?n bi?u tu?ng":"Chose symbol"}else{if(d.vType()=="VText"){g="icon_text.gif"}else{if(d.vType()=="VPolyline"){g="icon_polyline.gif"}else{if(d.vType()=="VPolygon"){g="icon_polygon.gif"}}}}var f=(bCreateNewMMObj)?"T?o m?i d?a di?m":"C?p nh?t d?a di?m";var e=(curTitle=="")?dsMyMapCoor.Tables[0].Rows[h].ObjectTitle:curTitle;var a=(curDesc=="")?dsMyMapCoor.Tables[0].Rows[h].ObjectDesc:curDesc;var q=(dsMyMapCoor.Tables[0].Rows[h].Public==1)?"checked":"";b+="<h3>"+f+'</h3> <a class="PointIcon" original-title="Ch?n bi?u tu?ng"><span><img id="btnShowPro" src="images/'+g+'" alt="'+l+'"/></span></a> <ol class="inputinfo"> <li> <span class="NameTit input">Tn</span> <input id="txtTitle" onkeydown="enableSaveBtn()" type="text" value="'+e+'"> </li> <li> <span class="InfoTit input">M t?</span> <textarea id="txtDesc" onkeydown="enableSaveBtn()">'+a+"</textarea> </li> </ol>";b+='<div class="MMPublic"><input id="chkPublic" type="checkbox"'+q+'/> <label for="chkPublic">Chia s? d?a di?m ny v?i m?i ngu?i</label></div>';b+='<span class="subinfo">Thng tin b? sung</span> <ol id="CoorPropertyInfo" class="listsubinfo listsubinfoinput"> <li class="li-relative"> <span class="Mname">Tn</span> <span class="Mvalue">Gi tr?</span> </li> </ol> <a id="CoorAddNewPropertyStore" class="addsubinfo" onclick="AddNewPropertyClick(\'CoorPropertyInfo\',\'MyMapCoorProInfo\')"><span>Thm</span></a>';b+='<div class="mmpopupbtn"><a onclick="saveMyMapCoor()" id="btnSaveMyMapCoor"><span>?ng </span></a>';b+='<a onclick="map.closeInfoWindow()" id="btnSaveMyMapCoor"><span>B? qua</span></a></div>'}b+='</div><div class="Spacer"></div>';if(j==0||clickedPoint==null){d.openInfoWindow(b)}else{if(d.vType()=="VMarker"||d.vType()=="VText"){d.openInfoWindow(b)}else{map.openInfoWindow(clickedPoint,b)}}if(!bReadOnly){document.getElementById("btnShowPro").onclick=function(){curTitle=document.getElementById("txtTitle").value;curDesc=document.getElementById("txtDesc").value;showMyMapProInfoWindow()};var o=dsMyMapCoor.Tables[0].Rows[iMyMapCoorSel].Property;if(o!=undefined&&o!=null&&o.length>0){for(var m=0;m<o.length;m++){AddNewPropertyClick("CoorPropertyInfo","MyMapCoorProInfo",o[m].property_name,o[m].property_value)}}else{AddNewPropertyClick("CoorPropertyInfo","MyMapCoorProInfo")}}}

function GetMyMapCoorPropertyCallback(a){hideBusyDiv();if(a.error!=null){ReportError();return}val=a.value}
function showMyMapProInfoWindow(){var e=arrMyMapCoorObj[iMyMapCoorSel];var d=(dsMyMapCoor.Tables[0].Rows[iMyMapCoorSel].Style).toString().split(";");if(e.vType()=="VMarker"){var b=new Array();b[b.length]="<table border='0' cellspacing='0' cellpadding='0' style='width:280px; height:200px; background-color:#FFFFFF;'>";b[b.length]="<tr>";if(nLanguage==0){b[b.length]="<td onclick='showMyMapInfoWindow("+iMyMapCoorSel+", 0)' width='280px' align='left' valign='middle' style='height:32px;'><img src='images/backpage.gif' align='absmiddle' style='cursor:pointer;' /><a style='color:#999999; font-size:11px;font-family:Verdana;cursor:pointer;' onmouseover=ChangeTextColor(this,'#558800') onmouseout=ChangeTextColor(this,'#999999')>Quay l?i</a></td>"}else{b[b.length]="<td onclick='showMyMapInfoWindow("+iMyMapCoorSel+", 0)' width='280px' align='left' valign='middle' style='height:32px;'><img src='images/backpage.gif' align='absmiddle' style='cursor:pointer;' /><a style='color:#999999; font-size:11px;font-family:Verdana;cursor:pointer;' onmouseover=ChangeTextColor(this,'#558800') onmouseout=ChangeTextColor(this,'#999999')>Back</a></td>"}b[b.length]="</tr>";b[b.length]="<tr>";b[b.length]="<td align='left' valign='top'>";b[b.length]="<div style='cursor:pointer; float:left; width:280px;height:155px; margin-top:2px; overflow:auto; background-color:#ffffff;'>";for(var a=0;a<iconArr.length;a++){var f="";if(curIcon==""){f=d[4]}else{f=curIcon}if(iconArr[a]==f){b[b.length]="<img width='32px' height='32px' style='border:1px #0066cc solid;' onclick='chooseIcon(this)' src='images/mymap_icon/"+iconArr[a]+"'/> "}else{b[b.length]="<img width='32px' height='32px' style='border:1px #ffffff solid;' onclick='chooseIcon(this)' onmouseover='changeMarkerIconStyle(this)' onmouseout='changeMarkerIconStyle(this)' src='images/mymap_icon/"+iconArr[a]+"'/> "}}b[b.length]="</div></td></tr>";b[b.length]="</table>";e.openInfoWindow(b.join(""))}else{if(e.vType()=="VText"){var b=new Array();var g="";b[b.length]="<table border='0' cellspacing='0' cellpadding='0' style='width:280px; height:200px; background-color:#FFFFFF;'>";b[b.length]="<tr>";if(nLanguage==0){b[b.length]="<td onclick='showMyMapInfoWindow("+iMyMapCoorSel+", 0)' width='280px' align='left' valign='middle' style='height:20px;'><img src='images/backpage.gif' align='absmiddle' style='cursor:pointer;' /><a style='color:#999999; font-size:11px;font-family:Verdana;cursor:pointer;' onmouseover=ChangeTextColor(this,'#558800') onmouseout=ChangeTextColor(this,'#999999')>Quay l?i</a></td>";b[b.length]="</tr>";b[b.length]="<tr>";b[b.length]="<td align='left' valign='top'>";b[b.length]="<table width='100%'>";b[b.length]="<tr>";b[b.length]="<td><b>&nbsp;Chu?i hi?n th?</b></td>";g=(curText=="")?d[5]:curText;b[b.length]="<td colspan='3'><input id='txtText' onblur='changeSampleText()' onkeyup='changeSampleText()' type='text' value='"+g+"' style='font-family:Arial; width:167px; border:1px #999999 solid; ' /></td>";b[b.length]="</tr>";b[b.length]="<tr>";b[b.length]="<td><b>&nbsp;Phng ch?</b></td>";b[b.length]="<td colspan='3'>";g=(curFontFamily=="")?d[3]:curFontFamily;b[b.length]=getFontListHTMLString(g);b[b.length]="</td>";b[b.length]="</tr>";b[b.length]="<tr>";b[b.length]="<td><b>&nbsp;Ki?u ch?</b></td>";b[b.length]="<td colspan='3'>";g=(curFontWeight=="")?d[0]:curFontWeight;b[b.length]=getWeightListHTMLString(g);b[b.length]="</td>";b[b.length]="</tr>";b[b.length]="<tr>";b[b.length]="<td><b>&nbsp;C? ch?&nbsp;</b></td>";if(browserName=="msie"){b[b.length]="<td>"}else{b[b.length]="<td width='137'>"}g=(curFontSize=="")?d[2]:curFontSize;b[b.length]=getSizeListHTMLString(g);if(browserName=="msie"){b[b.length]="<b>&nbsp;&nbsp;&nbsp;&nbsp;Mu ch?&nbsp;&nbsp;</b>"}else{b[b.length]="<b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mu ch?</b>"}b[b.length]="</td><td colspan='2' valign='center'>";g=(curFontColor=="")?d[1]:curFontColor;b[b.length]="<div id='divTextColor' onclick=showColorChosing(event,'divTextColor') valign='middle' style='background:"+g+"; position:relative; width:26px; height:18px; BORDER: #558800 1px solid; vertical-align:middle; cursor:pointer;'></div>";b[b.length]="</td>";b[b.length]="</tr>";b[b.length]="<tr>";b[b.length]="<td height='40' colspan='4' align='center'>";b[b.length]="<a class='a1' id='textSample' align='absmiddle'>Sample Text</a>";b[b.length]="</td>";b[b.length]="</tr>";b[b.length]="<tr>";b[b.length]="<td colspan='4'>";b[b.length]="<button align='right' onclick='saveTextPro()' id='btnSaveTextPro' style='cursor:pointer;";if(browserName=="msie"){b[b.length]=" margin-left:206px; margin-right:1px; margin-top:3px;'>?ng </button>"}else{b[b.length]=" margin-left:203px; margin-right:4px; margin-top:9px;'>?ng </button>"}}else{b[b.length]="<td onclick='showMyMapInfoWindow("+iMyMapCoorSel+", 0)' width='280px' align='left' valign='middle' style='height:20px;'><img src='images/backpage.gif' align='absmiddle' style='cursor:pointer;' /><a style='color:#999999; font-size:11px;font-family:Verdana;cursor:pointer;' onmouseover=ChangeTextColor(this,'#558800') onmouseout=ChangeTextColor(this,'#999999')>Back</a></td>";b[b.length]="</tr>";b[b.length]="<tr>";b[b.length]="<td align='left' valign='top'>";b[b.length]="<table width='100%'>";b[b.length]="<tr>";b[b.length]="<td><b>&nbsp;Display text</b></td>";g=(curText=="")?d[5]:curText;b[b.length]="<td colspan='3'><input id='txtText' onblur='changeSampleText()' onkeyup='changeSampleText()' type='text' value='"+g+"' style='font-family:Arial; width:167px; border:1px #999999 solid; ' /></td>";b[b.length]="</tr>";b[b.length]="<tr>";b[b.length]="<td><b>&nbsp;Font name</b></td>";b[b.length]="<td colspan='3'>";g=(curFontFamily=="")?d[3]:curFontFamily;b[b.length]=getFontListHTMLString(g);b[b.length]="</td>";b[b.length]="</tr>";b[b.length]="<tr>";b[b.length]="<td><b>&nbsp;Font style</b></td>";b[b.length]="<td colspan='3'>";g=(curFontWeight=="")?d[0]:curFontWeight;b[b.length]=getWeightListHTMLString(g);b[b.length]="</td>";b[b.length]="</tr>";b[b.length]="<tr>";b[b.length]="<td><b>&nbsp;Font size&nbsp;</b></td>";if(browserName=="msie"){b[b.length]="<td>"}else{b[b.length]="<td width='137'>"}g=(curFontSize=="")?d[2]:curFontSize;b[b.length]=getSizeListHTMLString(g);if(browserName=="msie"){b[b.length]="<b>&nbsp;&nbsp;&nbsp;&nbsp;Text color&nbsp;&nbsp;</b>"}else{b[b.length]="<b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Text color</b>"}b[b.length]="</td><td colspan='2' valign='center'>";g=(curFontColor=="")?d[1]:curFontColor;b[b.length]="<div id='divTextColor' onclick=showColorChosing(event,'divTextColor') valign='middle' style='background:"+g+"; position:relative; width:26px; height:18px; BORDER: #558800 1px solid; vertical-align:middle; cursor:pointer;'></div>";b[b.length]="</td>";b[b.length]="</tr>";b[b.length]="<tr>";b[b.length]="<td height='40' colspan='4' align='center'>";b[b.length]="<a class='a1' id='textSample' align='absmiddle'>Sample Text</a>";b[b.length]="</td>";b[b.length]="</tr>";b[b.length]="<tr>";b[b.length]="<td colspan='4'>";b[b.length]="<button align='right' onclick='saveTextPro()' id='btnSaveTextPro' style='cursor:pointer;";if(browserName=="msie"){b[b.length]=" margin-left:206px; margin-right:1px; margin-top:3px;'>OK</button>"}else{b[b.length]=" margin-left:203px; margin-right:4px; margin-top:9px;'>OK</button>"}}b[b.length]="</td>";b[b.length]="</tr>";b[b.length]="</table>";b[b.length]="</td>";b[b.length]="</tr>";b[b.length]="</table>";e.openInfoWindow(b.join(""));changeSampleText()}else{if(e.vType()=="VPolyline"){var b=new Array();b[b.length]="<table border='0' cellspacing='0' cellpadding='0' style='width:280px; height:200px; background-color:#FFFFFF;'>";b[b.length]="<tr>";if(nLanguage==0){b[b.length]="<td onclick='showMyMapInfoWindow("+iMyMapCoorSel+", 1)' width='280px' align='left' valign='middle' style='height:40px;'><img src='images/backpage.gif' align='absmiddle' style='cursor:pointer;' /><a style='color:#999999; font-size:11px;font-family:Verdana;cursor:pointer;' onmouseover=ChangeTextColor(this,'#558800') onmouseout=ChangeTextColor(this,'#999999')>Quay l?i</a></td>";b[b.length]="</tr>";b[b.length]="<tr>";b[b.length]="<td align='left' valign='top'>";b[b.length]="<table width='100%'>";b[b.length]="<tr>";b[b.length]="<td><b>&nbsp;Mu du?ng</b></td>";b[b.length]="<td><div id='divLineColor' onclick=showColorChosing(event,'divLineColor') valign='middle' style='background:"+d[1]+"; position:relative; width:26px; height:18px; BORDER: #558800 1px solid; vertical-align:middle; cursor:pointer;'></div></td>";b[b.length]="</tr>";b[b.length]="<tr>";b[b.length]="<td><b>&nbsp;? r?ng du?ng</b></td>";b[b.length]="<td><input type='text' id='txtLineWidth' value='"+d[0]+"' style='text-align:right; font-family:Arial; width:163px; border:1px #999999 solid; ' /></td>";b[b.length]="</tr>";b[b.length]="<tr>";b[b.length]="<td><b>&nbsp;? m? du?ng</b></td>";b[b.length]="<td><input type='text' id='txtLineOpacity' value='"+(parseFloat(d[3])*100)+"' style='text-align:right; font-family:Arial; width:163px; border:1px #999999 solid; ' /></td>";b[b.length]="</tr>";b[b.length]="<tr>";b[b.length]="<td colspan='2'>";b[b.length]="<button align='right' onclick='savePolylinePro()' id='btnSavePolylinePro' style='cursor:pointer;";if(browserName=="msie"){b[b.length]=" margin-left:200px; margin-right:1px; margin-top:52px;'>?ng </button>"}else{b[b.length]=" margin-left:200px; margin-right:4px; margin-top:53px;'>?ng </button>"}}else{b[b.length]="<td onclick='showMyMapInfoWindow("+iMyMapCoorSel+", 1)' width='280px' align='left' valign='middle' style='height:40px;'><img src='images/backpage.gif' align='absmiddle' style='cursor:pointer;' /><a style='color:#999999; font-size:11px;font-family:Verdana;cursor:pointer;' onmouseover=ChangeTextColor(this,'#558800') onmouseout=ChangeTextColor(this,'#999999')>Back</a></td>";b[b.length]="</tr>";b[b.length]="<tr>";b[b.length]="<td align='left' valign='top'>";b[b.length]="<table width='100%'>";b[b.length]="<tr>";b[b.length]="<td><b>&nbsp;Line color</b></td>";b[b.length]="<td><div id='divLineColor' onclick=showColorChosing(event,'divLineColor') valign='middle' style='background:"+d[1]+"; position:relative; width:26px; height:18px; BORDER: #558800 1px solid; vertical-align:middle; cursor:pointer;'></div></td>";b[b.length]="</tr>";b[b.length]="<tr>";b[b.length]="<td><b>&nbsp;Line width</b></td>";b[b.length]="<td><input type='text' id='txtLineWidth' value='"+d[0]+"' style='text-align:right; font-family:Arial; width:163px; border:1px #999999 solid; ' /></td>";b[b.length]="</tr>";b[b.length]="<tr>";b[b.length]="<td><b>&nbsp;Line opacity</b></td>";b[b.length]="<td><input type='text' id='txtLineOpacity' value='"+(parseFloat(d[3])*100)+"' style='text-align:right; font-family:Arial; width:163px; border:1px #999999 solid; ' /></td>";b[b.length]="</tr>";b[b.length]="<tr>";b[b.length]="<td colspan='2'>";b[b.length]="<button align='right' onclick='savePolylinePro()' id='btnSavePolylinePro' style='cursor:pointer;";if(browserName=="msie"){b[b.length]=" margin-left:200px; margin-right:1px; margin-top:52px;'>OK</button>"}else{b[b.length]=" margin-left:200px; margin-right:4px; margin-top:53px;'>OK</button>"}}b[b.length]="</td>";b[b.length]="</tr>";b[b.length]="</table>";b[b.length]="</td>";b[b.length]="</tr>";b[b.length]="</table>";if(clickedPoint!=null){map.openInfoWindow(clickedPoint,b.join(""))}else{e.openInfoWindow(b.join(""))}}else{if(e.vType()=="VPolygon"){var b=new Array();b[b.length]="<table border='0' cellspacing='0' cellpadding='0' style='width:280px; height:200px; background-color:#FFFFFF;'>";b[b.length]="<tr>";if(nLanguage==0){b[b.length]="<td onclick='showMyMapInfoWindow("+iMyMapCoorSel+", 1)' width='280px' align='left' valign='middle' style='height:32px;'><img src='images/backpage.gif' align='absmiddle' style='cursor:pointer;' /><a style='color:#999999; font-size:11px;font-family:Verdana;cursor:pointer;' onmouseover=ChangeTextColor(this,'#558800') onmouseout=ChangeTextColor(this,'#999999')>Quay l?i</a></td>";b[b.length]="</tr>";b[b.length]="<tr>";b[b.length]="<td align='left' valign='top'>";b[b.length]="<table width='100%'>";b[b.length]="<tr>";b[b.length]="<td><b>&nbsp;Mu du?ng</b></td>";b[b.length]="<td><div id='divLineColor' onclick=showColorChosing(event,'divLineColor') valign='middle' style='background:"+d[1]+"; position:relative; width:26px; height:18px; BORDER: #558800 1px solid; vertical-align:middle; cursor:pointer;'></div></td>";b[b.length]="</tr>";b[b.length]="<tr>";b[b.length]="<td><b>&nbsp;? r?ng du?ng</b></td>";b[b.length]="<td><input id='txtLineWidth' type='text' value='"+d[0]+"' style='text-align:right; font-family:Arial; width:163px; border:1px #999999 solid; ' /></td>";b[b.length]="</tr>";b[b.length]="<tr>";b[b.length]="<td><b>&nbsp;? m? du?ng</b></td>";var c=(d[4]=="")?50:parseFloat(d[4])*100;b[b.length]="<td><input id='txtLineOpacity' type='text' value='"+c+"' style='text-align:right; font-family:Arial; width:163px; border:1px #999999 solid; ' /></td>";b[b.length]="</tr>";b[b.length]="<tr>";b[b.length]="<td><b>&nbsp;Mu t</b></td>";b[b.length]="<td><div id='divFillColor' onclick=showColorChosing(event,'divFillColor') valign='middle' style='background:"+d[2]+"; position:relative; width:26px; height:18px; BORDER: #558800 1px solid; vertical-align:middle; cursor:pointer;'></div></td>";b[b.length]="</tr>";b[b.length]="<tr>";b[b.length]="<td><b>&nbsp;? m? t</b></td>";b[b.length]="<td><input id='txtFillOpacity' type='text' value='"+parseFloat(d[3])*100+"' style='text-align:right; font-family:Arial; width:163px; border:1px #999999 solid; ' /></td>";b[b.length]="</tr>";b[b.length]="<tr>";b[b.length]="<td colspan='2'>";b[b.length]="<button align='right' onclick='savePolygonPro()' id='btnSavePolygonPro' style='cursor:pointer;";if(browserName=="msie"){b[b.length]=" margin-left:200px; margin-right:1px; margin-top:10px;'>?ng </button>"}else{b[b.length]=" margin-left:203px; margin-right:4px; margin-top:13px;'>?ng </button>"}}else{b[b.length]="<td onclick='showMyMapInfoWindow("+iMyMapCoorSel+", 1)' width='280px' align='left' valign='middle' style='height:32px;'><img src='images/backpage.gif' align='absmiddle' style='cursor:pointer;' /><a style='color:#999999; font-size:11px;font-family:Verdana;cursor:pointer;' onmouseover=ChangeTextColor(this,'#558800') onmouseout=ChangeTextColor(this,'#999999')>Back</a></td>";b[b.length]="</tr>";b[b.length]="<tr>";b[b.length]="<td align='left' valign='top'>";b[b.length]="<table width='100%'>";b[b.length]="<tr>";b[b.length]="<td><b>&nbsp;Line color</b></td>";b[b.length]="<td><div id='divLineColor' onclick=showColorChosing(event,'divLineColor') valign='middle' style='background:"+d[1]+"; position:relative; width:26px; height:18px; BORDER: #558800 1px solid; vertical-align:middle; cursor:pointer;'></div></td>";b[b.length]="</tr>";b[b.length]="<tr>";b[b.length]="<td><b>&nbsp;Line width</b></td>";b[b.length]="<td><input id='txtLineWidth' type='text' value='"+d[0]+"' style='text-align:right; font-family:Arial; width:163px; border:1px #999999 solid; ' /></td>";b[b.length]="</tr>";b[b.length]="<tr>";b[b.length]="<td><b>&nbsp;Line opacity</b></td>";var c=(d[4]=="")?50:parseFloat(d[4])*100;b[b.length]="<td><input id='txtLineOpacity' type='text' value='"+c+"' style='text-align:right; font-family:Arial; width:163px; border:1px #999999 solid; ' /></td>";b[b.length]="</tr>";b[b.length]="<tr>";b[b.length]="<td><b>&nbsp;Fill color</b></td>";b[b.length]="<td><div id='divFillColor' onclick=showColorChosing(event,'divFillColor') valign='middle' style='background:"+d[2]+"; position:relative; width:26px; height:18px; BORDER: #558800 1px solid; vertical-align:middle; cursor:pointer;'></div></td>";b[b.length]="</tr>";b[b.length]="<tr>";b[b.length]="<td><b>&nbsp;Fill opacity</b></td>";b[b.length]="<td><input id='txtFillOpacity' type='text' value='"+parseFloat(d[3])*100+"' style='text-align:right; font-family:Arial; width:163px; border:1px #999999 solid; ' /></td>";b[b.length]="</tr>";b[b.length]="<tr>";b[b.length]="<td colspan='2'>";b[b.length]="<button align='right' onclick='savePolygonPro()' id='btnSavePolygonPro' style='cursor:pointer;";if(browserName=="msie"){b[b.length]=" margin-left:200px; margin-right:1px; margin-top:10px;'>OK</button>"}else{b[b.length]=" margin-left:203px; margin-right:4px; margin-top:13px;'>OK</button>"}}b[b.length]="</td>";b[b.length]="</tr>";b[b.length]="</table>";b[b.length]="</td>";b[b.length]="</tr>";b[b.length]="</table>";if(clickedPoint!=null){map.openInfoWindow(clickedPoint,b.join(""))}else{e.openInfoWindow(b.join(""))}}}}}}

function createCPMarker(c,e,g,f){var h=new VMarker(c.latlngs[g].copy(),e);h.borderStyle="1px "+c.lineColor+" solid";map.addOverlay(h);h.enableDragging();h.editObjectIndex=c.mmIndex;h.editPointIndex=nControlPoint;h.type=MMCONTROLOBJ;arrControlPoint[nControlPoint]=h;nControlPoint++;if(g<f){var a=(c.latlngs[g].lat()+c.latlngs[g+1].lat())/2;var b=(c.latlngs[g].lng()+c.latlngs[g+1].lng())/2;var d=new VMarker(new VLatLng(a,b),e);d.borderStyle="1px "+c.lineColor+" solid";d.opacity=50;map.addOverlay(d);d.enableDragging();d.editObjectIndex=c.mmIndex;d.addPointIndex=nAPControlPoint;d.type=MMAPCONTROLOBJ;arrAPControlPoint[nAPControlPoint]=d;nAPControlPoint++;VEvent.addListener(d,"dragging",function(k){bCPDragging=true;var j,m,n;j=arrMyMapCoorObj[iMyMapCoorOver].latlngs[d.addPointIndex].copy();m=d.getLatLng().copy();n=arrMyMapCoorObj[iMyMapCoorOver].latlngs[d.addPointIndex+1].copy();if(tempPolyline==null){var l=new VPolylineOptions(true,false,"Dot");tempPolyline=new VPolyline([j,m,n],arrMyMapCoorObj[iMyMapCoorOver].lineColor);tempPolyline.opts=l;map.addOverlay(tempPolyline)}else{tempPolyline.setLatLngs([j,m,n])}});VEvent.addListener(d,"dragend",function(j){bCPDragging=false;if(tempPolyline!=null){map.removeOverlay(tempPolyline);tempPolyline=null}var k=d.getLatLng().copy();arrMyMapCoorObj[iMyMapCoorOver].insertPoint(d.addPointIndex,k);if(arrMyMapCoorObj[iMyMapCoorOver].actionType!="New"){arrMyMapCoorObj[iMyMapCoorOver].actionType="Edit"}enableSaveBtn();clearControlPoint();showControlPoint(c)})}VEvent.addListener(h,"dragging",function(q){bCPDragging=true;var r=arrMyMapCoorObj[iMyMapCoorOver].latlngs.length;var j,o;j=h.editPointIndex-1;o=h.editPointIndex+1;var n,l,m;if(j!=-1){n=arrMyMapCoorObj[iMyMapCoorOver].latlngs[j].copy()}else{if(arrMyMapCoorObj[iMyMapCoorOver].vType()=="VPolygon"){n=arrMyMapCoorObj[iMyMapCoorOver].latlngs[r-2].copy()}}l=h.getLatLng().copy();if(o!=r){m=arrMyMapCoorObj[iMyMapCoorOver].latlngs[o].copy()}if(tempPolyline==null){var s=new VPolylineOptions(true,false,"Dot");if(j==-1){if(arrMyMapCoorObj[iMyMapCoorOver].vType()=="VPolyline"){tempPolyline=new VPolyline([l,m],arrMyMapCoorObj[iMyMapCoorOver].lineColor);var p=(l.lat()+m.lat())/2;var k=(l.lng()+m.lng())/2;arrAPControlPoint[h.editPointIndex].setPoint(new VLatLng(p,k))}else{tempPolyline=new VPolyline([n,l,m],arrMyMapCoorObj[iMyMapCoorOver].lineColor);var p=(n.lat()+l.lat())/2;var k=(n.lng()+l.lng())/2;arrAPControlPoint[nAPControlPoint-1].setPoint(new VLatLng(p,k));p=(l.lat()+m.lat())/2;k=(l.lng()+m.lng())/2;arrAPControlPoint[h.editPointIndex].setPoint(new VLatLng(p,k))}}else{if(o==r){tempPolyline=new VPolyline([n,l],arrMyMapCoorObj[iMyMapCoorOver].lineColor);var p=(n.lat()+l.lat())/2;var k=(n.lng()+l.lng())/2;arrAPControlPoint[j].setPoint(new VLatLng(p,k))}else{tempPolyline=new VPolyline([n,l,m],arrMyMapCoorObj[iMyMapCoorOver].lineColor);var p=(n.lat()+l.lat())/2;var k=(n.lng()+l.lng())/2;arrAPControlPoint[j].setPoint(new VLatLng(p,k));p=(l.lat()+m.lat())/2;k=(l.lng()+m.lng())/2;arrAPControlPoint[h.editPointIndex].setPoint(new VLatLng(p,k))}}tempPolyline.opts=s;map.addOverlay(tempPolyline)}else{if(j==-1){if(arrMyMapCoorObj[iMyMapCoorOver].vType()=="VPolyline"){tempPolyline.setLatLngs([l,m]);var p=(l.lat()+m.lat())/2;var k=(l.lng()+m.lng())/2;arrAPControlPoint[h.editPointIndex].setPoint(new VLatLng(p,k))}else{tempPolyline.setLatLngs([n,l,m]);var p=(n.lat()+l.lat())/2;var k=(n.lng()+l.lng())/2;arrAPControlPoint[nAPControlPoint-1].setPoint(new VLatLng(p,k));p=(l.lat()+m.lat())/2;k=(l.lng()+m.lng())/2;arrAPControlPoint[h.editPointIndex].setPoint(new VLatLng(p,k))}}else{if(o==r){tempPolyline.setLatLngs([n,l]);var p=(n.lat()+l.lat())/2;var k=(n.lng()+l.lng())/2;arrAPControlPoint[j].setPoint(new VLatLng(p,k))}else{tempPolyline.setLatLngs([n,l,m]);var p=(n.lat()+l.lat())/2;var k=(n.lng()+l.lng())/2;arrAPControlPoint[j].setPoint(new VLatLng(p,k));p=(l.lat()+m.lat())/2;k=(l.lng()+m.lng())/2;arrAPControlPoint[h.editPointIndex].setPoint(new VLatLng(p,k))}}}});VEvent.addListener(h,"dragend",function(j){bCPDragging=false;if(tempPolyline!=null){map.removeOverlay(tempPolyline);tempPolyline=null}var k=h.getLatLng().copy();arrMyMapCoorObj[iMyMapCoorOver].setVertex(h.editPointIndex,k);if(arrMyMapCoorObj[iMyMapCoorOver].actionType!="New"){arrMyMapCoorObj[iMyMapCoorOver].actionType="Edit"}enableSaveBtn()})}

function showControlPoint(c){if(!bReadOnly&&!bCPDragging){if(selTbrButton!=null&&selTbrButton.id!="btnMove"){return}clearControlPoint();iMyMapCoorOver=c.mmIndex;var f=(c.vType()=="VPolyline")?c.latlngs.length:c.latlngs.length-1;var d=(c.vType()=="VPolyline")?f-1:f;for(var a=0;a<f;a++){var e=new VIcon("images/rec.jpg");e.iconSize=new VSize(8,8);var b=new VMarkerOptions(e,null,new VSize(4,4));createCPMarker(c,b,a,d)}}}

function clearControlPoint(){for(var a=0;a<nControlPoint;a++){map.removeOverlay(arrControlPoint[a])}arrControlPoint=new Array();nControlPoint=0;for(var a=0;a<nAPControlPoint;a++){map.removeOverlay(arrAPControlPoint[a])}arrAPControlPoint=new Array();nAPControlPoint=0}

function chooseIcon(b){var a=b.src;a=a.substring(a.lastIndexOf("/")+1);curIcon=a;showMyMapInfoWindow(iMyMapCoorSel,0)}

function saveTextPro(){curText=document.getElementById("txtText").value;curFontFamily=document.getElementById("cboFontFamily").value;curFontWeight=document.getElementById("cboFontWeight").value;curFontSize=document.getElementById("cboFontSize").value;curFontColor=$("#divTextColor")[0].style.backgroundColor;showMyMapInfoWindow(iMyMapCoorSel,0)}

function savePolylinePro(){curLineColor=$("#divLineColor")[0].style.backgroundColor;curLineWidth=document.getElementById("txtLineWidth").value;curLineOpacity=document.getElementById("txtLineOpacity").value;showMyMapInfoWindow(iMyMapCoorSel,1)}

function savePolygonPro(){curLineColor=$("#divLineColor")[0].style.backgroundColor;curLineWidth=document.getElementById("txtLineWidth").value;curLineOpacity=document.getElementById("txtLineOpacity").value;curFillColor=$("#divFillColor")[0].style.backgroundColor;curFillOpacity=document.getElementById("txtFillOpacity").value;showMyMapInfoWindow(iMyMapCoorSel,1)}

function changeMarkerIconStyle(a){if(a.style.borderColor=="#ffffff"||a.style.borderLeftColor=="rgb(255, 255, 255)"){a.style.border="1px #558800 solid"}else{a.style.border="1px #ffffff solid"}}

function changeCoorBkColor(a,b){if(b){$("#MyMapCoorList_"+a).addClass("MyMapCoorList-active")}else{$("#MyMapCoorList_"+a).removeClass("MyMapCoorList-active")}}

function changeCoorTextStyle(a){var b=document.getElementById("MyMapCoorListTitle_"+a);if(b!=undefined){if(b.style.color=="#0066cc"||b.style.color=="rgb(0, 102, 204)"){b.style.color="#558800"}else{b.style.color="#0066cc"}}}

function getFontListHTMLString(d){var a=["Arial","Arial Black","Arial Narrow","Times New Roman","Verdana","Tahoma","Currier New","Microsoft Sans Serif","Webdings"];var b="";var e=(browserName=="msie")?171:169;b+="<select id='cboFontFamily' onchange='changeSampleText()' style='font-family:Arial; font-size:12px; width:"+e+"px; border:1px #999999 solid;'>";for(var c=0;c<9;c++){b+="<option value='"+a[c]+"'";if(d==a[c]){b+="selected"}b+=">"+a[c]+"</option>"}b+="</select>";return b}

function getSizeListHTMLString(c){var e=[8,10,12,14,16,18,20,22,24];var b="";var d=(browserName=="msie")?60:55;b+="<select id='cboFontSize' onchange='changeSampleText()' style='font-family:Arial; font-size:12px; width:"+d+"px; border:1px #999999 solid;'>";for(var a=0;a<9;a++){b+="<option value='"+e[a]+"'";if(c==e[a]){b+="selected"}b+=">"+e[a]+"</option>"}b+="</select>";return b}

function getWeightListHTMLString(c){if(nLanguage==0){var f=["Thu?ng","?m"]}else{var f=["Normal","Bold"]}var d=["Normal","Bold"];var b="";var e=(browserName=="msie")?171:169;b+="<select id='cboFontWeight' onchange='changeSampleText()' style='font-family:Arial; font-size:12px; width:"+e+"px; border:1px #999999 solid;'>";for(var a=0;a<2;a++){b+="<option value='"+d[a].toLowerCase()+"'";if(c==d[a].toLowerCase()){b+="selected"}b+=">"+f[a]+"</option>"}b+="</select>";return b}

function showColorChosing(b,g){var l=document.createElement("TABLE");l.setAttribute("width",100);l.setAttribute("cellPadding",0);l.setAttribute("cellSpacing",0);l.setAttribute("border",1);l.setAttribute("borderColor","#558800");l.setAttribute("id","basic_color_table");l.style.backgroundColor="white";var a=document.createElement("TBODY");l.appendChild(a);for(var h=0;h<8;h++){var f=document.createElement("TR");for(var j=0;j<6;j++){var d=document.createElement("TD");d.style.backgroundColor=colorArr[j][h];d.style.color=colorArr[j][h];d.style.width=16+"px";d.style.height=16+"px";d.style.borderWidth="1px";d.style.borderColor="#ffffff";d.style.borderStyle="solid";d.setAttribute("id","basic_color_"+h+"_"+j);onClickEvent=function(m,n,e){return(function(){fnOnColorClick(m,n,e)})}(colorArr[j][h],h,j);ondblClickEvent=function(m,n,e){return(function(){fnOnColordblClick(m,n,e,g)})}(colorArr[j][h],h,j);if(document.all){d.attachEvent("onmouseover",onClickEvent);d.attachEvent("onclick",ondblClickEvent)}else{if(document.layers){d.addeventlistener("onmouseover",onClickEvent,false);d.addeventlistener("onclick",ondblClickEvent,false)}else{if(document.getElementById){d.addEventListener("mouseover",onClickEvent,false);d.addEventListener("click",ondblClickEvent,false)}}}var c=document.createTextNode(".");d.appendChild(c);f.appendChild(d)}a.appendChild(f)}var k=document.getElementById("colorChosingPopup");if(k==null){k=document.createElement("div");k.id="colorChosingPopup";if(browserName=="msie"){document.getElementById(g).appendChild(k)}else{document.getElementById(g).parentNode.appendChild(k)}k.style.position="absolute";k.style.zIndex=200;l.style.zIndex=200;k.appendChild(l)}if(browserName=="msie"){k.style.left=event.x-80;k.style.top=event.y-90}else{k.style.left=b.clientX;k.style.top=b.clientY}}

function fnOnColorClick(c,a,b){cell=document.getElementById("basic_color_"+curColElX+"_"+curColElY);if(cell!=null){cell.style.borderColor="#ffffff"}curColElX=a;curColElY=b;cell=document.getElementById("basic_color_"+curColElX+"_"+curColElY);if(cell!=null){cell.style.borderColor="#ff0000"}}

function fnOnColordblClick(d,b,c,a){document.getElementById(a).style.background=colorArr[c][b];if(document.getElementById("id3")!=null){id3.fillcolor=colorArr[c][b]}var e=document.getElementById("colorChosingPopup");if(e!=null){if(browserName=="msie"){document.getElementById(a).removeChild(e)}else{document.getElementById(a).parentNode.removeChild(e)}}if(document.getElementById("textSample")!=null){changeSampleText()}}

function changeSampleText(){var a=document.getElementById("textSample");var b=document.getElementById("txtText").value;if(b==""){b=" "}if(b.length>15){b=b.substring(0,16)}a.innerHTML=b;a.style.fontFamily=document.getElementById("cboFontFamily").value;a.style.fontWeight=document.getElementById("cboFontWeight").value;a.style.fontSize=document.getElementById("cboFontSize").value+"px";a.style.color=$("#divTextColor")[0].style.backgroundColor}

function selectToolbarBtn(a){clearControlPoint();if(a==selTbrButton){return}if(selTbrButton!=null){$(selTbrButton).removeClass(selTbrButton.id+"Active")}selTbrButton=a;$(a).addClass(a.id+"Active");document.getElementById("container").style.cursor="pointer";switch(a.id){case"btnMove":document.getElementById("container").style.cursor="url('images/openhand.cur'),auto";if(nLanguage==0){$(".ToolbarExplain").html("Thay d?i v? tr cc d?i tu?ng")}else{$(".ToolbarExplain").html("Drag to change object location")}break;case"btnAddPoint":if(nLanguage==0){$(".ToolbarExplain").html("Nh?p chu?t ln b?n d? d? thm di?m")}else{$(".ToolbarExplain").html("Click on map to add place")}break;case"btnAddText":if(nLanguage==0){$(".ToolbarExplain").html("Nh?p chu?t ln b?n d? d? thm ch?")}else{$(".ToolbarExplain").html("Click on map to add text")}break;case"btnAddPolyline":case"btnAddPolygon":if(nLanguage==0){$(".ToolbarExplain").html("Nh?p chu?t ln b?n d? d? b?t d?u v?<br/>Nh?p chu?t d? v? ti?p<br/>Nh?p di d? k?t thc")}else{$(".ToolbarExplain").html("Click on map to start drawing line")}break}map.closeInfoWindow()}

function ChangeTextColor(a,b){if(a!=null){a.style.color=b}}var PropertyIndex=0;var flagEditProperty=false;var exName="VD: Gi? m? c?a";var exValue="VD: 7h - 21h";

function AddNewPropertyClick(h,a,g,d){var b=$("li","#"+h).length;var e=$("li:last-child input","#"+h);if(b>1&&e[0].value==exName){return}var c=PropertyIndex+100;var f;if(g==undefined){g=exName;d=exValue}if(h!="CoorPropertyInfo"){f="<li id="+a+c+'> <input tabindex="'+c+'" id="PropertyName_'+c+'" value="'+g+'" onkeydown="enableSaveBtn()" class="inputname" type="text" onfocus="OnFocusProp(this,\''+exName+"')\" onblur=\"OnBlurProp(this,'"+exName+'\')" style="width: 127px;"> <input tabindex="'+(c+1)+'" id="PropertyValue_'+c+'" value="'+d+'" onkeydown="enableSaveBtn()" type="text" onfocus="OnFocusProp(this,\''+exValue+"')\" onblur=\"OnBlurProp(this,'"+exValue+'\')" style="width: 98px;"> <a id="ImgDelete_'+c+'" class="del" onclick="DeleteProperty(\''+h+"','"+(a+c)+"')\">Xa</a> </li>"}else{f='<li class="PropertyChild" id='+a+c+'> <input tabindex="'+c+'" id="PropertyName_'+c+'" value="'+g+'" onkeydown="flagEditProperty=true;enableSaveBtn()" class="inputname" type="text" onfocus="OnFocusProp(this,\''+exName+"')\" onblur=\"OnBlurProp(this,'"+exName+'\')" style="width: 120px;"> <input tabindex="'+(c+1)+'" id="PropertyValue_'+c+'" value="'+d+'" onkeydown="flagEditProperty=true;enableSaveBtn()" type="text" onfocus="OnFocusProp(this,\''+exValue+"')\" onblur=\"OnBlurProp(this,'"+exValue+'\')" style="width: 90px;"> <a id="ImgDelete_'+c+'" class="delete" onclick="DeleteProperty(\''+h+"','"+(a+c)+"')\">Xa</a> </li>"}$("#"+h).append(f);PropertyIndex+=2}

function OnBlurProp(a,b){if(a.value==""){a.value=b}}
function OnFocusProp(a,b){if(a.value==b){a.value=""}}
function DeleteProperty(b,a){enableSaveBtn();if(b=="CoorPropertyInfo"){flagEditProperty=true}$("#"+a).remove()}
function GetProperty(f){var b=new Array();var c=$("li","#"+f);for(var d=1;d<c.length;d++){var a=$("input",c[d]);if(a[0].value!=""&&a[0].value!=exName){var e=new Object();e.property_name=a[0].value;e.property_value=a[1].value;b.push(e)}}return b}
function GetPropertyForUpdate(j,h){var g=new Array();var c;var e=(h==null)?0:h.Tables[0].Rows.length;var a=$("li","#"+j);for(c=1;c<a.length;c++){var d=$("input",a[c]);if(d[0].value!=""&&d[0].value!=exName){var f=new Object();f.property_name=d[0].value;f.property_value=d[1].value;f.MyMap_property_value_id=(e>(c-1))?h.Tables[0].Rows[c-1].mymap_property_value_id:-1;f.MyMapID=dsMyMap.Tables[0].Rows[iMyMapOpening].MyMapID;g.push(f)}}if((c-1)<e){for(var b=c-1;b<e;b++){var f=new Object();f.MyMapID=-1;f.MyMap_property_value_id=h.Tables[0].Rows[b].mymap_property_value_id;g.push(f)}}return g}

function GetCoorPropertyForUpdate(l){var j=document.getElementById(l);var g=dsMyMapCoor.Tables[0].Rows[iMyMapCoorSel].MyMapCoorID;var h=null;for(var e=0;e<ArrPropertyAsLoad.length;e++){if(g==ArrPropertyAsLoad[e].id){h=ArrPropertyAsLoad[e].value;break}}var e;var c=(h!=null&&h!=undefined)?h.length:0;var a=$("li","#"+l);for(e=1;e<a.length;e++){var f=$("input",a[e]);if(f[0].value!=""&&f[0].value!=exName){var b=new Object();b.property_name=f[0].value;b.property_value=f[1].value;b.MyMapCoor_property_value_id=(c>(e-1))?h[e-1].MyMapCoor_property_value_id:-1;b.MyMapCoorID=g;ArrEditProperty.push(b)}}if((e-1)<c){for(var d=e-1;d<c;d++){var b=new Object();b.MyMapCoorID=-1;b.MyMapCoor_property_value_id=h[d].MyMapCoor_property_value_id;ArrDeleteProperty.push(b)}}}

function RemoveElement(c,b){for(var a=b;a<c.length-1;a++){c[a]=c[a+1]}c.pop()}
function MMSubTabChange(a){ChangeFunctionType(GLOBAL_MYMAP_FUNCTION);$("#buddy_tab").removeClass("active");$("#fav_tab").removeClass("active");$("#createbyme_tab").removeClass("active");$("#buddylist").hide();$("#MarkLocation").hide();$("#mymap_div").hide();$("#mymaptoolbar").hide();switch(a){case BUDDY_TAB:$("#buddy_tab").addClass("active");$("#buddylist").show();break;case FAVOURITE_TAB:$("#fav_tab").addClass("active");$("#MarkLocation").show();break;case CREATEBYME_TAB:$("#createbyme_tab").addClass("active");$("#mymap_div").show();$("#mymaptoolbar").show();break}}var curHistory="";var skTitle="";
function SendMap(){var b="Xem b?n d? l?n";if(nLanguage==1){b="View Larger Map"}var a=BuildMapLink();var c="<iframe width='450' height='350' frameborder='0' scrolling='no' marginheight='0' marginwidth='0' src='"+a.replace("vbdMap.aspx","vbdEmbed.aspx")+"'></iframe><br/><small><a href='"+a+"' style='color:#D98923;'>"+b+"</a></small>";curHistory=a;$("#txtMapLink").val(a);$("#txtMapEmbed").val(c);a=escape(a);$(".shareFacebook")[0].href="http://www.facebook.com/share.php?u="+a+"&t="+skTitle;$(".shareTwitter")[0].href="http://twitter.com/home?status="+a;$(".shareYahooMess")[0].href="ymsgr:im?msg="+a;$(".shareDelicious")[0].href="http://delicious.com/save?url="+a+"&title="+skTitle;$(".shareDigg")[0].href="http://digg.com/submit?phase=2&url="+a+"&title="+skTitle;$(".shareZingme")[0].href="http://link.apps.zing.vn/pro/view/conn/share?u="+a+"&t="+skTitle;$(".shareLinkhay")[0].href="http://linkhay.com/submit?link_url="+a+"&link_title="+skTitle;$(".SendMapLinks-wrap").show();document.getElementById("txtMapLink").select()}

function CloseSendMap(){$(".SendMapLinks-wrap").hide()}
function BuildMapLink(e){var a=window.location.href;var c=a.lastIndexOf("/");a=a.substring(0,c+1);a+="vbdMap.aspx?";var d="l="+map.getLevel();d+="&kv="+map.getCenter().toUrlValue();var b="";var h="";for(var f=0;f<2;f++){if(f<PlaceToFindPathArray.length){b+=PlaceToFindPathArray[f][0].getLatLng().toUrlValue();var g=$("input","#direction"+f).val();if(CheckInputDatatype(g)=="string"){h+=escape(g)}}if(f<PlaceToFindPathArray.length-1){b+=",";h+=","}}if(b!=""){d+="&fp="+b+";"+h+";"+PathOptions.Vehicle+";"+PathOptions.Alley}if(KeySearch!=null&&KeySearch.length>1){b=RemoveHTMLTag(KeySearch.replace(/\s*[|]\s*/g,", ").replace(/,\s*$/g,""));d+="&sk="+b.replace(/[ ]/g,"+");skTitle=b.replace(/[ ]/g,"+");skTitle=(skTitle!="")?"Vietbando - "+skTitle:"vietbando.com"}if(arrBlockHouseObj.length>0){d+="&bh=1"}if(iMyMapOpening!=-1){d+="&mi="+dsMyMap.Tables[0].Rows[iMyMapOpening].MyMapID}d=a+d;return d}

function PrintResult(){if(current_functype==GLOBAL_FINDPATH_FUNCTION){var r="";var b="";var n=map.getLevel();var d=map.getDirectionBounds();var e=0;var c=0;var o=0;var h=0;var p=0;var g=-1;var f="";for(var m=0;m<PlaceToFindPathArray.length;m++){f+=$("input","#direction"+m).val()+"~"}f=f.substring(0,f.length-1).replace(/&/g,"!@");r="&TextName="+encodeURI(f);var k="";for(var l=0;l<PlaceToFindPathArray.length;l++){for(var q=0;q<PlaceToFindPathArray[l].length;q++){k+=PlaceToFindPathArray[l][q].getPoint().lng()+","+PlaceToFindPathArray[l][q].getPoint().lat()+","}if(l>0&&l<PlaceToFindPathArray.length-1){b+=PlaceToFindPathArray[l-1].length+","}}k=k.substring(0,k.length-1);var a="type=1&l="+nLanguage+"&FindString="+k+"&Vehicle="+PathOptions.Vehicle+"&Imode="+b.toString()+"&FindMode="+p+"&FindType="+g+"&Level="+n+"&Left="+d.getNorthWest().lng()+"&Top="+d.getNorthWest().lat()+"&Right="+d.getSouthEast().lng()+"&Bottom="+d.getSouthEast().lat()+"&Findopts="+e+"&Index="+c+"&Sub="+o+"&IsInsert="+h+"&Alley="+PathOptions.Alley+"&Block="+PathOptions.Block+"&Lat="+map.getCenter().lat()+"&Lng="+map.getCenter().lng()+""+r;window.open("/Maps/PrintMapResult.aspx?"+a)}else{var a="type=0&l="+map.getLevel()+"&kv="+map.getCenter().toUrlValue();window.open("/Maps/PrintMapResult.aspx?"+a)}}var bMeasureLine=false;var arrDrawingPtsML=null;var nDrawingPtsML=0;var arrMLObj=new Array();var nMLObj=0;var CurrentDistance=0;var TotalDistance=0;

function ShowPopUpMyMapDistance(){TotalDistance=0;map.disableDoubleClickZoom();$("#lblCurDistance").html("0");$("#lblTotalDistance").html("0");$(".dokhoangcach").show()}

function ClosePopupDistance(b){if(isMeasureDistance&&bMeasureLine){return}$(".dokhoangcach").hide();var c=document.getElementById("MeasureDis");c.className="MTools-dokhcachDis";for(var a=0;a<nMLObj;a++){map.removeOverlay(arrMLObj[a])}map.enableDoubleClickZoom();isMeasureDistance=false;bMeasureLine=false;arrDrawingPtsML=null;nDrawingPtsML=0;arrMLObj=new Array();nMLObj=0;CurrentDistance=0;TotalDistance=0}
function CalculateDistance(d,g){var a,b,k;var n;var c;var m;var o;var l;var f=d.lat();var e=d.lng();var j=g.lat();var h=g.lng();n=f*(Math.PI/180);c=e*(Math.PI/180);m=j*(Math.PI/180);o=h*(Math.PI/180);a=e-h;l=a*(Math.PI/180);k=Math.sin(n)*Math.sin(m)+Math.cos(n)*Math.cos(m)*Math.cos(l);k=Math.acos(k);b=k*180/Math.PI;b=b*60*1.1515;b=b*1.609344*1000;return Math.round(b)}var AP_CurObj=null;var AP_Name="";var AP_AddNumber="";var AP_AddStreet="";var AP_AddWard="";var AP_AddDistrict="";var AP_AddProvince="";var AP_Phone="";var AP_Note="";var AP_Coor="";var bIsPlaceAdding=false;

function loadAddPlaceFunc(){if(!MembershipRequire()){return}ClearSearchResult();bIsPlaceAdding=true;var a="";if(nLanguage==0){a='<div class="MapHelp"><h3>Hu?ng d?n thm v? tr</h3> <ul style="padding:8px 0 15px;"><li>Nh?p chu?t tri ln b?n d? d? thm di?m. H? th?ng s? t? d?ng di?n cc thnh ph?n d?a ch? c th? dm b?n.</li> <li class="li2">Ko marker <span class="pin-mymap"></span> d?n v? tr b?n mu?n trn b?n d? d? thay d?i v? tr.</li> <li>Nh?p thng tin c?a v? tr v b?m vo nt Luu.</li> <li>Luu : n?u v? tr c nhi?u s? di?n tho?i, b?n hy nh?p d?u " - " d? phn cch v vui lng nh?p thng tin b?ng ti?ng Vi?t c d?u d? vi?c tm ki?m du?c chnh xc.</li> </ul> <a class="backbtn" onclick="unloadAddPlaceFunc();"><span> Quay l?i</span></a></div>'}else{a='<div class="MapHelp"><h3>Add place help</h3> <ul style="padding:8px 0 15px;"><li>Left-click on map to add a place. We will fill detected parts of address for you.</li> <li class="li2">Drag marker <span class="pin-mymap"></span> on map to change the location of place.</li> <li>Enter place\'s information and click Save.</li> <li>Note: If the place have more than one phone number, use " - " sign to separate them.</li> </ul> <a class="backbtn" onclick="unloadAddPlaceFunc();"><span> Back</span></a></div>'}document.getElementById("searchresult_div").innerHTML=a}

function unloadAddPlaceFunc(a){bIsPlaceAdding=false;if(AP_CurObj!=null){map.removeOverlay(AP_CurObj);AP_CurObj=null}if(a){if(nLanguage==0){alert("Thm v? tr thnh cng.\r\n\r\nCm on s? dng gp c?a b?n.\r\nV? tr ny s? ph?i ch? h? th?ng c?a chng ti ki?m duy?t.\r\n\r\nT?m th?i b?n chua th? tm th?y n trn Vietbando.")}else{alert("Location added successfully. Thank for your contribution.\r\nThis location must be checked by our system.\r\nYou cannot find it now.")}}AP_Name="";AP_AddNumber="";AP_AddStreet="";AP_AddWard="";AP_AddDistrict="";AP_AddProvince="";AP_Phone="";AP_Note="";AP_Coor="";Show_Map_Help()}

function AP_savePlace(){AP_Name=$("#txtAPName").val();AP_AddNumber=$("#txtAddNo").val();AP_AddStreet=$("#txtAddStreet").val();AP_Keyword=$("#txtVbdID").val();if(AP_Name!=""){if(AP_AddNumber=="S? nh"||AP_AddNumber=="Addr No"){AP_AddNumber=""}var d=new RegExp(/^[A-Za-z0-9_]*$/g);if(AP_Keyword.length<6||AP_Keyword.length>50||!d.test(AP_Keyword)){if(nLanguage==0){$("#aperror").html("Vui lng nh?p VietbandoID t? 6-30 k t? v ch? ch?a: (a-z A-Z 0-9).")}else{$("#aperror").html("Your VietbandoID must be 6-30 characters and only contains: (a-z A-Z 0-9).")}return}else{var c=AJLocationSearch.IsVBDIDAvailable(AP_Keyword).value;if(!c){if(nLanguage==0){$("#aperror").html("VietbandoID c?a b?n d du?c dng b?i ngu?i khc. Vui lng ch?n ID khc.")}else{$("#aperror").html("Your VietbandoID was taken by another user. Please try another.")}return}}AP_Phone="";if($("#loctype").val()=="biz"){AP_Phone=$("#txtPhone").val();if(AP_Phone==null||AP_Phone==""){if(nLanguage==0){$("#aperror").html("B?n vui lng di?n s? di?n tho?i cho doanh nghi?p.")}else{$("#aperror").html("Please enter phone number for business.")}return}}AP_Note=$("#txtNote").val();var b=AP_getObjCoor();var a=AJLocationSearch.AddPlace(AP_Name,AP_AddNumber,AP_AddStreet,AP_AddWard,AP_AddDistrict,AP_AddProvince,AP_Phone,AP_Note,b,AP_Keyword).value;if(!a){if(confirm("D? li?u thm khng thnh cng.\n c l?i trong qu trnh thm d? li?u.\nB?n vui lng lin h? v?i ngu?i qu?n tr? d? thng bo v? tnh tr?ng ny")==true){window.location.href="login.aspx"}return}map.closeInfoWindow();unloadAddPlaceFunc(true)}else{if(nLanguage==0){document.getElementById("aperror").innerHTML="B?n vui lng di?n d?y d? thng tin v? v? tr."}else{document.getElementById("aperror").innerHTML="Please enter required information."}}}

function AP_Cancel(){map.closeInfoWindow();unloadAddPlaceFunc(false)}var loctype="ips";
function AP_showInfoWindow(){loctype=$("#loctype").val();var e="mymap_icon/point-1.gif";var l=LocationObjectHook(AP_CurObj.getPoint());AP_AddNumber="";AP_AddStreet=(l.szStreet!=null)?l.szStreet:"";AP_AddWard=(l.szWard!=null)?l.szWard:"";AP_AddDistrict=(l.szDistrict!=null)?l.szDistrict:"";AP_AddProvince=(l.szProvince!=null)?l.szProvince:"";var m=new Array();var q=new Array();var p=(nLanguage==0)?"Thm m?i v? tr":"Add new place";var k=(nLanguage==0)?"Tn v? tr":"Place name";var h=(nLanguage==0)?"Lo?i":"Type";var d=(nLanguage==0)?"?a ch?":"Address";var a=(nLanguage==0)?"V? tr":"Location";var b=(nLanguage==0)?"i?n tho?i":"Phone";var g=(nLanguage==0)?"VietbandoID":"VietbandoID";var r=(nLanguage==0)?"(6-30 k t?)":"(6-30 characters)";var c=(nLanguage==0)?"M t?":"Comment";var n=(nLanguage==0)?"*B?n vui lng g ti?ng Vi?t c d?u":"";var f=(nLanguage==0)?"Luu":"Save";var j=(nLanguage==0)?"H?y":"Cancel";var o=(nLanguage==0)?"Dng lm t? kha tm ki?m. Vd: myhouse123":"Vietbando identifier. Ex: myhouse123";q[q.length]='<div id="apForm" class="jForm jFormPopup"> <h3>'+p+'</h3> <span id="aperror" class="typevnmese">'+n+'</span> <ol> <li> <label for="lbLocType">'+h+'</label> <select name="loctype" id="loctype" onchange="AP_showInfoWindow()"> <option value="ips">?a danh</option> <option value="biz">Doanh nghi?p</option> </select> </li> <li> <label for="txtAPName">'+k+'</label> <input id="txtAPName" type="text" name="txtAPName" /> </li>';if(loctype=="biz"){q[q.length]='<li> <label for="txtAddNo">'+d+'</label> <input id="txtAddNo" class="address" type="text" value="'+((nLanguage==0)?"S? nh":"Addr No")+'" onfocus="OnFocusAddNumber(this)" name="txtAddNo"/> <input id="txtAddStreet" class="street" type="text" value="'+((AP_AddStreet!=null)?AP_AddStreet:((nLanguage==0)?"Tn du?ng":"Street name"))+'" onfocus="OnFocusAddStreet(this)" name="txtAddStreet"/> <span class="addinfo">'+ConcatAddress("","",AP_AddWard,AP_AddDistrict,AP_AddProvince)+'</span> </li> <li> <label for="txtPhone">'+b+'</label> <input id="txtPhone" type="text" name="txtPhone"/> </li>'}else{q[q.length]='<li> <label for="txtAddNo">'+a+'</label> <input id="txtAddStreet" class="street" type="text" value="'+((AP_AddStreet!=null)?AP_AddStreet:((nLanguage==0)?"Tn du?ng":"Street name"))+'" onfocus="OnFocusAddStreet(this)" name="txtAddStreet"/> <span class="addinfo">'+ConcatAddress("","",AP_AddWard,AP_AddDistrict,AP_AddProvince)+"</span> </li>"}q[q.length]='<li> <label for="txtVbdID">'+g+'</label> <input id="txtVbdID" class="vietbandoid" type="text" name="txtVbdID" /> <span class="gioihan">'+r+'</span> <span class="explain">'+o+'</span> </li> <li> <label for="txtNote">'+c+'</label> <textarea id="txtNote" name="txtNote"></textarea> </li> </ol> <div> <a class="btnjForm" onclick="AP_savePlace()"><span>'+f+'</span></a> <a class="btnjForm" onclick="AP_Cancel()"><span>'+j+"</span></a> </div> </div>";AP_CurObj.openInfoWindow(q.join(""));$("#loctype").val(loctype);setTimeout(function(){if(document.getElementById("txtAPName")!=null){document.getElementById("txtAPName").focus()}},500)}

function OnFocusAddNumber(a){if(a.value=="S? nh"||a.value=="Addr No"){a.value=""}}
function OnFocusAddStreet(a){if(a.value=="Tn du?ng"||a.value=="Street name"){a.value=""}}
function ShowAddPlacePopup(a){if(AP_CurObj!=null){map.removeOverlay(AP_CurObj);AP_CurObj=null}var b=new VMarker(a,new VIcon("images/mymap_icon/point-1.gif",new VSize(32,32)));b.type=ADDPLACEOBJ;map.addOverlay(b);AP_CurObj=b;b.enableDragging();AP_showInfoWindow();VEvent.addListener(b,"dragend",AP_showInfoWindow)}
function AP_getObjCoor(){var a=AP_CurObj.getPoint();var b="POINT("+a.lng()+" "+a.lat()+")";return b}var RoadCons=null;var TrafficJam=null;var arrBlockHouseObj=new Array();var arrTrafficJamObj=new Array();var TGreenCount=0;

function TogglePopupTraffic(){if($("#ViewBlockHouse")[0].className=="MTools-raochanDis"){ShowPopupTraffic()}else{ClosePopupTraffic()}}

function ShowPopupTraffic(){$("#ViewBlockHouse")[0].className="MTools-raochanEna";$("#PopupTraffic").show();viewBlockHouse()}

function ClosePopupTraffic(){$("#ViewBlockHouse")[0].className="MTools-raochanDis";$("#PopupTraffic").hide();viewBlockHouse()}var bRoadConsCheck=true;var bTrafficJamCheck=true;

function ToggleRoadCons(){if(bRoadConsCheck){if(isSupportEffect()){$(".PopupTraffic-construction, #RoadConsCount").css("opacity","0.5")}$("#RoadConsCount").html("0");for(var a=0;a<arrBlockHouseObj.length;a++){arrBlockHouseObj[a].hide()}}else{if(isSupportEffect()){$(".PopupTraffic-construction, #RoadConsCount").css("opacity","1")}$("#RoadConsCount").html(RoadCons.Rows.length);for(var a=0;a<arrBlockHouseObj.length;a++){arrBlockHouseObj[a].show()}}bRoadConsCheck=!bRoadConsCheck}

function ToggleTrafficJam(){if(bTrafficJamCheck){if(isSupportEffect()){$(".PopupTraffic-jam, #TrafficJamCount").css("opacity","0.5")}$("#TrafficJamCount").html("0");for(var a=0;a<arrTrafficJamObj.length;a++){arrTrafficJamObj[a].hide()}}else{if(isSupportEffect()){$(".PopupTraffic-jam, #TrafficJamCount").css("opacity","1")}$("#TrafficJamCount").html(TrafficJam.Rows.length-TGreenCount);for(var a=0;a<arrTrafficJamObj.length;a++){arrTrafficJamObj[a].show()}}bTrafficJamCheck=!bTrafficJamCheck}

function viewBlockHouse(){if($("#ViewBlockHouse")[0].className=="MTools-raochanEna"){$("#RoadConsCount").html("0");$("#TrafficJamCount").html("0");AJLocationSearch.GetBlockHouse(viewBlockHouseCallback);checkBlock()}else{for(var a=0;a<arrBlockHouseObj.length;a++){map.removeOverlay(arrBlockHouseObj[a])}arrBlockHouseObj=new Array();for(var a=0;a<arrTrafficJamObj.length;a++){map.removeOverlay(arrTrafficJamObj[a])}arrTrafficJamObj=new Array();uncheckBlock()}}

function viewBlockHouseCallback(c){if(c.error!=null){ReportError();return}var a=c.value;if(a!=null){RoadCons=a.Tables[0];TrafficJam=a.Tables[1];var h=Date.parse(new Date());for(var e=0;e<RoadCons.Rows.length;e++){var f=3;var d=Date.parse(RoadCons.Rows[e].THOIGIANHOANTHANH);var b=((d-h)/(24*60*60*1000));if(b>90){f=3}else{if(b>30){f=2}else{if(b>0){f=1}else{f=0}}}var g=new VIcon("",new VSize(20,15));var j=new VLatLng(RoadCons.Rows[e].Y,RoadCons.Rows[e].X);createTJMarker(j,g,e,BLOCKHOUSEOBJ,f)}bRoadConsCheck=!bRoadConsCheck;ToggleRoadCons();TGreenCount=0;for(var e=0;e<TrafficJam.Rows.length;e++){if(TrafficJam.Rows[e].State==3){TGreenCount++}var g=new VIcon("",new VSize(32,25));var j=new VLatLng(TrafficJam.Rows[e].Latitude,TrafficJam.Rows[e].Longitude);createTJMarker(j,g,e,TRAFFICJAMOBJ,TrafficJam.Rows[e].State)}bTrafficJamCheck=!bTrafficJamCheck;ToggleTrafficJam()}}

function createTJMarker(g,e,d,a,b){var c=new VMarkerOptions(e,function(){return(resultActive==d)?3:2});if(a==BLOCKHOUSEOBJ){c.customMarker='<span class="imgConstruction-'+JamStateColor[b]+'"></span>';c.offset=new VSize(9,15)}else{c.customMarker='<span class="imgTraffic-'+JamStateColor[b]+'"></span>';c.offset=new VSize(14,25)}var f=new VMarker(g,c);f.bhIndex=d;f.type=a;map.addOverlay(f);if(a==BLOCKHOUSEOBJ){arrBlockHouseObj.push(f)}else{arrTrafficJamObj.push(f)}}

function FitRoadConstruction(){var a,m;var h,d;var e=map.getBounds();var k=e.getNorthWest();var c=e.getSouthEast();a=k.lng();m=k.lat();h=c.lng();d=c.lat();var b,n,l=false;for(var g=0,f=0;g<arrBlockHouseObj.length,f<arrTrafficJamObj.length;g++,f++){b=arrBlockHouseObj[g].getLatLng().lat();n=arrBlockHouseObj[g].getLatLng().lng();if(n<h&&n>a&&b>d&&b<m){l=true;break}b=arrTrafficJamObj[f].getLatLng().lat();n=arrTrafficJamObj[f].getLatLng().lng();if(n<h&&n>a&&b>d&&b<m){l=true;break}}if(!l){map.fitOverlays()}}var JamStateColor=new Array("red","orange","yellow","green");var JamState=new Array("K?t c?ng","K?t v?a","K?t t","Thng thong");var JamLane=new Array("T?t c?","Xe my","Xe  t","Xe t?i");var JamPolice=new Array(" c c?nh st","Chua c c?nh st");

function showTrafficJamInfoWindow(b){var a=TrafficJam.Rows[b];var c='<div class="MiniPopup"> <span class="Title">'+a.Position+'</span> <ol> <li><span class="Tit">Tnh tr?ng:</span><span class="Content">'+JamState[a.State]+'</span></li> <li><span class="Tit">Bn knh:</span><span class="Content">'+a.Radius+' m</span></li> <li><span class="Tit">Hu?ng k?t:</span><span class="Content">'+((a.HeadingType=="-1")?"T?t c?":"Hu?ng "+(a.HeadingType+1))+'</span></li> <li><span class="Tit">Ln k?t:</span><span class="Content">'+JamLane[a.Lane]+"</span></li> "+((a.Reason!="")?'<li><span class="Tit">Nguyn nhn:</span><span class="Content">'+a.Reason+"</span>":"")+'</li> <li><span class="Tit">Ngu?n tin:</span><span class="Content">'+a.Source+'</span></li> <li><span class="Tit police">'+JamPolice[a.Police]+'</span><span class="Content"></span></li> <li><span class="Tit">C?p nh?t:</span><span class="Content"><b>'+a.LastUpdate+"</b></span></li> </ol> </div>";arrTrafficJamObj[b].openInfoWindow(c)}

function showBlockHouseInfoWindow(b){var r=(nLanguage==0)?"Thng tin ro ch?n":"Road construction information";var f=(nLanguage==0)?"S? hi?u":"ID";var e=(nLanguage==0)?"Tuy?n du?ng":"Street ID";var d=(nLanguage==0)?"Tn d? n":"Project name";var l=(nLanguage==0)?"Gi th?u":"Contract";var h=(nLanguage==0)?"Tuy?n du?ng":"Street";var a=(nLanguage==0)?"Gi?y php":"License number";var c=(nLanguage==0)?"Ngy c?p":"License date";var g=(nLanguage==0)?"Kch thu?c":"Size";var p=(nLanguage==0)?"Th?i gian":"Period";var n=(nLanguage==0)?"C?m lo?i xe":"Forbidden traffic";var k=(nLanguage==0)?"Hu?ng c?m":"Forbidden direction";var q=(nLanguage==0)?"Ph?m vi c?m":"Forbidden range";var o=(nLanguage==0)?"L? trnh thay th?":"Spare route";var m=RoadCons.Rows[b];var j='<div class="MiniPopup"> <span class="Title">'+m.VITRI+"</span> <ol> "+((m.TENDUAN!="")?'<li><span class="Tit">'+d+':</span><span class="Content">'+m.TENDUAN+"</span>":"")+"</li> "+((m.TENCONGTRINH!="")?'<li><span class="Tit">'+l+':</span><span class="Content">'+m.TENCONGTRINH+"</span>":"")+"</li> "+((m.GIAYPHEP!="")?'<li><span class="Tit">'+a+':</span><span class="Content">'+m.GIAYPHEP+"</span>":"")+"</li> "+((m.NGAYCAP!="")?'<li><span class="Tit">'+c+':</span><span class="Content">'+(new Date(m.NGAYCAP)!="Invalid Date"?getDateString(new Date(m.NGAYCAP)):m.NGAYCAP)+"</span>":"")+"</li> "+((m.KICHTHUOC!="")?'<li><span class="Tit">'+g+':</span><span class="Content">'+m.KICHTHUOC+"</span>":"")+"</li> "+((m.MOTAVITRI!="")?'<li><span class="Tit">Ph?m vi:</span><span class="Content">'+m.MOTAVITRI+"</span>":"")+"</li> "+((m.THOIGIANKHOICONG!="")?'<li><span class="Tit">'+p+':</span><span class="Content"><b>'+(new Date(m.THOIGIANKHOICONG)!="Invalid Date"?getDateString(new Date(m.THOIGIANKHOICONG)):m.THOIGIANKHOICONG)+"</b>":"")+" "+((m.THOIGIANHOANTHANH!="")?" - <b>"+(new Date(m.THOIGIANHOANTHANH)!="Invalid Date"?getDateString(new Date(m.THOIGIANHOANTHANH)):m.THOIGIANHOANTHANH)+"</b></span>":"")+"</li> </ol> </div>";arrBlockHouseObj[b].openInfoWindow(j)}

function getDateString(a){return(getFullDate(a.getDate())+"/"+getFullDate(a.getMonth()+1)+"/"+a.getFullYear())}

function getFullDate(a){a=a<10?"0"+a:a;return a}

function ViewBus(){ChangeFunctionType(GLOBAL_FINDPATH_FUNCTION);changeVehicle(6);MessageBox.Show("pathbus","<h3>Tm du?ng di b?ng xe But</h3> <p>y l ty ch?n m?i cho ch?c nang Tm du?ng.</p> <p>Hi?n t?i ty ch?n ny ch? s? d?ng du?c ? TPHCM.</p>",338,-1,-1,45,"leftbot");MessageBox.Hide("busstation");InitImageBusStation()}

function HideBus(){map.setCenter(map.getCenter(),map.getLevel(),V_NORMAL_MAP)}

function InitImageBusStation(){VirtualMarker.CreateLayer("BUS",17,19,0,-26,10,getImageBusStation,getDataBusStation,ShowBusInfo)}

function getImageBusStation(c,a,b){return"/Maps/Render/Overlay.ashx?Action=Bus&X="+a.x+"&Y="+a.y+"&L="+b}

function getDataBusStation(d,b,c,a){Vietbando.Web.Library.Render.Overlay.getIMap(d,b,c,a)}

function getDataBusStationSmall(d,b,c,a){Vietbando.Web.Library.Render.Overlay.getIMap("BUS",b,c,a)}

function ShowBusInfo(){map.openInfoWindow(this.latlng,"ang t?i...");var a=this;AJBus.GetBusInfo(a.GUID,function(b){BindBusInfo(b,a.latlng)})}

function BindBusInfo(a,e){var d=a.value;if(d!=null&&typeof(d)=="object"&&d.Tables[0].Rows[0]!=null){var c=d.Tables[0].Rows[0];var b=c.Address;map.openInfoWindow(e,BuildMiniPopupWindow(c,-1,b,false));AtachEventMiniPopup(c,-1,b,"bus")}else{map.openInfoWindow(e,"Khng tm th?y thng tin")}}

function ClickStatisticsInsert(a,b){AJLocationSearch.ClickStatistics(a,b)}var LoadingHelp=false;var HelpShowed=false;

function LoadHelp(){if(HelpShowed){UnLoadHelp()}else{LoadingHelp=true;HelpShowed=true;$("#s-help").toggleClass("SHelpOpen");$(".SHelpDiv-div").stop().animate({height:285},2000,"swing");setTimeout(function(){$("#HelpDiv").show();LoadingHelp=false},10)}}

function UnLoadHelp(){if(!LoadingHelp&&HelpShowed){HelpShowed=false;$("#s-help").toggleClass("SHelpOpen");$(".SHelpDiv-div").stop().animate({height:10},100,"linear",function(){$("#HelpDiv").hide()})}}

function clickHelp(){LoadingHelp=true;setTimeout(function(){LoadingHelp=false},10)}var LoadingTree=false;

function LoadTree(){if(TreeBinding.TreeShowed){UnLoadTree()}else{LoadingTree=true;TreeBinding.TreeShowed=true;$("#Tree").css("display","");$("#Tree").stop().animate({height:300},100,"linear",function(){TreeBinding.LoadTreeTo("Tree")});setTimeout(function(){$("#boundTree").css("padding","8px");$("#boundTree").css("border-bottom","1px solid #1163C9");$("#boundTree").css("border-top","1px solid #00477c");$("#Tree").css("padding","5px 7px");$("#Tree").css("border","solid 1px #cccccc");LoadingTree=false},10)}}

function UnLoadTree(){if(!LoadingTree&&TreeBinding.TreeShowed){TreeBinding.TreeShowed=false;$("#Tree").stop().animate({height:0},100,"linear",function(){$("#Tree").css("display","none");$("#boundTree").css("padding","0px");$("#boundTree").css("margin","0px");$("#boundTree").css("border","")})}}

function clickTree(){LoadingTree=true;setTimeout(function(){LoadingTree=false},10)}

function switchkey(){document.getElementById("bogo").className="bogoe"}var activeElementID="searchtab";

function activeTabById(a){activeElementID=a;unactiveAll();activeTab(a);shrinkMap()}

function unactiveAll(){$("#searchtab").attr("class","");$("#findpathtab").attr("class","");$("#mymaptab").attr("class","");$("#supporttab").attr("class","");$("#searchtabdiv").css("display","none");$("#findpathtabdiv").css("display","none");$("#mymaptabdiv").css("display","none");$("#supporttabdiv").css("display","none")}

function activeTab(a){$("#"+a+"div").show();$("#"+a).attr("class","active2")}

function moveIconClick(){if($("#leftpanel").css("left").replace("px","")<0){shrinkMap()}else{expandMap()}}

function expandMap(){var a=document.getElementById("container");a.style.left="5px";a.style.width=myWidth-a.offsetLeft+"px";map.checkResize();$("#leftpanel").stop().animate({left:-345},350,"linear");$("#centerSplit").stop().animate({left:-2},350,"linear",function(){$("#"+activeElementID).attr("class","active3");$("#moveicon").attr("class","moveicon-out")})}

function shrinkMap(){if($("#moveicon")[0].className=="moveicon-out"){$("#"+activeElementID).attr("class","active2");$("#moveicon").attr("class","moveicon");$("#leftpanel").stop().animate({left:0},350,"linear");$("#centerSplit").stop().animate({left:343},350,"linear",function(){});setTimeout(function(){var a=document.getElementById("container");a.style.left="352px";a.style.width=myWidth-a.offsetLeft+"px";map.checkResize()},350)}}var hidingInputText=false;

function inputTextClick(){hidingInputText=true;setTimeout(function(){hidingInputText=false},100);if(document.getElementById("mapinput").value==inputTextHelp){document.getElementById("mapinput").value=""}}

function showInputTextHelp(){if(!hidingInputText&&document.getElementById("mapinput").value==""){document.getElementById("mapinput").value=inputTextHelp}}

function WrapperClick(){UnLoadHelp();UnLoadTree();$("#nav").hideSuperfishUl();hideWeather()}

function toggleAlley(){if(PathOptions.Alley==0){checkAlley()}else{uncheckAlley()}FindAllPath()}

function checkAlley(){if(PathOptions.Alley==1){return}$("#avoidalley").addClass("NotAlley-On");$("#avoidalley").attr("title","H?n ch? qua h?m [B?t]");$("#avoidalley").ShowTipsy();PathOptions.Alley=1}

function uncheckAlley(){if(PathOptions.Alley==0){return}$("#avoidalley").removeClass("NotAlley-On");$("#avoidalley").attr("title","H?n ch? qua h?m [T?t]");$("#avoidalley").ShowTipsy();PathOptions.Alley=0}

function toggleBlock(){if(PathOptions.Block==0){checkBlock()}else{uncheckBlock()}FindAllPath()}

function checkBlock(){if(PathOptions.Block==1){return}$("#avoidblock").addClass("NotCons-On");$("#avoidblock").attr("title","H?n ch? qua nt th?t giao thng [B?t]");$("#avoidblock").ShowTipsy();PathOptions.Block=1;ShowPopupTraffic()}

function uncheckBlock(){if(PathOptions.Block==0){return}$("#avoidblock").removeClass("NotCons-On");$("#avoidblock").attr("title","H?n ch? qua nt th?t giao thng [T?t]");$("#avoidblock").ShowTipsy();PathOptions.Block=0;ClosePopupTraffic()}

function changeVehicle(a){ResetVehicle();PathOptions.Vehicle=a;switch(a){case 1:$(".motor").addClass("motor-enable");break;case 2:$(".car").addClass("car-enable");break;case 3:$(".lorry").addClass("lorry-enable");break;case 5:$(".pedestrian").addClass("pedestrian-enable");break;default:}}

function InitAnimation(){$(".pedestrian").click(function(){changeVehicle(5);FindAllPath()});$(".motor").click(function(){changeVehicle(1);FindAllPath()});$(".car").click(function(){changeVehicle(2);FindAllPath()});$(".lorry").click(function(){changeVehicle(3);FindAllPath()})}

function changeLang(){var a=window.location.href;var b=QueryString("lang");if(b==""){if(a.indexOf("?")>0){a+="&lang=vi"}else{a+="?lang=vi"}b="vi"}if(b=="en"){$("body").changeLang({lang:"en",file:"Languages/vbdMap-lang.xml"});$(".lang-Eng").addClass("lang-Vie");$(".lang-Eng")[0].onclick=function(){window.location.href=a.replace("lang=en","lang=vi")}}else{$("body").changeLang({lang:"vi",file:"Languages/vbdMap-lang.xml"});$(".lang-Eng").removeClass("lang-Vie");$(".lang-Eng")[0].onclick=function(){window.location.href=a.replace("lang=vi","lang=en")}}}

function ResetVehicle(){$(".pedestrian").removeClass("pedestrian-enable");$(".motor").removeClass("motor-enable");$(".car").removeClass("car-enable");$(".lorry").removeClass("lorry-enable")}jQuery.easing.jswing=jQuery.easing.swing;jQuery.extend(jQuery.easing,{def:"easeOutElastic",swing:function(e,f,g,h,a){return jQuery.easing[jQuery.easing.def](e,f,g,h,a)},easeOutElastic:function(l,g,h,j,m){var e=1.70158;var f=0;var k=j;if(g==0){return h}if((g/=m)==1){return h+j}if(!f){f=m*0.3}if(k<Math.abs(j)){k=j;var e=f/4}else{var e=f/(2*Math.PI)*Math.asin(j/k)}return k*Math.pow(2,-35*g)*Math.sin((g*m-e)*(2*Math.PI)/f)+j+h}});(function(a){a.fn.lavaLamp=function(b){b=a.extend({fx:"swing",speed:500,click:function(){return true},startItem:"no",autoReturn:true,returnDelay:0,setOnClick:true,homeTop:0,homeLeft:0,homeWidth:0,homeHeight:0,returnHome:false},b||{});var c;if(b.homeTop||b.homeLeft){c=a('<li class="homeLava selectedLava"></li>').css({left:b.homeLeft,top:b.homeTop,width:b.homeWidth,height:b.homeHeight,position:"absolute"});a(this).prepend(c)}return this.each(function(){var k=location.pathname+location.search+location.hash;var h=new Object;var g;var d;var e;var f=a("li",this).not(a(".noLava"));if(b.startItem=="no"){h=a('li a[href$="'+k+'"]',this).parent("li")}if(h.length==0&&b.startItem=="no"){h=a('li a[href$="'+location.pathname.substring(location.pathname.lastIndexOf("/")+1)+location.search+location.hash+'"]',this).parent("li")}if(h.length==0||b.startItem!="no"){if(b.startItem=="no"){b.startItem=0}h=a(f[b.startItem])}e=a("li.selectedLava",this)[0]||a(h).addClass("selectedLava")[0];f.mouseenter(function(){if(a(this).hasClass("homeLava")){e=a(this)[0]}j(this)});d=a('<li class="nav-arrow" style="z-index:-1"></li>').appendTo(this);a(this).mouseleave(function(){if(b.autoReturn){if(b.returnHome&&c){j(c[0])}else{if(b.returnDelay){if(g){clearTimeout(g)}g=setTimeout(function(){j(null)},b.returnDelay+b.speed)}else{j(null)}}}});f.click(function(l){if(b.setOnClick){a(e).removeClass("selectedLava");a(this).addClass("selectedLava");e=this}return b.click.apply(this,[l,this])});if(b.homeTop||b.homeLeft){d.css({left:b.homeLeft,top:b.homeTop,width:b.homeWidth,height:b.homeHeight})}else{d.css({left:e.offsetLeft,top:e.offsetTop,width:e.offsetWidth,height:e.offsetHeight})}function j(l){if(!l){l=e}var n=0,m=0;if(!a.browser.msie){n=(d.outerWidth()-d.innerWidth())/2;m=(d.outerHeight()-d.innerHeight())/2}d.stop().animate({left:l.offsetLeft-n,top:l.offsetTop-m,width:l.offsetWidth,height:l.offsetHeight},b.speed,b.fx)}})}})($);(function(a){a.fn.hoverIntent=function(m,n){var o={sensitivity:7,interval:100,timeout:0};o=a.extend(o,n?{over:m,out:n}:m);var d,e,k,l;var j=function(f){d=f.pageX;e=f.pageY};var b=function(g,f){f.hoverIntent_t=clearTimeout(f.hoverIntent_t);if((Math.abs(k-d)+Math.abs(l-e))<o.sensitivity){a(f).unbind("mousemove",j);f.hoverIntent_s=1;return o.over.apply(f,[g])}else{k=d;l=e;f.hoverIntent_t=setTimeout(function(){b(g,f)},o.interval)}};var c=function(g,f){f.hoverIntent_t=clearTimeout(f.hoverIntent_t);f.hoverIntent_s=0;return o.out.apply(f,[g])};var h=function(f){var g=(f.type=="mouseover"?f.fromElement:f.toElement)||f.relatedTarget;while(g&&g!=this){try{g=g.parentNode}catch(f){g=this}}if(g==this){return false}var r=jQuery.extend({},f);var q=this;if(q.hoverIntent_t){q.hoverIntent_t=clearTimeout(q.hoverIntent_t)}if(f.type=="mouseover"){k=r.pageX;l=r.pageY;a(q).bind("mousemove",j);if(q.hoverIntent_s!=1){q.hoverIntent_t=setTimeout(function(){b(r,q)},o.interval)}}else{a(q).unbind("mousemove",j);if(q.hoverIntent_s==1){q.hoverIntent_t=setTimeout(function(){c(r,q)},o.timeout)}}};return this.mouseover(h).mouseout(h)}})(jQuery);(function(b){b.fn.superfish=function(k){var e=b.fn.superfish,l=e.c,g=b(['<span class="',l.arrowClass,'"> &#187;</span>'].join("")),h=function(){var c=b(this),m=j(c);clearTimeout(m.sfTimer);c.showSuperfishUl().siblings().hideSuperfishUl()},d=function(){var m=b(this),n=j(m),c=e.op;clearTimeout(n.sfTimer);n.sfTimer=setTimeout(function(){c.retainPath=(b.inArray(m[0],c.$path)>-1);m.hideSuperfishUl();if(c.$path.length&&m.parents(["li.",c.hoverClass].join("")).length<1){h.call(c.$path)}},c.delay)},j=function(m){var c=m.parents(["ul.",l.menuClass,":first"].join(""))[0];e.op=e.o[c.serial];return c},f=function(c){c.addClass(l.anchorClass).append(g.clone())};return this.each(function(){var m=this.serial=e.o.length;var n=b.extend({},e.defaults,k);n.$path=b("li."+n.pathClass,this).slice(0,n.pathLevels).each(function(){b(this).addClass([n.hoverClass,l.bcClass].join(" ")).filter("li:has(ul)").removeClass(n.pathClass)});e.o[m]=e.op=n;b("li:has(ul)",this)[(b.fn.hoverIntent&&!n.disableHI)?"hoverIntent":"hover"](h,d).each(function(){if(n.autoArrows){f(b(">a:first-child",this))}}).not("."+l.bcClass).hideSuperfishUl();var c=b("a",this);c.each(function(o){var p=c.eq(o).parents("li");c.eq(o).focus(function(){h.call(p)}).blur(function(){d.call(p)})});n.onInit.call(this)}).each(function(){var c=[l.menuClass];if(e.op.dropShadows&&!(b.browser.msie&&b.browser.version<7)){c.push(l.shadowClass)}b(this).addClass(c.join(" "))})};var a=b.fn.superfish;a.o=[];a.op={};a.IE7fix=function(){var c=a.op;if(b.browser.msie&&b.browser.version>6&&c.dropShadows&&c.animation.opacity!=undefined){this.toggleClass(a.c.shadowClass+"-off")}};a.c={bcClass:"sf-breadcrumb",menuClass:"sf-js-enabled",anchorClass:"sf-with-ul",arrowClass:"sf-sub-indicator",shadowClass:"sf-shadow"};a.defaults={hoverClass:"sfHover",pathClass:"overideThisToUse",pathLevels:1,delay:80,animation:{opacity:"show"},speed:"normal",autoArrows:true,dropShadows:true,disableHI:false,onInit:function(){},onBeforeShow:function(){},onShow:function(){},onHide:function(){}};b.fn.extend({hideSuperfishUl:function(){var d=a.op,e=(d.retainPath===true)?d.$path:"";d.retainPath=false;var c=b(["li.",d.hoverClass].join(""),this).add(this).not(e).removeClass(d.hoverClass).find(">ul").hide().css("visibility","hidden");d.onHide.call(c);return this},showSuperfishUl:function(){var e=a.op,d=a.c.shadowClass+"-off",c=this.addClass(e.hoverClass).find(">ul:hidden").css("visibility","visible");a.IE7fix.call(c);e.onBeforeShow.call(c);c.animate(e.animation,e.speed,function(){a.IE7fix.call(c);e.onShow.call(c)});return this}})})(jQuery);(function(a){a.fn.HideTipsy=function(){var b=a(this)[0];var c=a.fn.tipsy.elementOptions(b,a.fn.tipsy.defaults);a.data(b,"cancel.tipsy",false);var d=b;setTimeout(function(){if(a.data(b,"cancel.tipsy")){return}var e=a.data(d,"active.tipsy");if(c.fade){e.stop().fadeOut(function(){a(b).remove()})}else{e.remove()}},0)};a.fn.ShowTipsy=function(){var j=a(this)[0];var e=a.fn.tipsy.elementOptions(j,a.fn.tipsy.defaults);a.data(j,"cancel.tipsy",true);var g=a.data(j,"active.tipsy");if(!g){g=a('<div class="tipsy"> <div class="tipsy-inner-wrap"> <div class="tipsy-inner"></div> </div> <div class="tipsy-arrow"></div> </div>');g.css({position:"absolute",zIndex:100000});a.data(j,"active.tipsy",g)}if(a(j).attr("title")||typeof(a(j).attr("original-title"))!="string"){a(j).attr("original-title",a(j).attr("title")||"").removeAttr("title")}var d;if(typeof e.title=="string"){d=a(j).attr(e.title=="title"?"original-title":e.title)}else{if(typeof e.title=="function"){d=e.title.call(j)}}g.find(".tipsy-inner")[e.html?"html":"text"](d||e.fallback);var f=a.extend({},a(j).offset(),{width:j.offsetWidth,height:j.offsetHeight});g.get(0).className="tipsy";g.remove().css({top:0,left:0,visibility:"hidden",display:"block"}).appendTo(document.body);var h=g[0].offsetWidth,c=g[0].offsetHeight;var b=(typeof e.gravity=="function")?e.gravity.call(this):e.gravity;switch(b){case"sc":g.css({top:f.top-c-2,left:f.left+f.width/2-h/2});a(".tipsy-arrow",g).addClass("centerbottom");break;case"sl":g.css({top:f.top-c-2,left:f.left-5});a(".tipsy-arrow",g).addClass("leftbottom");break;case"sr":g.css({top:f.top-c-2,left:f.left-h+f.width+5});a(".tipsy-arrow",g).addClass("rightbottom");break}if(e.fade){g.css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:0.8})}else{g.css({visibility:"visible"})}};a.fn.tipsy=function(b){return this.each(function(){if(a(this).attr("title")==""){return}a(this).hover(a.fn.ShowTipsy,a.fn.HideTipsy)})};a.fn.tipsy.elementOptions=function(c,b){return a.extend({},b,{gravity:a(c).attr("tipdir")||a.fn.tipsy.autoS})};a.fn.tipsy.defaults={fade:false,fallback:"",gravity:"sc",html:true,title:"title"};a.fn.tipsy.autoS=function(){var b=a(this)[0];if(a(b).offset().left+b.offsetWidth+40>a(window).width()){return"sr"}else{if(a(b).offset().left-b.offsetWidth-40<a(document).scrollLeft()){return"sl"}else{return"sc"}}}})(jQuery);

function VKI_buildKeyboardInputs(){var self=this;this.VKI_target=false;this.VKI_imageURI="/Maps/Control/VirtualKeyboard/images/keyboard.png";this.VKI_isIE=
17/*@cc_on!@*/
18false;this.VKI_attachKeyboard=VKI_attach=function(elem){if(elem.VKI_attached){return false}var keybut=$('<img src="'+this.VKI_imageURI+'" class="keyboardInputInitiator">')[0];keybut.elem=elem;keybut.onclick=function(){self.VKI_show(this.elem)};elem.VKI_attached=true;$(elem).after(keybut);if(this.VKI_isIE){elem.onclick=elem.onselect=elem.onkeyup=function(e){if((e||event).type!="keyup"||!this.readOnly){this.range=document.selection.createRange()}}}};$("input.keyboardInput, textarea.keyboardInput").each(function(){VKI_attachKeyboard(this)});this.VKI_buildKeys=function(){$(".kb-bor2 a").each(function(){var character=$("span",this).text();switch(character){case"Enter":this.onclick=function(){doSearch();self.VKI_close();return true};break;case"Space":this.onclick=function(){self.VKI_insert(" ");return false};break;default:this.onclick=function(){self.VKI_insert(character);return false}}});$(".kb-btnBksp")[0].onclick=function(){self.VKI_target.focus();if(self.VKI_target.setSelectionRange){var rng=[self.VKI_target.selectionStart,self.VKI_target.selectionEnd];if(rng[0]<rng[1]){rng[0]++}self.VKI_target.value=self.VKI_target.value.substr(0,rng[0]-1)+self.VKI_target.value.substr(rng[1]);self.VKI_target.setSelectionRange(rng[0]-1,rng[0]-1)}else{if(self.VKI_target.createTextRange){try{self.VKI_target.range.select()}catch(e){self.VKI_target.range=document.selection.createRange()}if(!self.VKI_target.range.text.length){self.VKI_target.range.moveStart("character",-1)}self.VKI_target.range.text=""}else{self.VKI_target.value=self.VKI_target.value.substr(0,self.VKI_target.value.length-1)}}self.VKI_target.focus();return true};$(".kb-btnClear")[0].onclick=function(){self.VKI_target.value="";self.VKI_target.focus();return false};$(".kb-close")[0].onclick=function(){self.VKI_close()}};this.VKI_buildKeys();this.VKI_insert=function(text){this.VKI_target.focus();if(this.VKI_target.maxLength){this.VKI_target.maxlength=this.VKI_target.maxLength}if(typeof this.VKI_target.maxlength=="undefined"||this.VKI_target.maxlength<0||this.VKI_target.value.length<this.VKI_target.maxlength){if(this.VKI_target.setSelectionRange){var rng=[this.VKI_target.selectionStart,this.VKI_target.selectionEnd];this.VKI_target.value=this.VKI_target.value.substr(0,rng[0])+text+this.VKI_target.value.substr(rng[1]);if(text=="\n"&&window.opera){rng[0]++}this.VKI_target.setSelectionRange(rng[0]+text.length,rng[0]+text.length)}else{if(this.VKI_target.createTextRange){try{this.VKI_target.range.select()}catch(e){this.VKI_target.range=document.selection.createRange()}this.VKI_target.range.text=text;this.VKI_target.range.collapse(true);this.VKI_target.range.select()}else{this.VKI_target.value+=text}}this.VKI_target.focus()}else{if(this.VKI_target.createTextRange&&this.VKI_target.range){this.VKI_target.range.select()}}};this.VKI_close=VKI_close=function(){if(this.VKI_target){$(".kb-bor1").hide();this.VKI_target.focus();this.VKI_target=false}};this.VKI_show=function(elem){if(!this.VKI_target){this.VKI_target=elem;if(this.VKI_isIE){if(!this.VKI_target.range){this.VKI_target.range=this.VKI_target.createTextRange();this.VKI_target.range.moveStart("character",this.VKI_target.value.length)}this.VKI_target.range.select()}$(".kb-bor1").css("left",$(elem).offset().left,"top",$(elem).offset().top);$(".kb-bor1").show();this.VKI_target.focus()}else{this.VKI_close()}}}if(window.addEventListener){window.addEventListener("load",VKI_buildKeyboardInputs,false)}else{if(window.attachEvent){window.attachEvent("onload",VKI_buildKeyboardInputs)}}(function(g){g.facebox=function(n,m){g.facebox.loading();if(n.ajax){b(n.ajax)}else{if(n.image){e(n.image)}else{if(n.div){k(n.div)}else{if(g.isFunction(n)){n.call(g)}else{g.facebox.reveal(n,m)}}}}};g.extend(g.facebox,{settings:{opacity:0,overlay:true,loadingImage:"/Maps/vbdScript/MessBox/images/loading.gif",closeImage:"/Maps/vbdScript/MessBox/images/closelabel.gif",imageTypes:["png","jpg","jpeg","gif"],faceboxHtml:' <div id="facebox" style="display:none;"> <div class="popup"> <table> <tbody> <tr> <td class="tl"/><td class="b"/><td class="tr"/> </tr> <tr> <td class="b"/> <td class="body"> <div class="content"> </div> <div class="fbfooter"> <a href="#" class="fbclose"> <img src="/Maps/vbdScript/MessBox/images/closelabel.gif" title="close" class="close_image" /> </a> </div> </td> <td class="b"/> </tr> <tr> <td class="bl"/><td class="b"/><td class="br"/> </tr> </tbody> </table> </div> </div>'},loading:function(){d();if(g("#facebox .loading").length==1){return true}f();g("#facebox .content").empty();g("#facebox .body").children().hide().end().append('<div class="loading"><img src="'+g.facebox.settings.loadingImage+'"/></div>');g("#facebox").css({top:h()[1]+(l()/10),left:385.5}).show();g(document).bind("keydown.facebox",function(m){if(m.keyCode==27){g.facebox.close()}return true});g(document).trigger("loading.facebox")},reveal:function(n,m){g(document).trigger("beforeReveal.facebox");if(m){g("#facebox .content").addClass(m)}g("#facebox .content").append(n);g("#facebox .loading").remove();g("#facebox .body").children().fadeIn("normal");g("#facebox").css("left",g(window).width()/2-(g("#facebox table").width()/2));g(document).trigger("reveal.facebox").trigger("afterReveal.facebox")},close:function(){g(document).trigger("close.facebox");return false}});g.fn.facebox=function(m){d(m);function n(){g.facebox.loading(true);var o=this.rel.match(/images\[?\.(\w+)\]?/);if(o){o=o[1]}k(this.href,o);return false}return this.click(n)};function d(o){if(g.facebox.settings.inited){return true}else{g.facebox.settings.inited=true}g(document).trigger("init.facebox");j();var m=g.facebox.settings.imageTypes.join("|");g.facebox.settings.imageTypesRegexp=new RegExp("."+m+"$","i");if(o){g.extend(g.facebox.settings,o)}g("body").append(g.facebox.settings.faceboxHtml);var n=[new Image(),new Image()];n[0].src=g.facebox.settings.closeImage;n[1].src=g.facebox.settings.loadingImage;g("#facebox").find(".b:first, .bl, .br, .tl, .tr").each(function(){n.push(new Image());n.slice(-1).src=g(this).css("background-image").replace(/url\((.+)\)/,"$1")});g("#facebox .fbclose").click(g.facebox.close);g("#facebox .close_image").attr("src",g.facebox.settings.closeImage)}function h(){var n,m;if(self.pageYOffset){m=self.pageYOffset;n=self.pageXOffset}else{if(document.documentElement&&document.documentElement.scrollTop){m=document.documentElement.scrollTop;n=document.documentElement.scrollLeft}else{if(document.body){m=document.body.scrollTop;n=document.body.scrollLeft}}}return new Array(n,m)}function l(){var m;if(self.innerHeight){m=self.innerHeight}else{if(document.documentElement&&document.documentElement.clientHeight){m=document.documentElement.clientHeight}else{if(document.body){m=document.body.clientHeight}}}return m}function j(){var m=g.facebox.settings;m.loadingImage=m.loading_image||m.loadingImage;m.closeImage=m.close_image||m.closeImage;m.imageTypes=m.image_types||m.imageTypes;m.faceboxHtml=m.facebox_html||m.faceboxHtml}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																									 function k(m,o){if(m.match(/#/)){var n=window.location.href.split("#")[0];var p=m.replace(n,"");g.facebox.reveal(g(p).clone().show(),o)}else{if(m.match(g.facebox.settings.imageTypesRegexp)){e(m,o)}else{b(m,o)}}}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																									 																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																						function e(m,o){var n=new Image();n.onload=function(){g.facebox.reveal('<div class="image"><img src="'+n.src+'" /></div>',o)};n.src=m}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																					function b(m,n){g.get(m,function(o){g.facebox.reveal(o,n)})}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																					function a(){return g.facebox.settings.overlay==false||g.facebox.settings.opacity===null}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																					function f(){if(a()){return}if(g("facebox_overlay").length==0){g("body").append('<div id="facebox_overlay" class="facebox_hide"></div>')}g("#facebox_overlay").hide().addClass("facebox_overlayBG").css("opacity",g.facebox.settings.opacity).click(function(){g(document).trigger("close.facebox")}).fadeIn(200);return false}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																					function c(){if(a()){return}g("#facebox_overlay").fadeOut(200,function(){g("#facebox_overlay").removeClass("facebox_overlayBG");g("#facebox_overlay").addClass("facebox_hide");g("#facebox_overlay").remove()});return false}g(document).bind("close.facebox",function(){g(document).unbind("keydown.facebox");g("#facebox").fadeOut(function(){g("#facebox .content").removeClass().addClass("content");c();g("#facebox .loading").remove()})})})(jQuery);